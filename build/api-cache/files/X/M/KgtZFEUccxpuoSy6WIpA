1683891914
oo20z%2BoyWz%3Aa330f4ca0874aa85e5df8f5ff31d864c-37877bb2b4bd6ce2fca6e7667a0e1077
s:61484:"TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlIjoxMjp7czo0MzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBkb2NCbG9jayI7TzozMzoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrIjo3OntzOjQyOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrAHN1bW1hcnkiO3M6MjM6IkRpc3BsYXkgQWRkIExpc3RpbmcgTWFwIjtzOjQ2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrAGRlc2NyaXB0aW9uIjtPOjQ1OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcRGVzY3JpcHRpb24iOjI6e3M6NTk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcRGVzY3JpcHRpb24AYm9keVRlbXBsYXRlIjtzOjQ1MzoiVGhpcyB0ZW1wbGF0ZSBjYW4gYmUgb3ZlcnJpZGRlbiBieSBjb3B5aW5nIGl0IHRvIHlvdXJ0aGVtZS9nZW9kaXJlY3RvcnkvYm9vdHN0cmFwL21hcC9tYXAtYWRkLWxpc3RpbmcucGhwLgoKSE9XRVZFUiwgb24gb2NjYXNpb24gR2VvRGlyZWN0b3J5IHdpbGwgbmVlZCB0byB1cGRhdGUgdGVtcGxhdGUgZmlsZXMgYW5kIHlvdQoodGhlIHRoZW1lIGRldmVsb3Blcikgd2lsbCBuZWVkIHRvIGNvcHkgdGhlIG5ldyBmaWxlcyB0byB5b3VyIHRoZW1lIHRvCm1haW50YWluIGNvbXBhdGliaWxpdHkuIFdlIHRyeSB0byBkbyB0aGlzIGFzIGxpdHRsZSBhcyBwb3NzaWJsZSwgYnV0IGl0IGRvZXMKaGFwcGVuLiBXaGVuIHRoaXMgb2NjdXJzIHRoZSB2ZXJzaW9uIG9mIHRoZSB0ZW1wbGF0ZSBmaWxlIHdpbGwgYmUgYnVtcGVkIGFuZAp0aGUgcmVhZG1lIHdpbGwgbGlzdCBhbnkgaW1wb3J0YW50IGNoYW5nZXMuIjtzOjUxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrXERlc2NyaXB0aW9uAHRhZ3MiO2E6MDp7fX1zOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrAHRhZ3MiO2E6NTp7aTowO086NDI6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xUYWdzXFNlZSI6Mzp7czo3OiIAKgBuYW1lIjtzOjM6InNlZSI7czo5OiIAKgByZWZlcnMiO086NTI6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xUYWdzXFJlZmVyZW5jZVxVcmwiOjE6e3M6NTc6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcVGFnc1xSZWZlcmVuY2VcVXJsAHVyaSI7czo2NjoiaHR0cHM6Ly9kb2NzLndwZ2VvZGlyZWN0b3J5LmNvbS9hcnRpY2xlLzM0Ni1jdXN0b21pemluZy10ZW1wbGF0ZXMvIjt9czoxNDoiACoAZGVzY3JpcHRpb24iO047fWk6MTtPOjQ2OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcVGFnc1xHZW5lcmljIjoyOntzOjc6IgAqAG5hbWUiO3M6NzoicGFja2FnZSI7czoxNDoiACoAZGVzY3JpcHRpb24iO086NDU6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xEZXNjcmlwdGlvbiI6Mjp7czo1OToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xEZXNjcmlwdGlvbgBib2R5VGVtcGxhdGUiO3M6MTI6Ikdlb0RpcmVjdG9yeSI7czo1MToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xEZXNjcmlwdGlvbgB0YWdzIjthOjA6e319fWk6MjtPOjQ2OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcVGFnc1xWZXJzaW9uIjozOntzOjc6IgAqAG5hbWUiO3M6NzoidmVyc2lvbiI7czo1NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xUYWdzXFZlcnNpb24AdmVyc2lvbiI7czo1OiIyLjIuNiI7czoxNDoiACoAZGVzY3JpcHRpb24iO086NDU6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xEZXNjcmlwdGlvbiI6Mjp7czo1OToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xEZXNjcmlwdGlvbgBib2R5VGVtcGxhdGUiO3M6MDoiIjtzOjUxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrXERlc2NyaXB0aW9uAHRhZ3MiO2E6MDp7fX19aTozO086NDY6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xUYWdzXEdlbmVyaWMiOjI6e3M6NzoiACoAbmFtZSI7czo2OiJnbG9iYWwiO3M6MTQ6IgAqAGRlc2NyaXB0aW9uIjtPOjQ1OiJwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcRGVzY3JpcHRpb24iOjI6e3M6NTk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcRGVzY3JpcHRpb24AYm9keVRlbXBsYXRlIjtzOjQyOiJpbnQgJG1hcHpvb20gWm9vbSBsZXZlbCB2YWx1ZSBmb3IgdGhlIG1hcC4iO3M6NTE6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2tcRGVzY3JpcHRpb24AdGFncyI7YTowOnt9fX1pOjQ7Tzo0NjoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrXFRhZ3NcR2VuZXJpYyI6Mjp7czo3OiIAKgBuYW1lIjtzOjY6Imdsb2JhbCI7czoxNDoiACoAZGVzY3JpcHRpb24iO086NDU6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xEZXNjcmlwdGlvbiI6Mjp7czo1OToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9ja1xEZXNjcmlwdGlvbgBib2R5VGVtcGxhdGUiO3M6NDQ6ImJvb2wgJGdlb2Rpcl9tYW51YWxfbWFwIENoZWNrIGlmIG1hbnVhbCBtYXAuIjtzOjUxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrXERlc2NyaXB0aW9uAHRhZ3MiO2E6MDp7fX19fXM6NDI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2sAY29udGV4dCI7TzozODoicGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXENvbnRleHQiOjI6e3M6NDk6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cVHlwZXNcQ29udGV4dABuYW1lc3BhY2UiO3M6MDoiIjtzOjU2OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFR5cGVzXENvbnRleHQAbmFtZXNwYWNlQWxpYXNlcyI7YTowOnt9fXM6NDM6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cRG9jQmxvY2sAbG9jYXRpb24iO086MzM6InBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbiI6Mjp7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBsaW5lTnVtYmVyIjtpOjI7czo0NzoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxMb2NhdGlvbgBjb2x1bW5OdW1iZXIiO2k6MDt9czo1MDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxEb2NCbG9jawBpc1RlbXBsYXRlU3RhcnQiO2I6MDtzOjQ4OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXERvY0Jsb2NrAGlzVGVtcGxhdGVFbmQiO2I6MDt9czozOToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBoYXNoIjtzOjMyOiIzNzg3N2JiMmI0YmQ2Y2UyZmNhNmU3NjY3YTBlMTA3NyI7czozOToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBuYW1lIjtzOjE5OiJtYXAtYWRkLWxpc3RpbmcucGhwIjtzOjM5OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAHBhdGgiO3M6NTY6Imdlb2RpcmVjdG9yeS90ZW1wbGF0ZXMvYm9vdHN0cmFwL21hcC9tYXAtYWRkLWxpc3RpbmcucGhwIjtzOjQxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAHNvdXJjZSI7czo0MjA5NzoiPD9waHAKLyoqCiAqIERpc3BsYXkgQWRkIExpc3RpbmcgTWFwCiAqCiAqIFRoaXMgdGVtcGxhdGUgY2FuIGJlIG92ZXJyaWRkZW4gYnkgY29weWluZyBpdCB0byB5b3VydGhlbWUvZ2VvZGlyZWN0b3J5L2Jvb3RzdHJhcC9tYXAvbWFwLWFkZC1saXN0aW5nLnBocC4KICoKICogSE9XRVZFUiwgb24gb2NjYXNpb24gR2VvRGlyZWN0b3J5IHdpbGwgbmVlZCB0byB1cGRhdGUgdGVtcGxhdGUgZmlsZXMgYW5kIHlvdQogKiAodGhlIHRoZW1lIGRldmVsb3Blcikgd2lsbCBuZWVkIHRvIGNvcHkgdGhlIG5ldyBmaWxlcyB0byB5b3VyIHRoZW1lIHRvCiAqIG1haW50YWluIGNvbXBhdGliaWxpdHkuIFdlIHRyeSB0byBkbyB0aGlzIGFzIGxpdHRsZSBhcyBwb3NzaWJsZSwgYnV0IGl0IGRvZXMKICogaGFwcGVuLiBXaGVuIHRoaXMgb2NjdXJzIHRoZSB2ZXJzaW9uIG9mIHRoZSB0ZW1wbGF0ZSBmaWxlIHdpbGwgYmUgYnVtcGVkIGFuZAogKiB0aGUgcmVhZG1lIHdpbGwgbGlzdCBhbnkgaW1wb3J0YW50IGNoYW5nZXMuCiAqCiAqIEBzZWUgICAgICAgIGh0dHBzOi8vZG9jcy53cGdlb2RpcmVjdG9yeS5jb20vYXJ0aWNsZS8zNDYtY3VzdG9taXppbmctdGVtcGxhdGVzLwogKiBAcGFja2FnZSAgICBHZW9EaXJlY3RvcnkKICogQHZlcnNpb24gICAgMi4yLjYKICoKICogQGdsb2JhbCBpbnQgJG1hcHpvb20gWm9vbSBsZXZlbCB2YWx1ZSBmb3IgdGhlIG1hcC4KICogQGdsb2JhbCBib29sICRnZW9kaXJfbWFudWFsX21hcCBDaGVjayBpZiBtYW51YWwgbWFwLgogKi8KCmRlZmluZWQoICdBQlNQQVRIJyApIHx8IGV4aXQ7CgpnbG9iYWwgJG1hcHpvb20sICRnZW9kaXJfbWFudWFsX21hcCwgJGdlb2Rpcl9sYWJlbF90eXBlOwoKLyoqCiAqIEZpbHRlciB0aGUgbWFwIHJlc3RyaWN0aW9uIGZvciBzcGVjaWZpYyBhZGRyZXNzIG9ubHkKICoKICogQHNpbmNlIDEuMC4wCiAqCiAqIEBwYXJhbSBib29sICR2YXIgV2hldGhlciB0byByZXN0cmljdCB0aGUgbWFwIGZvciBzcGVjaWZpYyBhZGRyZXNzIG9ubHkuCiAqLwokaXNfbWFwX3Jlc3RyaWN0ID0gYXBwbHlfZmlsdGVycygnZ2VvZGlyX2FkZF9saXN0aW5nX21hcF9yZXN0cmljdCcsIHRydWUpOwoKLyoqCiAqIEZpbHRlciB0aGUgYXV0byBjaGFuZ2UgYWRkcmVzcyBmaWVsZHMgdmFsdWVzIHdoZW4gbW92aW5nIHRoZSBtYXAgcGluCiAqCiAqIEBzaW5jZSAxLjQuOAogKgogKiBAcGFyYW0gYm9vbCAkdmFyIFdoZXRoZXIgdG8gY2hhbmdlIHRoZSBjb3VudHJ5LCBzdGF0ZSwgY2l0eSB2YWx1ZXMgaW4gZmllbGRzLgogKi8KJGF1dG9fY2hhbmdlX2FkZHJlc3NfZmllbGRzX3Bpbl9tb3ZlID0gYXBwbHlfZmlsdGVycygnZ2VvZGlyX2F1dG9fY2hhbmdlX2FkZHJlc3NfZmllbGRzX3Bpbl9tb3ZlJywgdHJ1ZSk7Cmdsb2JhbCAkZ2VvZGlyZWN0b3J5OwokZGVmYXVsdF9sb2NhdGlvbiA9ICRnZW9kaXJlY3RvcnktPmxvY2F0aW9uLT5nZXRfZGVmYXVsdF9sb2NhdGlvbigpOwokZGVmYXVsdGNpdHkgPSBpc3NldCgkZGVmYXVsdF9sb2NhdGlvbi0+Y2l0eSkgPyAkZGVmYXVsdF9sb2NhdGlvbi0+Y2l0eSA6ICcnOwokbGF0X2xuZ19ibGFuayA9IGZhbHNlOwppZiAoICghaXNzZXQoJGxhdCkgfHwgJGxhdCA9PSAnJyApICYmICghaXNzZXQoJGxhdCkgfHwgJGxuZyA9PSAnJykpIHsKICAgICRsYXRfbG5nX2JsYW5rID0gdHJ1ZTsKICAgICRjaXR5ID0gJGRlZmF1bHRjaXR5OwogICAgJHJlZ2lvbiA9IGlzc2V0KCRkZWZhdWx0X2xvY2F0aW9uLT5yZWdpb24pID8gJGRlZmF1bHRfbG9jYXRpb24tPnJlZ2lvbiA6ICcnOwogICAgJGNvdW50cnkgPSBpc3NldCgkZGVmYXVsdF9sb2NhdGlvbi0+Y291bnRyeSkgPyAkZGVmYXVsdF9sb2NhdGlvbi0+Y291bnRyeSA6ICcnOwogICAgJGxuZyA9IGlzc2V0KCRkZWZhdWx0X2xvY2F0aW9uLT5sb25naXR1ZGUpID8gJGRlZmF1bHRfbG9jYXRpb24tPmxvbmdpdHVkZSA6ICcnOwogICAgJGxhdCA9IGlzc2V0KCRkZWZhdWx0X2xvY2F0aW9uLT5sYXRpdHVkZSkgPyAkZGVmYXVsdF9sb2NhdGlvbi0+bGF0aXR1ZGUgOiAnJzsKfQokZGVmYXVsdF9sbmcgPSBpc3NldCgkZGVmYXVsdF9sb2NhdGlvbi0+bG9uZ2l0dWRlKSA/ICRkZWZhdWx0X2xvY2F0aW9uLT5sb25naXR1ZGUgOiAnJzsKJGRlZmF1bHRfbGF0ID0gaXNzZXQoJGRlZmF1bHRfbG9jYXRpb24tPmxhdGl0dWRlKSA/ICRkZWZhdWx0X2xvY2F0aW9uLT5sYXRpdHVkZSA6ICcnOwppZiAoaXNfYWRtaW4oKSAmJiBpc3NldCgkX1JFUVVFU1RbJ3RhYiddKSAmJiAkbWFwem9vbSA9PSAnJykgewogICAgJG1hcHpvb20gPSA0OwogICAgaWYgKGlzc2V0KCRfUkVRVUVTVFsnYWRkX2hvb2QnXSkpCiAgICAgICAgJG1hcHpvb20gPSAxMDsKfQoKLyoqCiAqIEZpbHRlciB0aGUgYXV0byBjaGFuZ2UgYWRkcmVzcyBmaWVsZHMgdmFsdWVzCiAqCiAqIEBzaW5jZSAxLjAuMAogKgogKiBAcGFyYW0gYm9vbCAkdmFyIFdoZXRoZXIgdG8gYXV0byBmaWxsIGNvdW50cnksIHN0YXRlLCBjaXR5IHZhbHVlcyBpbiBmaWVsZHMuCiAqLwokYXV0b19jaGFuZ2VfbWFwX2ZpZWxkcyA9IGFwcGx5X2ZpbHRlcnMoJ2dlb2Rpcl9hdXRvX2NoYW5nZV9tYXBfZmllbGRzJywgdHJ1ZSk7CiRtYXJrZXJfaWNvbiA9IEdlb0Rpcl9NYXBzOjpkZWZhdWx0X21hcmtlcl9pY29uKCB0cnVlICk7CiRpY29uX3NpemUgPSBHZW9EaXJfTWFwczo6Z2V0X21hcmtlcl9zaXplKCRtYXJrZXJfaWNvbiwgYXJyYXkoJ3cnID0+IDIwLCAnaCcgPT4gMzQpKTsKPz4KPHNjcmlwdCB0eXBlPSJ0ZXh0L2phdmFzY3JpcHQiPgogICAgLyogPCFbQ0RBVEFbICovCiAgICA8P3BocCAKCS8qKgoJICogRmlyZXMgYXQgdGhlIHN0YXJ0IG9mIHRoZSBhZGQgamF2YXNjcmlwdCBvbiB0aGUgYWRkIGxpc3RpbmdzIG1hcC4KCSAqCgkgKiBAc2luY2UgMS4wLjAKICAgICAqIEBwYXJhbSBzdHJpbmcgJHByZWZpeCBUaGUgcHJlZml4IGZvciBhbGwgZWxlbWVudHMuCgkgKi8KCWRvX2FjdGlvbignZ2VvZGlyX2FkZF9saXN0aW5nX2pzX3N0YXJ0JywgJHByZWZpeCk7Cgk/PgogICAgaWYgKCh3aW5kb3cuZ2RTZXRNYXA9PSdnb29nbGUnIHx8IHdpbmRvdy5nZFNldE1hcD09J2F1dG8nKSAmJiB3aW5kb3cuZ29vZ2xlICYmIHR5cGVvZiBnb29nbGUubWFwcyE9PSd1bmRlZmluZWQnKSB7CiAgICAgICAgZ2RNYXBzID0gJ2dvb2dsZSc7CiAgICB9IGVsc2UgaWYgKCh3aW5kb3cuZ2RTZXRNYXA9PSdvc20nIHx8IHdpbmRvdy5nZFNldE1hcD09J2F1dG8nKSAmJiB0eXBlb2YgTCE9PSd1bmRlZmluZWQnICYmIHR5cGVvZiBMLnZlcnNpb24hPT0ndW5kZWZpbmVkJykgewogICAgICAgIGdkTWFwcyA9ICdvc20nOwogICAgfSBlbHNlIHsKICAgICAgICBnZE1hcHMgPSBudWxsOwogICAgfQogICAgd2luZG93LmdkTWFwcyA9IHdpbmRvdy5nZE1hcHMgfHwgZ2RNYXBzOwogICAgCiAgICB1c2VyX2FkZHJlc3MgPSBmYWxzZTsKICAgIGpRdWVyeSgnIzw/cGhwIGVjaG8gJHByZWZpeC4nc3RyZWV0Jzs/PicpLm9uKCJrZXlwcmVzcyIsZnVuY3Rpb24gKCkgewogICAgICAgIHVzZXJfYWRkcmVzcyA9IHRydWU7CiAgICB9KTsKCiAgICBiYXNlTWFya2VyID0gJyc7CiAgICBnZW9jb2RlciA9ICcnOwogICAgdmFyIDw/cGhwIGVjaG8gJHByZWZpeDs/PkNJVFlfTUFQX0NFTlRFUl9MQVQgPSA8P3BocCBlY2hvICggJGxhdCA/IGdlb2Rpcl9zYW5pdGl6ZV9mbG9hdCggJGxhdCApIDogJzM5Ljk1MjQ4NCcgKTsgPz47CiAgICB2YXIgPD9waHAgZWNobyAkcHJlZml4Oz8+Q0lUWV9NQVBfQ0VOVEVSX0xORyA9IDw/cGhwIGVjaG8gKCAkbG5nID8gZ2VvZGlyX3Nhbml0aXplX2Zsb2F0KCAkbG5nICkgOiAnLTc1LjE2Mzc4NicgKTsgPz47CiAgICA8P3BocCBpZigkbGF0X2xuZ19ibGFuayl7JGxhdD0nJzskbG5nPScnO30/PgogICAgdmFyIDw/cGhwIGVjaG8gJHByZWZpeDs/PkNJVFlfTUFQX1pPT01JTkdfRkFDVCA9IDw/cGhwIGVjaG8gKCRtYXB6b29tKSA/IGFic2ludCggJG1hcHpvb20gKSA6IDEyOz8+OwogICAgdmFyIG1pblpvb21MZXZlbCA9IDw/cGhwIGVjaG8gKCRpc19tYXBfcmVzdHJpY3QpID8gNSA6IDA7ID8+OwogICAgdmFyIG1hcExhbmcgPSAnPD9waHAgZWNobyBlc2NfanMoIEdlb0Rpcl9NYXBzOjptYXBfbGFuZ3VhZ2UoKSApOyA/Pic7CiAgICB2YXIgb2xkc3RyX2FkZHJlc3M7CiAgICB2YXIgb2xkc3RyX2FkZHJlc3MyOwogICAgdmFyIG9sZHN0cl96aXA7CiAgICB2YXIgc3RyaWN0Qm91bmRzOwogICAgdmFyIGRvaW5nR2VvY29kZSA9IGZhbHNlOwogICAgdmFyIHBvc3RhbF90b3duOwogICAgdmFyIGxvY2FsaXR5OwogICAgZnVuY3Rpb24gZ2VvY29kZVBvc2l0aW9uKGxhdExvbiwgYWRkcmVzcykgewogICAgICAgIGNvbnNvbGUubG9nKGFkZHJlc3MpOwogICAgICAgIGlmIChhZGRyZXNzICYmIChsb2NhbGl0eSB8fCBwb3N0YWxfdG93bikgJiYgYWRkcmVzcy5jb3VudHJ5IT0nVFInICYmIGFkZHJlc3MuY291bnRyeSE9J1NHJyApIHsvLyB0dXJrZXkgc2VsZWN0IGFkZHJlc3MgZG9lcyBub3QgcmV0dXJuIGVub3VnaCBpbmZvIHNvIHdlIGdldCBpbmZvIGZyb20gR1BTIG9ubHkuCiAgICAgICAgICAgIGRvR2VvQ29kZSA9IGFkZHJlc3M7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZG9HZW9Db2RlID0gewogICAgICAgICAgICAgICAgbGF0TG5nOiBiYXNlTWFya2VyLmdldFBvc2l0aW9uKCkKICAgICAgICAgICAgfTsKICAgICAgICB9CgogICAgICAgIGdlb2NvZGVyLmdlb2NvZGUoZG9HZW9Db2RlLCBmdW5jdGlvbiAocmVzcG9uc2VzKSB7CiAgICAgICAgICAgIGdlb2NvZGVSZXNwb25zZShyZXNwb25zZXMpOwogICAgICAgIH0pOwogICAgfQoKICAgIGZ1bmN0aW9uIGdlb2NvZGVSZXNwb25zZShyZXNwb25zZXMpIHsKICAgICAgICBjb25zb2xlLmxvZyhyZXNwb25zZXMpOy8va2VlcCB0aGlzIGZvciBkZWJ1Z2dpbmcKICAgICAgICBpZiAocmVzcG9uc2VzICYmIHJlc3BvbnNlcy5sZW5ndGggPiAwKSB7CiAgICAgICAgICAgIHZhciBnZXRBZGRyZXNzID0gJyc7CiAgICAgICAgICAgIHZhciBnZXRBZGRyZXNzMiA9ICcnOwogICAgICAgICAgICB2YXIgZ2V0WmlwID0gJyc7CiAgICAgICAgICAgIHZhciBnZXRDaXR5ID0gJyc7CiAgICAgICAgICAgIHZhciBnZXRTdGF0ZSA9ICcnOwogICAgICAgICAgICB2YXIgZ2V0Q291bnRyeSA9ICcnOwoKICAgICAgICAgICAgZ2V0Q291bnRyeUlTTyA9ICcnOwoKICAgICAgICAgICAgZm9ybWF0dGVkX2FkZHJlc3MgPSAnJzsKICAgICAgICAgICAgc3RyZWV0X251bWJlciA9ICcnOwogICAgICAgICAgICBwcmVtaXNlID0gJyc7IC8vIEluIFJ1c3NpYW4gOwogICAgICAgICAgICBlc3RhYmxpc2htZW50ID0gJyc7CiAgICAgICAgICAgIHJvdXRlID0gJyc7CiAgICAgICAgICAgIGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMSA9ICcnOwogICAgICAgICAgICBhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzIgPSAnJzsKICAgICAgICAgICAgYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8zID0gJyc7CiAgICAgICAgICAgIHN1YmxvY2FsaXR5X2xldmVsXzEgPSAnJzsKICAgICAgICAgICAgcG9zdGFsX3Rvd24gPSAnJzsKICAgICAgICAgICAgbG9jYWxpdHkgPSAnJzsKICAgICAgICAgICAgY291bnRyeSA9ICcnOwogICAgICAgICAgICBwb3N0YWxfY29kZSA9ICcnOwogICAgICAgICAgICBwb3N0YWxfY29kZV9wcmVmaXggPSAnJzsKICAgICAgICAgICAgcnIgPSAnJzsKICAgICAgICAgICAgaGFzX2FkZHJlc3NfYmVlbl9zZXQgPSBmYWxzZTsKCiAgICAgICAgICAgIC8vIGdldCB0aGUgcHJvcGVyIHJlc3BvbnNlIGFzIHNvbWV0aW1lcyB0aGUgR1BTIHJlc3VsdHMgd2lsbCByZXR1cm4gbmFtZXMgaW4gRW5nbGlzaCB3aGVuIHRoZXkgc2hvdWxkIG5vdC4KICAgICAgICAgICAgcmVzcG9uc2VzLmZvckVhY2goZnVuY3Rpb24ocmVzcG9uc2UpIHsKICAgICAgICAgICAgICAgIGlmKHJlc3BvbnNlLnR5cGVzWzBdID09ICJsb2NhbGl0eSIpewoKICAgICAgICAgICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlc3BvbnNlLmFkZHJlc3NfY29tcG9uZW50cy5sZW5ndGg7IGkrKykgewogICAgICAgICAgICAgICAgICAgICAgICB2YXIgYWRkciA9IHJlc3BvbnNlLmFkZHJlc3NfY29tcG9uZW50c1tpXTsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFkZHIudHlwZXNbMF0gPT0gJ2FkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMScpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMSA9IGFkZHI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFkZHIudHlwZXNbMF0gPT0gJ2FkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMicpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMiA9IGFkZHI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFkZHIudHlwZXNbMF0gPT0gJ2FkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMycpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMyA9IGFkZHI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFkZHIudHlwZXNbMF0gPT0gJ3N1YmxvY2FsaXR5X2xldmVsXzEnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdWJsb2NhbGl0eV9sZXZlbF8xID0gYWRkcjsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgICAgICBpZiAoYWRkci50eXBlc1swXSA9PSAncG9zdGFsX3Rvd24nKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3N0YWxfdG93biA9IGFkZHI7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFkZHIudHlwZXNbMF0gPT0gJ2xvY2FsaXR5JykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgbG9jYWxpdHkgPSBhZGRyOwogICAgICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChhZGRyLnR5cGVzWzBdID09ICdwcmVtaXNlJykgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgcHJlbWlzZSA9IGFkZHI7YWxlcnQoNCk7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGFkZHIudHlwZXNbMF0gPT0gJ2VzdGFibGlzaG1lbnQnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBlc3RhYmxpc2htZW50ID0gYWRkcjthbGVydCg1KTsKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfSk7CgoKCiAgICAgICAgICAgIAogICAgICAgICAgICBmb3IgKHZhciBpID0gMDsgaSA8IHJlc3BvbnNlc1swXS5hZGRyZXNzX2NvbXBvbmVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICAgICAgICAgIHZhciBhZGRyID0gcmVzcG9uc2VzWzBdLmFkZHJlc3NfY29tcG9uZW50c1tpXTsKICAgICAgICAgICAgICAgIGlmIChhZGRyLnR5cGVzWzBdID09ICdzdHJlZXRfbnVtYmVyJykgewogICAgICAgICAgICAgICAgICAgIHN0cmVldF9udW1iZXIgPSBhZGRyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGFkZHIudHlwZXNbMF0gPT0gJ3JvdXRlJykgewogICAgICAgICAgICAgICAgICAgIHJvdXRlID0gYWRkcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChhZGRyLnR5cGVzWzBdID09ICdwcmVtaXNlJykgewogICAgICAgICAgICAgICAgICAgIHByZW1pc2UgPSBhZGRyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMSA9PSAnJyAmJiBhZGRyLnR5cGVzWzBdID09ICdhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzEnKSB7CiAgICAgICAgICAgICAgICAgICAgYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8xID0gYWRkcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzIgPT0gJycgJiYgYWRkci50eXBlc1swXSA9PSAnYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8yJykgewogICAgICAgICAgICAgICAgICAgIGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMiA9IGFkZHI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8zID09ICcnICYmIGFkZHIudHlwZXNbMF0gPT0gJ2FkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMycpIHsKICAgICAgICAgICAgICAgICAgICBhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzMgPSBhZGRyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHN1YmxvY2FsaXR5X2xldmVsXzEgPT0gJycgJiYgYWRkci50eXBlc1swXSA9PSAnc3VibG9jYWxpdHlfbGV2ZWxfMScpIHsKICAgICAgICAgICAgICAgICAgICBzdWJsb2NhbGl0eV9sZXZlbF8xID0gYWRkcjsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGlmIChwb3N0YWxfdG93biA9PSAnJyAmJiBhZGRyLnR5cGVzWzBdID09ICdwb3N0YWxfdG93bicpIHsKICAgICAgICAgICAgICAgICAgICBwb3N0YWxfdG93biA9IGFkZHI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAobG9jYWxpdHkgPT0gJycgJiYgYWRkci50eXBlc1swXSA9PSAnbG9jYWxpdHknKSB7CiAgICAgICAgICAgICAgICAgICAgbG9jYWxpdHkgPSBhZGRyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGFkZHIudHlwZXNbMF0gPT0gJ2NvdW50cnknKSB7CiAgICAgICAgICAgICAgICAgICAgY291bnRyeSA9IGFkZHI7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBpZiAoYWRkci50eXBlc1swXSA9PSAncG9zdGFsX2NvZGUnKSB7CiAgICAgICAgICAgICAgICAgICAgcG9zdGFsX2NvZGUgPSBhZGRyOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKGFkZHIudHlwZXNbMF0gPT0gJ3Bvc3RhbF9jb2RlX3ByZWZpeCcpIHsKICAgICAgICAgICAgICAgICAgICBwb3N0YWxfY29kZV9wcmVmaXggPSBhZGRyOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChhZGRyLnR5cGVzWzBdID09ICdlc3RhYmxpc2htZW50JykgewogICAgICAgICAgICAgICAgICAgIGVzdGFibGlzaG1lbnQgPSBhZGRyOwogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgIGlmIChwb3N0YWxfY29kZSA9PSAnJykgewogICAgICAgICAgICAgICAgICAgIHBvc3RhbF9jb2RlID0gcG9zdGFsX2NvZGVfcHJlZml4OwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgaWYgKHJlc3BvbnNlc1swXS5mb3JtYXR0ZWRfYWRkcmVzcyAhPSAnJykgewogICAgICAgICAgICAgICAgICAgIGlmIChmb3JtYXR0ZWRfYWRkcmVzcyA9PSAnJykgewogICAgICAgICAgICAgICAgICAgICAgICBmb3JtYXR0ZWRfYWRkcmVzcyA9IHJlc3BvbnNlc1swXS5mb3JtYXR0ZWRfYWRkcmVzczsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICAgICAgYWRkcmVzc19hcnJheSA9IHJlc3BvbnNlc1swXS5mb3JtYXR0ZWRfYWRkcmVzcy5zcGxpdCgiLCIsIDIpOwogICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgIGlmIChhZGRyZXNzX2FycmF5Lmxlbmd0aCA+IDEpIHsKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCEodHlwZW9mKHN0cmVldF9udW1iZXIubG9uZ19uYW1lKSA9PSAndW5kZWZpbmVkJyB8fCBzdHJlZXRfbnVtYmVyLmxvbmdfbmFtZSA9PSBudWxsKSAmJiBzdHJlZXRfbnVtYmVyLmxvbmdfbmFtZS50b0xvd2VyQ2FzZSgpID09IGFkZHJlc3NfYXJyYXlbMF0udG9Mb3dlckNhc2UoKS50cmltKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldEFkZHJlc3MgPSBzdHJlZXRfbnVtYmVyLmxvbmdfbmFtZSArICcsICcgKyBhZGRyZXNzX2FycmF5WzFdOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0QWRkcmVzcyA9PSAnJyAmJiAhKHR5cGVvZihzdHJlZXRfbnVtYmVyLmxvbmdfbmFtZSkgPT0gJ3VuZGVmaW5lZCcgfHwgc3RyZWV0X251bWJlci5sb25nX25hbWUgPT0gbnVsbCkgJiYgc3RyZWV0X251bWJlci5sb25nX25hbWUudG9Mb3dlckNhc2UoKSA9PSBhZGRyZXNzX2FycmF5WzFdLnRvTG93ZXJDYXNlKCkudHJpbSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzID0gYWRkcmVzc19hcnJheVswXSArICcsICcgKyBzdHJlZXRfbnVtYmVyLmxvbmdfbmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdldEFkZHJlc3MgPT0gJycgJiYgISh0eXBlb2Yoc3RyZWV0X251bWJlci5zaG9ydF9uYW1lKSA9PSAndW5kZWZpbmVkJyB8fCBzdHJlZXRfbnVtYmVyLnNob3J0X25hbWUgPT0gbnVsbCkgJiYgc3RyZWV0X251bWJlci5zaG9ydF9uYW1lLnRvTG93ZXJDYXNlKCkgPT0gYWRkcmVzc19hcnJheVswXS50b0xvd2VyQ2FzZSgpLnRyaW0oKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0QWRkcmVzcyA9IHN0cmVldF9udW1iZXIuc2hvcnRfbmFtZSArICcsICcgKyBhZGRyZXNzX2FycmF5WzFdOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0QWRkcmVzcyA9PSAnJyAmJiAhKHR5cGVvZihzdHJlZXRfbnVtYmVyLnNob3J0X25hbWUpID09ICd1bmRlZmluZWQnIHx8IHN0cmVldF9udW1iZXIuc2hvcnRfbmFtZSA9PSBudWxsKSAmJiBzdHJlZXRfbnVtYmVyLnNob3J0X25hbWUudG9Mb3dlckNhc2UoKSA9PSBhZGRyZXNzX2FycmF5WzFdLnRvTG93ZXJDYXNlKCkudHJpbSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzID0gYWRkcmVzc19hcnJheVswXSArICcsICcgKyBzdHJlZXRfbnVtYmVyLnNob3J0X25hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZXRBZGRyZXNzID09ICcnICYmICEodHlwZW9mKHByZW1pc2UubG9uZ19uYW1lKSA9PSAndW5kZWZpbmVkJyB8fCBwcmVtaXNlLmxvbmdfbmFtZSA9PSBudWxsKSAmJiBwcmVtaXNlLmxvbmdfbmFtZS50b0xvd2VyQ2FzZSgpID09IGFkZHJlc3NfYXJyYXlbMF0udG9Mb3dlckNhc2UoKS50cmltKCkpIHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIGdldEFkZHJlc3MgPSBwcmVtaXNlLmxvbmdfbmFtZSArICcsICcgKyBhZGRyZXNzX2FycmF5WzFdOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0QWRkcmVzcyA9PSAnJyAmJiAhKHR5cGVvZihwcmVtaXNlLmxvbmdfbmFtZSkgPT0gJ3VuZGVmaW5lZCcgfHwgcHJlbWlzZS5sb25nX25hbWUgPT0gbnVsbCkgJiYgcHJlbWlzZS5sb25nX25hbWUudG9Mb3dlckNhc2UoKSA9PSBhZGRyZXNzX2FycmF5WzFdLnRvTG93ZXJDYXNlKCkudHJpbSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzID0gYWRkcmVzc19hcnJheVswXSArICcsICcgKyBwcmVtaXNlLmxvbmdfbmFtZTsKICAgICAgICAgICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGdldEFkZHJlc3MgPT0gJycgJiYgISh0eXBlb2YocHJlbWlzZS5zaG9ydF9uYW1lKSA9PSAndW5kZWZpbmVkJyB8fCBwcmVtaXNlLnNob3J0X25hbWUgPT0gbnVsbCkgJiYgcHJlbWlzZS5zaG9ydF9uYW1lLnRvTG93ZXJDYXNlKCkgPT0gYWRkcmVzc19hcnJheVswXS50b0xvd2VyQ2FzZSgpLnRyaW0oKSkgewogICAgICAgICAgICAgICAgICAgICAgICAgICAgZ2V0QWRkcmVzcyA9IHByZW1pc2Uuc2hvcnRfbmFtZSArICcsICcgKyBhZGRyZXNzX2FycmF5WzFdOwogICAgICAgICAgICAgICAgICAgICAgICB9CgogICAgICAgICAgICAgICAgICAgICAgICBpZiAoZ2V0QWRkcmVzcyA9PSAnJyAmJiAhKHR5cGVvZihwcmVtaXNlLnNob3J0X25hbWUpID09ICd1bmRlZmluZWQnIHx8IHByZW1pc2Uuc2hvcnRfbmFtZSA9PSBudWxsKSAmJiBwcmVtaXNlLnNob3J0X25hbWUudG9Mb3dlckNhc2UoKSA9PSBhZGRyZXNzX2FycmF5WzFdLnRvTG93ZXJDYXNlKCkudHJpbSgpKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzID0gYWRkcmVzc19hcnJheVswXSArICcsICcgKyBwcmVtaXNlLnNob3J0X25hbWU7CiAgICAgICAgICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChnZXRBZGRyZXNzID09ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzID0gJ25vbmUnCiAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGlmIGVzdGFibGlzaG1lbnQgdGhlbiBncmFiIHNlY29uZCBhcnIKICAgICAgICAgICAgaWYgKGdldEFkZHJlc3MgPT0gJ25vbmUnICYmIHR5cGVvZihlc3RhYmxpc2htZW50LmxvbmdfbmFtZSkgIT09ICd1bmRlZmluZWQnICYmIHR5cGVvZihhZGRyZXNzX2FycmF5WzFdKSAhPT0gJ3VuZGVmaW5lZCcpIHsKICAgICAgICAgICAgICAgIGdldEFkZHJlc3MgPSBhZGRyZXNzX2FycmF5WzFdOwogICAgICAgICAgICAgICAgZ2V0QWRkcmVzczIgPSBhZGRyZXNzX2FycmF5WzBdOwogICAgICAgICAgICB9IGVsc2UgaWYoZ2V0QWRkcmVzcyA9PSAnbm9uZScgKSB7LyogYWRkZWQgdG8gZml4IHN0cmVldCBudW1iZXIgZm9yIFJVIGxvY2F0aW9ucyAqLwogICAgICAgICAgICAgICAgZ2V0QWRkcmVzcyA9IGFkZHJlc3NfYXJyYXlbMF07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vIGFkZHJlc3MyCiAgICAgICAgICAgIGlmKHByZW1pc2UubG9uZ19uYW1lICYmIHByZW1pc2UubG9uZ19uYW1lICE9IGdldEFkZHJlc3MpewogICAgICAgICAgICAgICAgZ2V0QWRkcmVzczIgPSBwcmVtaXNlLmxvbmdfbmFtZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYgKGdldEFkZHJlc3MgPT0gJycpIHsKICAgICAgICAgICAgICAgIGlmIChzdHJlZXRfbnVtYmVyLmxvbmdfbmFtZSkKICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzICs9IHN0cmVldF9udW1iZXIubG9uZ19uYW1lICsgJyAnOy8vc3RyZWV0X251bWJlcgogICAgICAgICAgICAgICAgaWYgKHJvdXRlLmxvbmdfbmFtZSkKICAgICAgICAgICAgICAgICAgICBnZXRBZGRyZXNzICs9IHJvdXRlLmxvbmdfbmFtZTsvL3JvdXRlCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGdldFppcCA9IHBvc3RhbF9jb2RlLmxvbmdfbmFtZTsvL3Bvc3RhbF9jb2RlCgogICAgICAgICAgICAvL2dldENvdW50cnkKICAgICAgICAgICAgaWYgKGNvdW50cnkubG9uZ19uYW1lKSB7CiAgICAgICAgICAgICAgICBnZXRDb3VudHJ5ID0gY291bnRyeS5sb25nX25hbWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGNvdW50cnkuc2hvcnRfbmFtZSkgewogICAgICAgICAgICAgICAgZ2V0Q291bnRyeUlTTyA9IGNvdW50cnkuc2hvcnRfbmFtZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy9nZXRTdGF0ZQogICAgICAgICAgICBpZiAoY291bnRyeS5zaG9ydF9uYW1lKSB7CiAgICAgICAgICAgICAgICByciA9IGNvdW50cnkuc2hvcnRfbmFtZTsKICAgICAgICAgICAgfQogICAgICAgICAgICAvLyRjb3VudHJ5X2FyciA9IFsiVVMiLCAiQ0EiLCAiSU4iLCJERSIsIk5MIl07CiAgICAgICAgICAgIC8vIGZpeCBmb3IgcmVnaW9ucyBpbiBHQgoKICAgICAgICAgICAgJGNvdW50cnlfYXJyID0gPD9waHAKICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIEZpbHRlciB0aGUgcmVnaW9ucyBhcnJheSB0aGF0IHVzZXMgYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8yIGluc3RlYWQgb2YgYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8xLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBAc2luY2UgMS42LjE2CiAgICAgICAgICAgICAqLwogICAgICAgICAgICBlY2hvIGFwcGx5X2ZpbHRlcnMoImdlb2Rpcl9nZW9jb2RlX3JlZ2lvbl9sZXZlbCIsJ1siR0IiLCJFUyJdJyk7Pz47CiAgICAgICAgICAgIGlmIChqUXVlcnkuaW5BcnJheShyciwgJGNvdW50cnlfYXJyKSAhPT0gLTEpIHsKICAgICAgICAgICAgICAgIGlmIChhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzIubG9uZ19uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgZ2V0U3RhdGUgPSBhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzIubG9uZ19uYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8xLmxvbmdfbmFtZSkgewogICAgICAgICAgICAgICAgICAgIGdldFN0YXRlID0gYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8xLmxvbmdfbmFtZTsKICAgICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgICAvLyBmaXggc29tZSBHQiByZWdpb25zCiAgICAgICAgICAgICAgICBpZiggcnIgPT0gIkdCIiApewogICAgICAgICAgICAgICAgICAgIGlmKGdldFN0YXRlICYmIGdldFN0YXRlID09ICJTdG9rZS1vbi1UcmVudCIgKXsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0U3RhdGUgPSAnU3RhZmZvcmRzaGlyZSc7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQoKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgIGlmIChhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzEubG9uZ19uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgZ2V0U3RhdGUgPSBhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzEubG9uZ19uYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8yLmxvbmdfbmFtZSkgewogICAgICAgICAgICAgICAgICAgIGdldFN0YXRlID0gYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8yLmxvbmdfbmFtZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQoKICAgICAgICAgICAgLyogRml4IHNvbWUgY291bnRyaWVzIHdpdGhvdXQgcmVnaW9ucywgSXNsZSBvZiBNYW4sIFNpbmdhcG9yZSwgR3JlZWNlLiAqLwogICAgICAgICAgICBpZiAoZ2V0Q291bnRyeUlTTz09J0lNJyl7CiAgICAgICAgICAgICAgICBnZXRTdGF0ZSA9ICJJc2xlIG9mIE1hbiI7CiAgICAgICAgICAgIH1lbHNlIGlmKGdldENvdW50cnlJU089PSdTRycpewogICAgICAgICAgICAgICAgZ2V0U3RhdGUgPSAiU2luZ2Fwb3JlIjsKICAgICAgICAgICAgfSBlbHNlIGlmKGdldENvdW50cnlJU08gPT0gJ0dSJyAmJiAhZ2V0U3RhdGUgJiYgYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8zLmxvbmdfbmFtZSkgewogICAgICAgICAgICAgICAgZ2V0U3RhdGUgPSBhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzMubG9uZ19uYW1lOwogICAgICAgICAgICB9CgogICAgICAgICAgICAvL2dldENpdHkKICAgICAgICAgICAgLy8gZml4IGZvciBjaXRpZXMgaW4gSXJlbGFuZAogICAgICAgICAgICAkY291bnRyeV9hcnIyID0gWyJJRSJdOwogICAgICAgICAgICBpZiAoalF1ZXJ5LmluQXJyYXkocnIsICRjb3VudHJ5X2FycjIpICE9PSAtMSkgewogICAgICAgICAgICAgICAgaWYgKGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMi5sb25nX25hbWUgJiYgYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8yLmxvbmdfbmFtZS5pbmRleE9mKCIgQ2l0eSIpID49IDApIHsKICAgICAgICAgICAgICAgICAgICBnZXRDaXR5ID0gYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8yLmxvbmdfbmFtZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKGxvY2FsaXR5LmxvbmdfbmFtZSkgewogICAgICAgICAgICAgICAgICAgIGdldENpdHkgPSBsb2NhbGl0eS5sb25nX25hbWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmIChwb3N0YWxfdG93bi5sb25nX25hbWUpIHsKICAgICAgICAgICAgICAgICAgICBnZXRDaXR5ID0gcG9zdGFsX3Rvd24ubG9uZ19uYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoc3VibG9jYWxpdHlfbGV2ZWxfMS5sb25nX25hbWUpIHsKICAgICAgICAgICAgICAgICAgICBnZXRDaXR5ID0gc3VibG9jYWxpdHlfbGV2ZWxfMS5sb25nX25hbWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmIChhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzMubG9uZ19uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgZ2V0Q2l0eSA9IGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMy5sb25nX25hbWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gZWxzZSBpZihycj09IlRSIikgewogICAgICAgICAgICAgICAgaWYgKGxvY2FsaXR5LmxvbmdfbmFtZSkgewogICAgICAgICAgICAgICAgICAgIGdldENpdHkgPSBsb2NhbGl0eS5sb25nX25hbWU7CiAgICAgICAgICAgICAgICB9ZWxzZSBpZiAocG9zdGFsX3Rvd24ubG9uZ19uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgZ2V0Q2l0eSA9IHBvc3RhbF90b3duLmxvbmdfbmFtZTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGVsc2UgaWYgKHN1YmxvY2FsaXR5X2xldmVsXzEubG9uZ19uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgZ2V0Q2l0eSA9IHN1YmxvY2FsaXR5X2xldmVsXzEubG9uZ19uYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8zLmxvbmdfbmFtZSkgewogICAgICAgICAgICAgICAgICAgIGdldENpdHkgPSBhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzMubG9uZ19uYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoYWRtaW5pc3RyYXRpdmVfYXJlYV9sZXZlbF8xLmxvbmdfbmFtZSkgewogICAgICAgICAgICAgICAgICAgIGdldENpdHkgPSBhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzEubG9uZ19uYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9ZWxzZSBpZihycj09IkZSIikgewoKICAgICAgICAgICAgICAgIGlmIChhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzIubG9uZ19uYW1lPT0nUGFyaXMnKSB7CiAgICAgICAgICAgICAgICAgICAgZ2V0Q2l0eSA9IGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMi5sb25nX25hbWU7CiAgICAgICAgICAgICAgICB9ZWxzZXsKICAgICAgICAgICAgICAgICAgICBpZiAobG9jYWxpdHkubG9uZ19uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGdldENpdHkgPSBsb2NhbGl0eS5sb25nX25hbWU7CiAgICAgICAgICAgICAgICAgICAgfWVsc2UgaWYgKHBvc3RhbF90b3duLmxvbmdfbmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICBnZXRDaXR5ID0gcG9zdGFsX3Rvd24ubG9uZ19uYW1lOwogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChzdWJsb2NhbGl0eV9sZXZlbF8xLmxvbmdfbmFtZSkgewogICAgICAgICAgICAgICAgICAgICAgICBnZXRDaXR5ID0gc3VibG9jYWxpdHlfbGV2ZWxfMS5sb25nX25hbWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMy5sb25nX25hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Q2l0eSA9IGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMy5sb25nX25hbWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIGVsc2UgaWYgKGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMS5sb25nX25hbWUpIHsKICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Q2l0eSA9IGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMS5sb25nX25hbWU7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9ZWxzZSB7CiAgICAgICAgICAgICAgICBpZiAobG9jYWxpdHkubG9uZ19uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgZ2V0Q2l0eSA9IGxvY2FsaXR5LmxvbmdfbmFtZTsKICAgICAgICAgICAgICAgIH1lbHNlIGlmIChwb3N0YWxfdG93bi5sb25nX25hbWUpIHsKICAgICAgICAgICAgICAgICAgICBnZXRDaXR5ID0gcG9zdGFsX3Rvd24ubG9uZ19uYW1lOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgZWxzZSBpZiAoc3VibG9jYWxpdHlfbGV2ZWxfMS5sb25nX25hbWUpIHsKICAgICAgICAgICAgICAgICAgICBnZXRDaXR5ID0gc3VibG9jYWxpdHlfbGV2ZWxfMS5sb25nX25hbWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmIChhZG1pbmlzdHJhdGl2ZV9hcmVhX2xldmVsXzMubG9uZ19uYW1lKSB7CiAgICAgICAgICAgICAgICAgICAgZ2V0Q2l0eSA9IGFkbWluaXN0cmF0aXZlX2FyZWFfbGV2ZWxfMy5sb25nX25hbWU7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIC8vZ2V0Q291bnRyeSAKICAgICAgICAgICAgaWYgKGNvdW50cnkubG9uZ19uYW1lKSB7CiAgICAgICAgICAgICAgICBnZXRDb3VudHJ5ID0gY291bnRyeS5sb25nX25hbWU7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgLy9nZXRaaXAgCiAgICAgICAgICAgIGlmIChwb3N0YWxfY29kZS5sb25nX25hbWUpIHsKICAgICAgICAgICAgICAgIGdldFppcCA9IHBvc3RhbF9jb2RlLmxvbmdfbmFtZTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gQWRqdXN0IEphcGFuZXNlIHN0cmVldCBhZGRyZXNzLgogICAgICAgICAgICBpZiAoZ2V0Q291bnRyeUlTTyA9PSAnSlAnICYmIGZvcm1hdHRlZF9hZGRyZXNzICE9ICcnICYmICFnZXRBZGRyZXNzICYmIG1hcExhbmcgPT0gJ2phJykgewogICAgICAgICAgICAgICAgZm9ybWF0dGVkX2FkZHJlc3MgPSBmb3JtYXR0ZWRfYWRkcmVzcy5yZXBsYWNlKGdldENvdW50cnkgKyAi44CBIiwgIiIpOwogICAgICAgICAgICAgICAgaWYgKGdldFppcCkgewogICAgICAgICAgICAgICAgICAgIGZvcm1hdHRlZF9hZGRyZXNzID0gZm9ybWF0dGVkX2FkZHJlc3MucmVwbGFjZShnZXRDb3VudHJ5ICsgIiDjgJIiICsgZ2V0WmlwLCAi44CSIiArIGdldFppcCk7CiAgICAgICAgICAgICAgICAgICAgZm9ybWF0dGVkX2FkZHJlc3MgPSBmb3JtYXR0ZWRfYWRkcmVzcy5yZXBsYWNlKCLjgJIiICsgZ2V0WmlwICsgIiAiLCAiIik7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBfZm9ybWF0dGVkX2FkZHJlc3MgPSAnJzsKICAgICAgICAgICAgICAgIGlmIChnZXRDaXR5ICYmIGZvcm1hdHRlZF9hZGRyZXNzLmluZGV4T2YoZ2V0Q2l0eSkgIT09IC0xKSB7CiAgICAgICAgICAgICAgICAgICAgX2Zvcm1hdHRlZF9hZGRyZXNzID0gZm9ybWF0dGVkX2FkZHJlc3Muc3BsaXQoZ2V0Q2l0eSk7CiAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGdldFN0YXRlICYmIGZvcm1hdHRlZF9hZGRyZXNzLmluZGV4T2YoZ2V0U3RhdGUpICE9PSAtMSkgewogICAgICAgICAgICAgICAgICAgIF9mb3JtYXR0ZWRfYWRkcmVzcyA9IGZvcm1hdHRlZF9hZGRyZXNzLnNwbGl0KGdldFN0YXRlKTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgIGdldEFkZHJlc3MgPSBfZm9ybWF0dGVkX2FkZHJlc3MubGVuZ3RoID4gMSA/IF9mb3JtYXR0ZWRfYWRkcmVzc1soKF9mb3JtYXR0ZWRfYWRkcmVzcy5sZW5ndGgpLTEpXSA6IGZvcm1hdHRlZF9hZGRyZXNzOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGNvbnNvbGUubG9nKGdldEFkZHJlc3MrJywgJytnZXRDaXR5KycsICcrZ2V0U3RhdGUrJywgJytnZXRDb3VudHJ5KTsKICAgICAgICAgICAgPD9waHAgCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBGaXJlcyB0byBhZGQgamF2YXNjcmlwdCB2YXJpYWJsZSB0byB1c2UgaW4gZ29vZ2xlIG1hcC4KICAgICAgICAgICAgICoKICAgICAgICAgICAgICogQHNpbmNlIDEuMC4wCiAgICAgICAgICAgICAqLwogICAgICAgICAgICBkb19hY3Rpb24oJ2dlb2Rpcl9hZGRfbGlzdGluZ19nZW9jb2RlX2pzX3ZhcnMnKTsKICAgICAgICAgICAgPz4KICAgICAgICAgICAgPD9waHAgaWYgKCRpc19tYXBfcmVzdHJpY3QpIHsgPz4KICAgICAgICAgICAgaWYgKGdldENpdHkudG9Mb3dlckNhc2UoKSAhPSAnPD9waHAgZWNobyBnZW9kaXJfc3RydG9sb3dlcihhZGRzbGFzaGVzX2dwYygkY2l0eSkpOz8+JykgewogICAgICAgICAgICAgICAgYWxlcnQoJzw/cGhwIGVjaG8gYWRkc2xhc2hlc19ncGMod3Bfc3ByaW50ZihfXygnUGxlYXNlIGNob29zZSBhbnkgYWRkcmVzcyBvZiB0aGUgKCVzKSBjaXR5IG9ubHkuJywnZ2VvZGlyZWN0b3J5JyksICRjaXR5KSk7Pz4nKTsKICAgICAgICAgICAgICAgIGpRdWVyeSgiIzw/cGhwIGVjaG8gJHByZWZpeC4nbWFwJzs/PiIpLmdvTWFwKCk7CiAgICAgICAgICAgICAgICBqUXVlcnkuZ29NYXAubWFwLnNldENlbnRlcihuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKCc8P3BocCBlY2hvICRkZWZhdWx0X2xhdDsgPz4nLCAnPD9waHAgZWNobyAkZGVmYXVsdF9sbmc7ID8+JykpOwogICAgICAgICAgICAgICAgYmFzZU1hcmtlci5zZXRQb3NpdGlvbihuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKCc8P3BocCBlY2hvICRkZWZhdWx0X2xhdDsgPz4nLCAnPD9waHAgZWNobyAkZGVmYXVsdF9sbmc7ID8+JykpOwogICAgICAgICAgICAgICAgdXBkYXRlTWFya2VyUG9zaXRpb24oYmFzZU1hcmtlci5nZXRQb3NpdGlvbigpKTsKICAgICAgICAgICAgICAgIC8vZ2VvY29kZVBvc2l0aW9uKGJhc2VNYXJrZXIuZ2V0UG9zaXRpb24oKSk7CiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7alF1ZXJ5KCcjYWRkcmVzc19zdHJlZXQsI2FkZHJlc3NfemlwJykudmFsKCcnKTt9LCAxMDApOwogICAgICAgICAgICB9CiAgICAgICAgICAgIDw/cGhwIH0gPz4KICAgICAgICAgICAgdXBkYXRlTWFya2VyQWRkcmVzcyhnZXRBZGRyZXNzLCBnZXRaaXAsIGdldENpdHksIGdldFN0YXRlLCBnZXRDb3VudHJ5LCBnZXRBZGRyZXNzMik7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgPD9waHAgCiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBGaXJlcyB0byBhZGQgamF2YXNjcmlwdCB2YXJpYWJsZSB0byB1c2UgaW4gZ29vZ2xlIG1hcC4KICAgICAgICAgICAgICoKICAgICAgICAgICAgICogQHNpbmNlIDEuMC4wCiAgICAgICAgICAgICAqLwogICAgICAgICAgICBkb19hY3Rpb24oICdnZW9kaXJfYWRkX2xpc3RpbmdfZ2VvY29kZV9yZXNwb25zZV9mYWlsJyApOwogICAgICAgICAgICA/PgoJCQl1cGRhdGVNYXJrZXJBZGRyZXNzKCc8P3BocCBlY2hvIGFkZHNsYXNoZXNfZ3BjKF9fKCdDYW5ub3QgZGV0ZXJtaW5lIGFkZHJlc3MgYXQgdGhpcyBsb2NhdGlvbi4nLCdnZW9kaXJlY3RvcnknKSk7Pz4nKTsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBjZW50ZXJNYXAobGF0bG5nKSB7CiAgICAgICAgalF1ZXJ5KCIjPD9waHAgZWNobyAkcHJlZml4LidtYXAnOz8+IikuZ29NYXAoKTsKICAgICAgICBpZiAod2luZG93LmdkTWFwcyA9PSAnZ29vZ2xlJykgewogICAgICAgICAgICBqUXVlcnkuZ29NYXAubWFwLnBhblRvKGJhc2VNYXJrZXIuZ2V0UG9zaXRpb24oKSk7CiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cuZ2RNYXBzID09ICdvc20nKSB7CiAgICAgICAgICAgIGxhdGxuZyA9IGxhdGxuZyA/IGxhdGxuZyA6IGJhc2VNYXJrZXIuZ2V0TGF0TG5nKCk7CiAgICAgICAgICAgIGpRdWVyeS5nb01hcC5tYXAucGFuVG8obGF0bG5nKTsKICAgICAgICB9CiAgICB9CiAgICBmdW5jdGlvbiBjZW50ZXJNYXJrZXIoKSB7CiAgICAgICAgalF1ZXJ5KCIjPD9waHAgZWNobyAkcHJlZml4LidtYXAnOz8+IikuZ29NYXAoKTsKICAgICAgICB2YXIgY2VudGVyID0galF1ZXJ5LmdvTWFwLm1hcC5nZXRDZW50ZXIoKTsKICAgICAgICBpZiAod2luZG93LmdkTWFwcyA9PSAnZ29vZ2xlJykgewogICAgICAgICAgICBiYXNlTWFya2VyLnNldFBvc2l0aW9uKGNlbnRlcik7CiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cuZ2RNYXBzID09ICdvc20nKSB7CiAgICAgICAgICAgIGJhc2VNYXJrZXIuc2V0TGF0TG5nKGNlbnRlcik7CiAgICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gdXBkYXRlTWFwWm9vbSh6b29tKSB7CiAgICAgICAgalF1ZXJ5KCcjPD9waHAgZWNobyAkcHJlZml4LidtYXB6b29tJzs/PicpLnZhbCh6b29tKTsKICAgIH0KICAgIGZ1bmN0aW9uIHVwZGF0ZU1hcmtlclBvc2l0aW9uKG1hcmtlcmxhdExuZykgewogICAgICAgIGpRdWVyeSgiIzw/cGhwIGVjaG8gJHByZWZpeC4nbWFwJzs/PiIpLmdvTWFwKCk7CiAgICAgICAgalF1ZXJ5KCcjPD9waHAgZWNobyAkcHJlZml4LidsYXRpdHVkZSc7Pz4nKS52YWwobWFya2VybGF0TG5nLmxhdCgpKS50cmlnZ2VyKCdjaGFuZ2UnKTsKICAgICAgICBqUXVlcnkoJyM8P3BocCBlY2hvICRwcmVmaXguJ2xvbmdpdHVkZSc7Pz4nKS52YWwobWFya2VybGF0TG5nLmxuZygpKS50cmlnZ2VyKCdjaGFuZ2UnKTsKICAgIH0KICAgIGZ1bmN0aW9uIHVwZGF0ZU1hcmtlclBvc2l0aW9uT1NNKG1hcmtlcmxhdExuZykgewogICAgICAgIGpRdWVyeSgnIzw/cGhwIGVjaG8gJHByZWZpeC4nbGF0aXR1ZGUnOz8+JykudmFsKG1hcmtlcmxhdExuZy5sYXQpLnRyaWdnZXIoJ2NoYW5nZScpOwogICAgICAgIGpRdWVyeSgnIzw/cGhwIGVjaG8gJHByZWZpeC4nbG9uZ2l0dWRlJzs/PicpLnZhbChtYXJrZXJsYXRMbmcubG5nKS50cmlnZ2VyKCdjaGFuZ2UnKTsKICAgIH0KICAgIGZ1bmN0aW9uIHVwZGF0ZU1hcmtlckFkZHJlc3MoZ2V0QWRkcmVzcywgZ2V0WmlwLCBnZXRDaXR5LCBnZXRTdGF0ZSwgZ2V0Q291bnRyeSwgZ2V0QWRkcmVzczIpIHsKICAgICAgICB2YXIgc2V0X21hcF92YWxfaW5fZmllbGRzID0gJzw/cGhwIGVjaG8gYWRkc2xhc2hlc19ncGMoJGF1dG9fY2hhbmdlX21hcF9maWVsZHMpOz8+JzsKICAgICAgICA8P3BocCBvYl9zdGFydCgpOz8+CiAgICAgICAgdmFyIG9sZF9jb3VudHJ5ID0galF1ZXJ5KCIjPD9waHAgZWNobyAkcHJlZml4Lidjb3VudHJ5Jzs/PiIpLnZhbCgpOwogICAgICAgIHZhciBvbGRfcmVnaW9uID0galF1ZXJ5KCIjPD9waHAgZWNobyAkcHJlZml4LidyZWdpb24nOz8+IikudmFsKCk7CiAgICAgICAgdmFyIG9sZF9jaXR5ID0galF1ZXJ5KCIjPD9waHAgZWNobyAkcHJlZml4LidjaXR5Jzs/PiIpLnZhbCgpOwogICAgICAgIHZhciBvbGRfemlwID0galF1ZXJ5KCIjPD9waHAgZWNobyAkcHJlZml4Lid6aXAnOz8+IikudmFsKCk7CgogICAgICAgIGlmICh1c2VyX2FkZHJlc3MgPT0gZmFsc2UgfHwgalF1ZXJ5KCcjPD9waHAgZWNobyAkcHJlZml4LidzdHJlZXQnOz8+JykudmFsKCkgPT0gJycpIHsKICAgICAgICAgICAgalF1ZXJ5KCIjPD9waHAgZWNobyAkcHJlZml4LidzdHJlZXQnOz8+IikudmFsKGdldEFkZHJlc3MpLnRyaWdnZXIoImJsdXIiKTsKICAgICAgICB9CiAgICAgICAgaWYgKGdldEFkZHJlc3MpIHsKICAgICAgICAgICAgb2xkc3RyX2FkZHJlc3MgPSBnZXRBZGRyZXNzOwogICAgICAgIH0KICAgICAgICBpZiAoZ2V0QWRkcmVzczIgJiYgKHVzZXJfYWRkcmVzcyA9PSBmYWxzZSB8fCBqUXVlcnkoJyM8P3BocCBlY2hvICRwcmVmaXguJ3N0cmVldDInOz8+JykudmFsKCkgPT0gJycpKSB7CiAgICAgICAgICAgIGpRdWVyeSgiIzw/cGhwIGVjaG8gJHByZWZpeC4nc3RyZWV0Mic7Pz4iKS52YWwoZ2V0QWRkcmVzczIpOwogICAgICAgIH0KICAgICAgICBpZiAoZ2V0QWRkcmVzczIpIHsKICAgICAgICAgICAgb2xkc3RyX2FkZHJlc3MyID0gZ2V0QWRkcmVzczI7CiAgICAgICAgfQoKICAgICAgICB2YXIgdXBkYXRlWmlwID0gdHJ1ZTsKICAgICAgICBpZiAoIWdldFppcCAmJiBvbGRfemlwICYmIG9sZF9jaXR5ICYmIG9sZF9jaXR5ID09IGdldENpdHkpIHsKICAgICAgICAgICAgdXBkYXRlWmlwID0gZmFsc2U7CiAgICAgICAgfQogICAgICAgIGlmICh1cGRhdGVaaXApIHsKICAgICAgICAgICAgalF1ZXJ5KCIjPD9waHAgZWNobyAkcHJlZml4Lid6aXAnOz8+IikudmFsKGdldFppcCk7CiAgICAgICAgfQogICAgICAgIGlmIChnZXRaaXApIHsKICAgICAgICAgICAgb2xkc3RyX3ppcCA9IGdldFppcDsKICAgICAgICB9CiAgICAgICAgaWYgKHNldF9tYXBfdmFsX2luX2ZpZWxkcykgewogICAgICAgICAgICBpZiAoZ2V0Q291bnRyeSkgewogICAgICAgICAgICAgICBzZXRDb3VudHJ5ID0galF1ZXJ5KCcjPD9waHAgZWNobyAkcHJlZml4IC4gJ2NvdW50cnknOyA/PiBvcHRpb25bZGF0YS1jb3VudHJ5X2NvZGU9IicgKyBnZXRDb3VudHJ5SVNPICsgJyJdJykudmFsKCk7CiAgICAgICAgICAgICAgIGlmICghc2V0Q291bnRyeSkgewogICAgICAgICAgICAgICAgICAgc2V0Q291bnRyeSA9IGdldENvdW50cnk7CiAgICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICAgICBnZXRDb3VudHJ5ID0gc2V0Q291bnRyeTsKICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICBqUXVlcnkoIiM8P3BocCBlY2hvICRwcmVmaXggLiAnY291bnRyeSc7ID8+IikudmFsKHNldENvdW50cnkpLnRyaWdnZXIoJ2NoYW5nZS5zZWxlY3QyJyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKGdldFN0YXRlKSB7CiAgICAgICAgICAgICAgICBpZiAoalF1ZXJ5KCJpbnB1dCM8P3BocCBlY2hvICRwcmVmaXggLiAncmVnaW9uJzsgPz4iKS5sZW5ndGgpIHsKICAgICAgICAgICAgICAgICAgICBqUXVlcnkoIiM8P3BocCBlY2hvICRwcmVmaXggLiAncmVnaW9uJzsgPz4iKS52YWwoZ2V0U3RhdGUpOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChnZXRDaXR5KSB7CiAgICAgICAgICAgICAgICBpZiAoalF1ZXJ5KCJpbnB1dCM8P3BocCBlY2hvICRwcmVmaXggLiAnY2l0eSc7ID8+IikubGVuZ3RoKSB7CiAgICAgICAgICAgICAgICAgICAgalF1ZXJ5KCIjPD9waHAgZWNobyAkcHJlZml4IC4gJ2NpdHknOyA/PiIpLnZhbChnZXRDaXR5KTsKICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgIH0KICAgICAgICA8P3BocAogICAgICAgIC8qKgogICAgICAgICAqIEZpcmVzIHdoZW4gbWFya2VyIGFkZHJlc3MgdXBkYXRlZCBvbiBtYXAuCiAgICAgICAgICoKICAgICAgICAgKiBAc2luY2UgMS4wLjAKICAgICAgICAgKiBAcGFyYW0gc3RyaW5nICRwcmVmaXggSWRlbnRpZmllciB1c2VkIGFzIGEgcHJlZml4IGZvciBmaWVsZCBuYW1lCiAgICAgICAgICovCiAgICAgICAgZG9fYWN0aW9uKCdnZW9kaXJfdXBkYXRlX21hcmtlcl9hZGRyZXNzJywgJHByZWZpeCk7CiAgICAgICAgZWNobyAkdXBkYXRlTWFya2VyQWRkcmVzcyA9IG9iX2dldF9jbGVhbigpOwogICAgICAgID8+CiAgICB9CiAgICBmdW5jdGlvbiBnZW9kaXJfY29kZUFkZHJlc3Moc2V0X29uX21hcCkgewogICAgICAgIHZhciBhZGRyZXNzID0galF1ZXJ5KCcjPD9waHAgZWNobyAkcHJlZml4LidzdHJlZXQnOz8+JykudmFsKCk7CiAgICAgICAgdmFyIHppcCA9IGpRdWVyeSgnIzw/cGhwIGVjaG8gJHByZWZpeC4nemlwJzs/PicpLnZhbCgpOwogICAgICAgIHZhciBjaXR5ID0galF1ZXJ5KCcjPD9waHAgZWNobyAkcHJlZml4LidjaXR5Jzs/PicpLnZhbCgpOwogICAgICAgIHZhciByZWdpb24gPSBqUXVlcnkoJyM8P3BocCBlY2hvICRwcmVmaXguJ3JlZ2lvbic7Pz4nKS52YWwoKTsKICAgICAgICB2YXIgY291bnRyeSA9IGpRdWVyeSgnIzw/cGhwIGVjaG8gJHByZWZpeC4nY291bnRyeSc7Pz4nKS52YWwoKTsKICAgICAgICB2YXIgY291bnRyeV9zZWxlY3RlZCA9IGpRdWVyeSgnIzw/cGhwIGVjaG8gJHByZWZpeC4nY291bnRyeSc7Pz4nKS5maW5kKCdvcHRpb246c2VsZWN0ZWQnKTsKICAgICAgICB2YXIgSVNPMiA9IGNvdW50cnlfc2VsZWN0ZWQuZGF0YSgnY291bnRyeV9jb2RlJyk7CiAgICAgICAgaWYgKCFJU08yICYmIGpRdWVyeSgnIzw/cGhwIGVjaG8gJHByZWZpeC4nY291bnRyeSc7Pz4nKS5kYXRhKCdjb3VudHJ5X2NvZGUnKSkgewogICAgICAgICAgICBJU08yID0galF1ZXJ5KCcjPD9waHAgZWNobyAkcHJlZml4Lidjb3VudHJ5Jzs/PicpLmRhdGEoJ2NvdW50cnlfY29kZScpOwogICAgICAgIH0KICAgICAgICBpZighSVNPMil7CiAgICAgICAgICAgIDw/cGhwCiAgICAgICAgICAgIGlmKCFkZWZpbmVkKCdHRU9ESVJMT0NBVElPTl9URVhURE9NQUlOJykpewogICAgICAgICAgICAgICAgZ2xvYmFsICR3cGRiOwogICAgICAgICAgICAgICAgJGxvY2F0aW9uX3Jlc3VsdCA9ICRnZW9kaXJlY3RvcnktPmxvY2F0aW9uLT5nZXRfZGVmYXVsdF9sb2NhdGlvbigpOwogICAgICAgICAgICAgICAgaWYoIWVtcHR5KCRsb2NhdGlvbl9yZXN1bHQpKXsKICAgICAgICAgICAgICAgICAgICAkSVNPMiA9IHdwX2NvdW50cnlfZGF0YWJhc2UoKS0+Z2V0X2NvdW50cnlfaXNvMigkbG9jYXRpb25fcmVzdWx0LT5jb3VudHJ5KTsKICAgICAgICAgICAgICAgICAgICBlY2hvICJJU08yID0gJyRJU08yJzsiOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CgoKICAgICAgICAgICAgPz4KICAgICAgICB9CiAgICAgICAgaWYgKElTTzIgPT0gJy0tJykgewogICAgICAgICAgICBJU08yID0gJyc7CiAgICAgICAgfQogICAgICAgIAogICAgICAgIGlmICh0eXBlb2YgemlwID09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgIHppcCA9ICcnOwogICAgICAgIH0KICAgICAgICBpZiAodHlwZW9mIGNpdHkgPT0gInVuZGVmaW5lZCIpIHsKICAgICAgICAgICAgY2l0eSA9ICc8P3BocCBlY2hvIGFkZHNsYXNoZXNfZ3BjKCRjaXR5KTs/Pic7CiAgICAgICAgfQogICAgICAgIGlmICh0eXBlb2YgcmVnaW9uID09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgIHJlZ2lvbiA9ICc8P3BocCBlY2hvIGFkZHNsYXNoZXNfZ3BjKCRyZWdpb24pOz8+JzsKICAgICAgICB9CiAgICAgICAgaWYgKHR5cGVvZiBjb3VudHJ5ID09ICJ1bmRlZmluZWQiKSB7CiAgICAgICAgICAgIGNvdW50cnkgPSAnPD9waHAgZWNobyBhZGRzbGFzaGVzX2dwYygkY291bnRyeSk7Pz4nOwogICAgICAgIH0KICAgICAgICB2YXIgaXNfcmVzdHJpY3QgPSAnPD9waHAgZWNobyAkaXNfbWFwX3Jlc3RyaWN0OyA/Pic7CiAgICAgICAgPD9waHAgb2Jfc3RhcnQoKTsKICAgICAgICAkZGVmYXVsdHJlZ2lvbiA9IGlzc2V0KCRkZWZhdWx0X2xvY2F0aW9uLT5yZWdpb24pID8gJGRlZmF1bHRfbG9jYXRpb24tPnJlZ2lvbiA6ICcnOwogICAgICAgICRkZWZhdWx0Y291bnRyeSA9IGlzc2V0KCRkZWZhdWx0X2xvY2F0aW9uLT5jb3VudHJ5KSA/ICRkZWZhdWx0X2xvY2F0aW9uLT5jb3VudHJ5IDogJyc7CiAgICAgICAgPz4KICAgICAgICBpZiAoc2V0X29uX21hcCAmJiBpc19yZXN0cmljdCkgewogICAgICAgICAgICBpZiAoemlwICE9ICcnICYmIGFkZHJlc3MgIT0gJycpIHsKICAgICAgICAgICAgICAgIGFkZHJlc3MgPSBhZGRyZXNzICsgJywnICsgemlwOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKHR5cGVvZiBhZGRyZXNzID09PSAndW5kZWZpbmVkJykKICAgICAgICAgICAgICAgIGFkZHJlc3MgPSAnJzsKCiAgICAgICAgICAgIGlmKCBhZGRyZXNzID09IGNpdHkgfHwgYWRkcmVzcyA9PSByZWdpb24gfHwgYWRkcmVzcyA9PSBjb3VudHJ5IHx8IGFkZHJlc3MgPT0gemlwICkKICAgICAgICAgICAgICAgIGFkZHJlc3MgPSAnJzsKICAgICAgICAgICAgPD9waHAKICAgICAgICAgICAgaWYoaXNfYWRtaW4oKSAmJiBpc3NldCgkX1JFUVVFU1RbJ3RhYiddKSl7Pz4KICAgICAgICAgICAgaWYgKGpRdWVyeS50cmltKGNpdHkpID09ICcnIHx8IGpRdWVyeS50cmltKHJlZ2lvbikgPT0gJycpIHsKICAgICAgICAgICAgICAgIGFkZHJlc3MgPSAnJzsKICAgICAgICAgICAgfQogICAgICAgICAgICA8P3BocAogICAgICAgICAgICAgICB9Pz4KCiAgICAgICAgICAgIGlmIChJU08yID09ICdHQicpIHsKICAgICAgICAgICAgICAgIGFkZHJlc3MgPSBhZGRyZXNzICsgJywnICsgY2l0eSArICcsJyArIGNvdW50cnk7IC8vIFVLIGlzIGZ1bm55IHdpdGggcmVnaW9ucwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgYWRkcmVzcyA9IGFkZHJlc3MgKyAnLCcgKyBjaXR5ICsgJywnICsgcmVnaW9uICsgJywnICsgY291bnRyeTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgaWYoemlwIT0nJyl7CiAgICAgICAgICAgICAgICBhZGRyZXNzID0gYWRkcmVzcyArICcsJyArIHppcDsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8gaW5jYXNlIHRoZXJlIGFyZSBhbnkgbnVsbCB2YWx1ZXMKICAgICAgICAgICAgYWRkcmVzcyA9ICBhZGRyZXNzLnJlcGxhY2UoIixudWxsLCIsICIsIik7CiAgICAgICAgfQogICAgICAgIGlmIChhZGRyZXNzKSB7CiAgICAgICAgICAgIGFkZHJlc3MgPSAgYWRkcmVzcy5yZXBsYWNlKCIsbnVsbCwiLCAiLCIpOwogICAgICAgIH0KICAgICAgICA8P3BocCAkY29kZUFkZHJlc3MgPSBvYl9nZXRfY2xlYW4oKTsKICAgICAgICAvKioKICAgICAgICAgKiBGaWx0ZXIgdGhlIGFkZHJlc3MgdmFyaWFibGUKICAgICAgICAgKgogICAgICAgICAqIEBzaW5jZSAxLjAuMAogICAgICAgICAqCiAgICAgICAgICogQHBhcmFtIHN0cmluZyAkY29kZUFkZHJlc3MgUm93IG9mIGFkZHJlc3MgdG8gdXNlIGluIGdvb2dsZSBtYXAuCiAgICAgICAgICovCiAgICAgICAgZWNobyBhcHBseV9maWx0ZXJzKCdnZW9kaXJfY29kZWFkZHJlc3MnLCAkY29kZUFkZHJlc3MpOwogICAgICAgID8+CiAgICAgICAgaWYgKCF3aW5kb3cuZ2RNYXBzKSB7IC8vIE5vIEdvb2dsZSBNYXAgTG9hZGVkCiAgICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgaWYgKGFkZHJlc3MgJiYgYWRkcmVzcyAhPSAnJykgewogICAgICAgICAgICAvLyBSZXBsYWNlIG9uZSBvciBtb3JlIGNvbW1hcyBpbiBhIHJvdy4KICAgICAgICAgICAgYWRkcmVzcyA9IGFkZHJlc3MucmVwbGFjZSgvLCsvZywnLCcpOwogICAgICAgICAgICBhZGRyZXNzID0gYWRkcmVzcy5yZXBsYWNlKC8oXiwpfCgsJCkvZywgIiIpOwogICAgICAgIH0KICAgICAgICBpZiAoIHdpbmRvdy5nZE1hcHMgPT0gJ29zbScgKSB7CiAgICAgICAgICAgIGlmIChhZGRyZXNzICE9ICcnKSB7CiAgICAgICAgICAgICAgICBpZiAoemlwICE9ICcnKSB7CiAgICAgICAgICAgICAgICAgICAgc2VhcmNoWmlwID0gIiwiICsgemlwOwogICAgICAgICAgICAgICAgICAgIHZhciBuQWRkcmVzcyA9IGFkZHJlc3MudG9Mb3dlckNhc2UoKS5sYXN0SW5kZXhPZihzZWFyY2haaXAudG9Mb3dlckNhc2UoKSk7CiAgICAgICAgICAgICAgICAgICAgYWRkcmVzcyA9IGFkZHJlc3Muc2xpY2UoMCwgbkFkZHJlc3MpICsgYWRkcmVzcy5zbGljZShuQWRkcmVzcykucmVwbGFjZShuZXcgUmVnRXhwKHNlYXJjaFppcCwgJ2knKSwgIiIpOwogICAgICAgICAgICAgICAgfQoJCQkJPD9waHAgCgkJCQkvKioKCQkJCSAqIEZpcmVzIGJlZm9yZSBzZXQgZ2VvY29kZSBwb3NpdGlvbi4KCQkJCSAqCgkJCQkgKiBAc2luY2UgMS4wLjAKCQkJCSAqLwoJCQkJZG9fYWN0aW9uKCdnZW9kaXJfYWRkX2xpc3RpbmdfY29kZWFkZHJlc3NfYmVmb3JlX2dlb2NvZGUnKTsKCQkJCT8+CiAgICAgICAgICAgICAgICBnZW9jb2RlUG9zaXRpb25PU00oJycsIGFkZHJlc3MsIElTTzIsIHRydWUpOwogICAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgZ2VvY29kZXIuZ2VvY29kZSh7J2FkZHJlc3MnOiBhZGRyZXNzLCAnY291bnRyeSc6IElTTzJ9LAogICAgICAgICAgICAgICAgZnVuY3Rpb24gKHJlc3VsdHMsIHN0YXR1cykgewogICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHN0YXR1cyk7CiAgICAgICAgICAgICAgICAgICAgalF1ZXJ5KCIjPD9waHAgZWNobyAkcHJlZml4LidtYXAnOz8+IikuZ29NYXAoKTsKICAgICAgICAgICAgICAgICAgICBpZiAoc3RhdHVzID09IGdvb2dsZS5tYXBzLkdlb2NvZGVyU3RhdHVzLk9LKSB7CiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdHNbMF0pOwogICAgICAgICAgICAgICAgICAgICAgICBiYXNlTWFya2VyLnNldFBvc2l0aW9uKHJlc3VsdHNbMF0uZ2VvbWV0cnkubG9jYXRpb24pOwogICAgICAgICAgICAgICAgICAgICAgICBqUXVlcnkuZ29NYXAubWFwLnNldENlbnRlcihyZXN1bHRzWzBdLmdlb21ldHJ5LmxvY2F0aW9uKTsKICAgICAgICAgICAgICAgICAgICAgICAgdXBkYXRlTWFya2VyUG9zaXRpb24oYmFzZU1hcmtlci5nZXRQb3NpdGlvbigpKTsKICAgICAgICAgICAgICAgICAgICAgICAgLy9pZihzZXRfb25fbWFwICYmIGlzX3Jlc3RyaWN0KSB7CiAgICAgICAgICAgICAgICAgICAgICAgIDw/cGhwIAogICAgICAgICAgICAgICAgICAgICAgICAvKioKICAgICAgICAgICAgICAgICAgICAgICAgICogRmlyZXMgYmVmb3JlIHNldCBnZW9jb2RlIHBvc2l0aW9uLgogICAgICAgICAgICAgICAgICAgICAgICAgKgogICAgICAgICAgICAgICAgICAgICAgICAgKiBAc2luY2UgMS4wLjAKICAgICAgICAgICAgICAgICAgICAgICAgICovCiAgICAgICAgICAgICAgICAgICAgICAgIGRvX2FjdGlvbignZ2VvZGlyX2FkZF9saXN0aW5nX2NvZGVhZGRyZXNzX2JlZm9yZV9nZW9jb2RlJyk7CiAgICAgICAgICAgICAgICAgICAgICAgID8+CiAgICAgICAgICAgICAgICAgICAgICAgIGdlb2NvZGVQb3NpdGlvbihiYXNlTWFya2VyLmdldFBvc2l0aW9uKCksIHsnYWRkcmVzcyc6IGFkZHJlc3MsICdjb3VudHJ5JzogSVNPMn0pOwogICAgICAgICAgICAgICAgICAgICAgICAvL30KICAgICAgICAgICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgICAgICAgICAgICBhbGVydCgnPD9waHAgZWNobyBhZGRzbGFzaGVzX2dwYyhfXygnR2VvY29kZSB3YXMgbm90IHN1Y2Nlc3NmdWwgZm9yIHRoZSBmb2xsb3dpbmcgcmVhc29uOicsJ2dlb2RpcmVjdG9yeScpKTs/PiAnICsgc3RhdHVzKTsKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9KTsKICAgICAgICB9CiAgICB9CgogICAgZnVuY3Rpb24gZ2RfZ2V0X3N0cmVldDIoJHJlc3BvbnNlKXsKICAgICAgICB2YXIgJHN0cmVldDIgPSAnJzsKCiAgICAgICAgaWYoJHJlc3BvbnNlLmFkZHJlc3MuYnVpbGRpbmcpewogICAgICAgICAgICAkc3RyZWV0MiA9ICRyZXNwb25zZS5hZGRyZXNzLmJ1aWxkaW5nOwogICAgICAgIH1lbHNlIGlmKCRyZXNwb25zZS5hZGRyZXNzLmRlcGFydG1lbnRfc3RvcmUpewogICAgICAgICAgICAkc3RyZWV0MiA9ICRyZXNwb25zZS5hZGRyZXNzLmRlcGFydG1lbnRfc3RvcmU7CiAgICAgICAgfWVsc2UgaWYoJHJlc3BvbnNlLmFkZHJlc3MuaG90ZWwpewogICAgICAgICAgICAkc3RyZWV0MiA9ICRyZXNwb25zZS5hZGRyZXNzLmhvdGVsOwogICAgICAgIH0KCiAgICAgICAgcmV0dXJuICRzdHJlZXQyOwogICAgfQogICAgCiAgICBmdW5jdGlvbiBnZW9jb2RlUmVzcG9uc2VPU00ocmVzcG9uc2UsIHVwZGF0ZU1hcCkgewogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlKTsKICAgICAgICBpZiAocmVzcG9uc2UuZGlzcGxheV9hZGRyZXNzKSB7CiAgICAgICAgICAgIHZhciBnZXRBZGRyZXNzID0gcmVzcG9uc2UuZGlzcGxheV9hZGRyZXNzOwogICAgICAgICAgICB2YXIgZ2V0QWRkcmVzczIgPSBnZF9nZXRfc3RyZWV0MihyZXNwb25zZSk7CiAgICAgICAgICAgIHZhciBnZXRaaXAgPSByZXNwb25zZS5wb3N0Y29kZTsKICAgICAgICAgICAgdmFyIGdldENpdHkgPSByZXNwb25zZS5jaXR5OwogICAgICAgICAgICB2YXIgZ2V0U3RhdGUgPSByZXNwb25zZS5zdGF0ZTsKICAgICAgICAgICAgdmFyIGdldENvdW50cnkgPSByZXNwb25zZS5jb3VudHJ5OwogICAgICAgICAgICBnZXRDb3VudHJ5SVNPID0gcmVzcG9uc2UuY291bnRyeV9jb2RlOwogICAgICAgICAgICAKICAgICAgICAgICAgaWYgKHVwZGF0ZU1hcCAmJiByZXNwb25zZS5sYXQgJiYgcmVzcG9uc2UubG9uKSB7CiAgICAgICAgICAgICAgICB2YXIgbmV3TGF0TG5nID0gbmV3IEwubGF0TG5nKHJlc3BvbnNlLmxhdCwgcmVzcG9uc2UubG9uKTsKICAgICAgICAgICAgICAgIGJhc2VNYXJrZXIuc2V0TGF0TG5nKG5ld0xhdExuZyk7CiAgICAgICAgICAgICAgICBjZW50ZXJNYXAobmV3TGF0TG5nKTsKICAgICAgICAgICAgICAgIHVwZGF0ZU1hcmtlclBvc2l0aW9uT1NNKGJhc2VNYXJrZXIuZ2V0TGF0TG5nKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIDw/cGhwIAogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogRmlyZXMgdG8gYWRkIGphdmFzY3JpcHQgdmFyaWFibGUgdG8gdXNlIGluIGdvb2dsZSBtYXAuCiAgICAgICAgICAgICAqCiAgICAgICAgICAgICAqIEBzaW5jZSAxLjAuMAogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZG9fYWN0aW9uKCdnZW9kaXJfYWRkX2xpc3RpbmdfZ2VvY29kZV9qc192YXJzJyk7CiAgICAgICAgICAgID8+CiAgICAgICAgICAgIDw/cGhwIGlmICgkaXNfbWFwX3Jlc3RyaWN0KSB7ID8+CiAgICAgICAgICAgIGlmIChnZXRDaXR5LnRvTG93ZXJDYXNlKCkgIT0gJzw/cGhwIGVjaG8gZ2VvZGlyX3N0cnRvbG93ZXIoYWRkc2xhc2hlc19ncGMoJGNpdHkpKTs/PicpIHsKICAgICAgICAgICAgICAgIGFsZXJ0KCc8P3BocCBlY2hvIGFkZHNsYXNoZXNfZ3BjKHdwX3NwcmludGYoX18oJ1BsZWFzZSBjaG9vc2UgYW55IGFkZHJlc3Mgb2YgdGhlICglcykgY2l0eSBvbmx5LicsJ2dlb2RpcmVjdG9yeScpLCAkY2l0eSkpOz8+Jyk7CiAgICAgICAgICAgICAgICBqUXVlcnkoIiM8P3BocCBlY2hvICRwcmVmaXguJ21hcCc7Pz4iKS5nb01hcCgpOwogICAgICAgICAgICAgICAgY2VudGVyTWFwKG5ldyBMLmxhdExuZygnPD9waHAgZWNobyAkZGVmYXVsdF9sYXQ7ID8+JywgJzw/cGhwIGVjaG8gJGRlZmF1bHRfbG5nOyA/PicpKTsKICAgICAgICAgICAgICAgIGJhc2VNYXJrZXIuc2V0TGF0TG5nKG5ldyBMLmxhdExuZygnPD9waHAgZWNobyAkZGVmYXVsdF9sYXQ7ID8+JywgJzw/cGhwIGVjaG8gJGRlZmF1bHRfbG5nOyA/PicpKTsKICAgICAgICAgICAgICAgIHVwZGF0ZU1hcmtlclBvc2l0aW9uT1NNKGJhc2VNYXJrZXIuZ2V0TGF0TG5nKCkpOwogICAgICAgICAgICAgICAgZ2VvY29kZVBvc2l0aW9uT1NNKGJhc2VNYXJrZXIuZ2V0TGF0TG5nKCkpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIDw/cGhwIH0gPz4KICAgICAgICAgICAgdXBkYXRlTWFya2VyQWRkcmVzcyhnZXRBZGRyZXNzLCBnZXRaaXAsIGdldENpdHksIGdldFN0YXRlLCBnZXRDb3VudHJ5LGdldEFkZHJlc3MyKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgICA8P3BocCAKICAgICAgICAgICAgLyoqCiAgICAgICAgICAgICAqIEZpcmVzIHRvIGFkZCBqYXZhc2NyaXB0IHZhcmlhYmxlIHRvIHVzZSBpbiBnb29nbGUgbWFwLgogICAgICAgICAgICAgKgogICAgICAgICAgICAgKiBAc2luY2UgMS4wLjAKICAgICAgICAgICAgICovCiAgICAgICAgICAgIGRvX2FjdGlvbiggJ2dlb2Rpcl9hZGRfbGlzdGluZ19nZW9jb2RlX3Jlc3BvbnNlX2ZhaWwnICk7CiAgICAgICAgICAgID8+CgkJCWFsZXJ0KCc8P3BocCBlY2hvIGFkZHNsYXNoZXNfZ3BjKF9fKCdDYW5ub3QgZGV0ZXJtaW5lIGFkZHJlc3MgYXQgdGhpcyBsb2NhdGlvbi4nLCdnZW9kaXJlY3RvcnknKSk7Pz4nKTsKICAgICAgICB9CiAgICB9CgogICAgPD9waHAgJGdlb2Rpcl9tYXBfbmFtZSA9IEdlb0Rpcl9NYXBzOjphY3RpdmVfbWFwKCk7CiAgICBpZigkZ2VvZGlyX21hcF9uYW1lIT0nbm9uZScpeyA/PgogICAgalF1ZXJ5KGZ1bmN0aW9uICgkKSB7CgkJPD9waHAgaWYgKCBnZW9kaXJfbGF6eV9sb2FkX21hcCgpICkgeyA/PgoJCWpRdWVyeSgiIzw/cGhwIGVjaG8gJHByZWZpeC4nbWFwJzs/PiIpLmdlb2RpckxvYWRNYXAoewoJCWxvYWRKUzogdHJ1ZSwKCQlmb3JjZUxvYWQ6IDw/cGhwIGVjaG8gKCBpc3NldCggJGdlb2Rpcl9tYW51YWxfbWFwICkgJiYgJGdlb2Rpcl9tYW51YWxfbWFwID8gJ3RydWUnIDogJ2ZhbHNlJyApOyA/PiwKCQljYWxsYmFjazogZnVuY3Rpb24oKSB7PD9waHAgfSA/PgogICAgICAgIHZhciAkYWRkcmVzc01hcCA9ICQoIiM8P3BocCBlY2hvICRwcmVmaXguJ21hcCc7Pz4iKS5nb01hcCh7CiAgICAgICAgICAgIGxhdGl0dWRlOiA8P3BocCBlY2hvICRwcmVmaXg7Pz5DSVRZX01BUF9DRU5URVJfTEFULAogICAgICAgICAgICBsb25naXR1ZGU6IDw/cGhwIGVjaG8gJHByZWZpeDs/PkNJVFlfTUFQX0NFTlRFUl9MTkcsCiAgICAgICAgICAgIHpvb206IDw/cGhwIGVjaG8gJHByZWZpeDs/PkNJVFlfTUFQX1pPT01JTkdfRkFDVCwKICAgICAgICAgICAgbWFwdHlwZTogJ1JPQURNQVAnLCAvLyBNYXAgdHlwZSAtIEhZQlJJRCwgUk9BRE1BUCwgU0FURUxMSVRFLCBURVJSQUlOCiAgICAgICAgICAgIHN0cmVldFZpZXdDb250cm9sOiB0cnVlLAogICAgICAgICAgICA8P3BocCBpZihnZW9kaXJfZ2V0X29wdGlvbignZ2VvZGlyX2FkZF9saXN0aW5nX21vdXNlX3Njcm9sbCcpKSB7IGVjaG8gJ3Njcm9sbHdoZWVsOiBmYWxzZSwnO30/PgoJCQk8P3BocCBkb19hY3Rpb24oICdnZW9kaXJfdGVtcGxhdGVfcmVuZGVyX21hcF9qc19wYXJhbXMnICk7ID8+CiAgICAgICAgfSk7CgogICAgICAgIGlmICh3aW5kb3cuZ2RNYXBzKSB7CiAgICAgICAgICAgIGdlb2NvZGVyID0gd2luZG93LmdkTWFwcyA9PSAnZ29vZ2xlJyA/IG5ldyBnb29nbGUubWFwcy5HZW9jb2RlcigpIDogW107CgogICAgICAgICAgICBiYXNlTWFya2VyID0gJC5nb01hcC5jcmVhdGVNYXJrZXIoewogICAgICAgICAgICAgICAgbGF0aXR1ZGU6IDw/cGhwIGVjaG8gJHByZWZpeDs/PkNJVFlfTUFQX0NFTlRFUl9MQVQsCiAgICAgICAgICAgICAgICBsb25naXR1ZGU6IDw/cGhwIGVjaG8gJHByZWZpeDs/PkNJVFlfTUFQX0NFTlRFUl9MTkcsCiAgICAgICAgICAgICAgICBpZDogJ2Jhc2VNYXJrZXInLAogICAgICAgICAgICAgICAgaWNvbjogJzw/cGhwIGVjaG8gJG1hcmtlcl9pY29uOz8+JywKICAgICAgICAgICAgICAgIGRyYWdnYWJsZTogdHJ1ZSwKICAgICAgICAgICAgICAgIGFkZFRvTWFwOiB0cnVlLCAvLyBGb3IgT1NNCiAgICAgICAgICAgICAgICB3OiBwYXJzZUZsb2F0KCc8P3BocCBlY2hvICRpY29uX3NpemVbJ3cnXTs/PicpLAogICAgICAgICAgICAgICAgaDogcGFyc2VGbG9hdCgnPD9waHAgZWNobyAkaWNvbl9zaXplWydoJ107Pz4nKSwKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGpRdWVyeSgnIzw/cGhwIGVjaG8gJHByZWZpeC4nbWFwX2xvYWRpbmdfZGl2Jzs/PicpLmhpZGUoKTsKCiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgalF1ZXJ5KCcjPD9waHAgZWNobyAkcHJlZml4LidtYXBfbm9mb3VuZCc7Pz4nKS5oaWRlKCk7CiAgICAgICAgICAgIGpRdWVyeSgnIzw/cGhwIGVjaG8gJHByZWZpeC4nbWFwX25vdGxvYWRlZCc7Pz4nKS5zaG93KCk7CiAgICAgICAgfQogICAgICAgIAogICAgICAgICQoIiM8P3BocCBlY2hvICRwcmVmaXg7Pz5zZXRfYWRkcmVzc19idXR0b24iKS5vbigiY2xpY2siLGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgdmFyIHNldF9vbl9tYXAgPSB0cnVlOwogICAgICAgICAgICBnZW9kaXJfY29kZUFkZHJlc3Moc2V0X29uX21hcCk7CiAgICAgICAgfSk7CiAgICAgICAgCiAgICAgICAgaWYgKHdpbmRvdy5nZE1hcHMgPT0gJ2dvb2dsZScpIHsKICAgICAgICAgICAgLy8gQWRkIGRyYWdnaW5nIGV2ZW50IGxpc3RlbmVycy4KICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoYmFzZU1hcmtlciwgJ2RyYWdzdGFydCcsIGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgLy91cGRhdGVNYXJrZXJBZGRyZXNzKCdEcmFnZ2luZy4uLicpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoYmFzZU1hcmtlciwgJ2RyYWcnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAvLyB1cGRhdGVNYXJrZXJTdGF0dXMoJ0RyYWdnaW5nLi4uJyk7CiAgICAgICAgICAgICAgICB1cGRhdGVNYXJrZXJQb3NpdGlvbihiYXNlTWFya2VyLmdldFBvc2l0aW9uKCkpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoYmFzZU1hcmtlciwgJ2RyYWdlbmQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAvLyB1cGRhdGVNYXJrZXJTdGF0dXMoJ0RyYWcgZW5kZWQnKTsKICAgICAgICAgICAgICAgIGNlbnRlck1hcCgpOwogICAgICAgICAgICAgICAgPD9waHAgaWYgKCRhdXRvX2NoYW5nZV9hZGRyZXNzX2ZpZWxkc19waW5fbW92ZSkgeyA/PgogICAgICAgICAgICAgICAgZ2VvY29kZVBvc2l0aW9uKGJhc2VNYXJrZXIuZ2V0UG9zaXRpb24oKSk7CiAgICAgICAgICAgICAgICA8P3BocCB9ID8+CiAgICAgICAgICAgICAgICB1cGRhdGVNYXJrZXJQb3NpdGlvbihiYXNlTWFya2VyLmdldFBvc2l0aW9uKCkpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoJC5nb01hcC5tYXAsICdkcmFnZW5kJywgZnVuY3Rpb24gKCkgewogICAgICAgICAgICAgICAgLy8gdXBkYXRlTWFya2VyU3RhdHVzKCdEcmFnIGVuZGVkJyk7CiAgICAgICAgICAgICAgICBjZW50ZXJNYXJrZXIoKTsKICAgICAgICAgICAgICAgIDw/cGhwIGlmICgkYXV0b19jaGFuZ2VfYWRkcmVzc19maWVsZHNfcGluX21vdmUpIHsgPz4KICAgICAgICAgICAgICAgIGdlb2NvZGVQb3NpdGlvbihiYXNlTWFya2VyLmdldFBvc2l0aW9uKCkpOwogICAgICAgICAgICAgICAgPD9waHAgfSA/PgoKICAgICAgICAgICAgICAgIHVwZGF0ZU1hcmtlclBvc2l0aW9uKGJhc2VNYXJrZXIuZ2V0UG9zaXRpb24oKSk7CiAgICAgICAgICAgIH0pOwogICAgICAgICAgICBnb29nbGUubWFwcy5ldmVudC5hZGRMaXN0ZW5lcigkLmdvTWFwLm1hcCwgJ3pvb21fY2hhbmdlZCcsIGZ1bmN0aW9uICgpIHsKCQkJCWlmICh0eXBlb2YgJC5nb01hcC5tYXAgPT09ICd1bmRlZmluZWQnKSB7CgkJCQkJJC5nb01hcC5tYXAgPSAkYWRkcmVzc01hcDsKCQkJCX0KICAgICAgICAgICAgICAgIHVwZGF0ZU1hcFpvb20oJC5nb01hcC5tYXAuem9vbSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy92YXIgbWF4TWFwID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJzw/cGhwIGVjaG8gJHByZWZpeDs/PnRyaWdnZXJtYXAnKTsKICAgICAgICAgICAgLy9nb29nbGUubWFwcy5ldmVudC5hZGREb21MaXN0ZW5lcihtYXhNYXAsICdjbGljaycsIGdkTWF4TWFwKTsKCiAgICAgICAgICAgIDw/cGhwIGlmICgkaXNfbWFwX3Jlc3RyaWN0KSB7ID8+CiAgICAgICAgICAgIHZhciBDSVRZX0FERFJFU1MgPSAnPD9waHAgZWNobyBhZGRzbGFzaGVzX2dwYygkY2l0eSkuJywnLmFkZHNsYXNoZXNfZ3BjKCRyZWdpb24pLicsJy5hZGRzbGFzaGVzX2dwYygkY291bnRyeSk7Pz4nOwogICAgICAgICAgICBnZW9jb2Rlci5nZW9jb2RlKHsnYWRkcmVzcyc6IENJVFlfQUREUkVTU30sCiAgICAgICAgICAgICAgICBmdW5jdGlvbiAocmVzdWx0cywgc3RhdHVzKSB7CiAgICAgICAgICAgICAgICAgICAgJCgiIzw/cGhwIGVjaG8gJHByZWZpeC4nbWFwJzs/PiIpLmdvTWFwKCk7CiAgICAgICAgICAgICAgICAgICAgaWYgKHN0YXR1cyA9PSBnb29nbGUubWFwcy5HZW9jb2RlclN0YXR1cy5PSykgewogICAgICAgICAgICAgICAgICAgICAgICAvLyBCb3VuZHMgZm9yIE5vcnRoIEFtZXJpY2EKICAgICAgICAgICAgICAgICAgICAgICAgdmFyIGJvdW5kX2xhdF9sbmcgPSBTdHJpbmcocmVzdWx0c1swXS5nZW9tZXRyeS5ib3VuZHMpOwogICAgICAgICAgICAgICAgICAgICAgICBib3VuZF9sYXRfbG5nID0gYm91bmRfbGF0X2xuZy5yZXBsYWNlKC9bKCldL2csICIiKTsKICAgICAgICAgICAgICAgICAgICAgICAgYm91bmRfbGF0X2xuZyA9IGJvdW5kX2xhdF9sbmcuc3BsaXQoJywnKTsKICAgICAgICAgICAgICAgICAgICAgICAgc3RyaWN0Qm91bmRzID0gbmV3IGdvb2dsZS5tYXBzLkxhdExuZ0JvdW5kcygKICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ldyBnb29nbGUubWFwcy5MYXRMbmcoYm91bmRfbGF0X2xuZ1swXSwgYm91bmRfbGF0X2xuZ1sxXSksCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXcgZ29vZ2xlLm1hcHMuTGF0TG5nKGJvdW5kX2xhdF9sbmdbMl0sIGJvdW5kX2xhdF9sbmdbM10pCiAgICAgICAgICAgICAgICAgICAgICAgICk7CiAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICAgICAgICAgICAgYWxlcnQoIjw/cGhwIF9lKCdHZW9jb2RlIHdhcyBub3Qgc3VjY2Vzc2Z1bCBmb3IgdGhlIGZvbGxvd2luZyByZWFzb246JywnZ2VvZGlyZWN0b3J5Jyk7Pz4gIiArIHN0YXR1cyk7CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIDw/cGhwIH0gPz4KICAgICAgICAgICAgLy8gTGltaXQgdGhlIHpvb20gbGV2ZWwKICAgICAgICAgICAgZ29vZ2xlLm1hcHMuZXZlbnQuYWRkTGlzdGVuZXIoJC5nb01hcC5tYXAsICd6b29tX2NoYW5nZWQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgICAgICAkKCIjPD9waHAgZWNobyAkcHJlZml4LidtYXAnOz8+IikuZ29NYXAoKTsKICAgICAgICAgICAgICAgIGlmICgkLmdvTWFwLm1hcC5nZXRab29tKCkgPCBtaW5ab29tTGV2ZWwpICQuZ29NYXAubWFwLnNldFpvb20obWluWm9vbUxldmVsKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgfSBlbHNlIGlmICh3aW5kb3cuZ2RNYXBzID09ICdvc20nKSB7CiAgICAgICAgICAgIC8vIEFkZCBkcmFnZ2luZyBldmVudCBsaXN0ZW5lcnMuCiAgICAgICAgICAgIGJhc2VNYXJrZXIub24oJ2RyYWcnLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICB1cGRhdGVNYXJrZXJQb3NpdGlvbk9TTShiYXNlTWFya2VyLmdldExhdExuZygpKTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIGJhc2VNYXJrZXIub24oJ2RyYWdlbmQnLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICBjZW50ZXJNYXAoKTsKICAgICAgICAgICAgICAgIDw/cGhwIGlmICgkYXV0b19jaGFuZ2VfYWRkcmVzc19maWVsZHNfcGluX21vdmUpIHsgPz4KICAgICAgICAgICAgICAgIGdlb2NvZGVQb3NpdGlvbk9TTShiYXNlTWFya2VyLmdldExhdExuZygpKTsKICAgICAgICAgICAgICAgIDw/cGhwIH0gPz4KICAgICAgICAgICAgICAgIHVwZGF0ZU1hcmtlclBvc2l0aW9uT1NNKGJhc2VNYXJrZXIuZ2V0TGF0TG5nKCkpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgJC5nb01hcC5tYXAub24oJ2RyYWdlbmQnLCBmdW5jdGlvbihlKSB7CiAgICAgICAgICAgICAgICA8P3BocCBpZiAoJGF1dG9fY2hhbmdlX2FkZHJlc3NfZmllbGRzX3Bpbl9tb3ZlKSB7ID8+CiAgICAgICAgICAgICAgICBnZW9jb2RlUG9zaXRpb25PU00oYmFzZU1hcmtlci5nZXRMYXRMbmcoKSk7CiAgICAgICAgICAgICAgICA8P3BocCB9ID8+CiAgICAgICAgICAgICAgICBjZW50ZXJNYXJrZXIoKTsKICAgICAgICAgICAgICAgIHVwZGF0ZU1hcmtlclBvc2l0aW9uT1NNKGJhc2VNYXJrZXIuZ2V0TGF0TG5nKCkpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgJC5nb01hcC5tYXAub24oJ3pvb20nLCBmdW5jdGlvbihlKSB7CgkJCQlpZiAodHlwZW9mICQuZ29NYXAubWFwID09PSAndW5kZWZpbmVkJykgewoJCQkJCSQuZ29NYXAubWFwID0gJGFkZHJlc3NNYXA7CgkJCQl9CiAgICAgICAgICAgICAgICB1cGRhdGVNYXBab29tKCQuZ29NYXAubWFwLmdldFpvb20oKSk7CiAgICAgICAgICAgIH0pOwoKICAgICAgICAgICAgLy9MLkRvbUV2ZW50LmFkZExpc3RlbmVyKCQoJzw/cGhwIGVjaG8gJHByZWZpeDs/PnRyaWdnZXJtYXAnKSwgJ2NsaWNrJywgZ2RNYXhNYXApOwoKICAgICAgICAgICAgPD9waHAgaWYgKCRpc19tYXBfcmVzdHJpY3QpIHsgPz4KICAgICAgICAgICAgdmFyIENJVFlfQUREUkVTUyA9ICc8P3BocCBlY2hvIGFkZHNsYXNoZXNfZ3BjKCRjaXR5KS4nLCAnLmFkZHNsYXNoZXNfZ3BjKCRyZWdpb24pLicsICcuYWRkc2xhc2hlc19ncGMoJGNvdW50cnkpOz8+JzsKICAgICAgICAgICAgPD9waHAgfSA/PgogICAgICAgICAgICAvLyBMaW1pdCB0aGUgem9vbSBsZXZlbAogICAgICAgICAgICAkLmdvTWFwLm1hcC5vbignem9vbScsIGZ1bmN0aW9uKGUpIHsKICAgICAgICAgICAgICAgIGlmICgkLmdvTWFwLm1hcC5nZXRab29tKCkgPCBtaW5ab29tTGV2ZWwpIHsKICAgICAgICAgICAgICAgICAgICAkLmdvTWFwLm1hcC5zZXRab29tKG1pblpvb21MZXZlbCk7CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pOwogICAgICAgIH0KCQk8P3BocCBpZiAoIGdlb2Rpcl9sYXp5X2xvYWRfbWFwKCkgKSB7ID8+CgkJfQoJfSk7PD9waHAgfSA/PgogICAgfSk7CiAgICA8P3BocCB9Pz4KICAgIC8qIF1dPiAqLwo8L3NjcmlwdD4KCjw/cGhwIGlmKCF3cF9kb2luZ19hamF4KCkpez8+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAgPD9waHAgaWYoJGdlb2Rpcl9sYWJlbF90eXBlPT0naG9yaXpvbnRhbCcpeyBlY2hvICJyb3ciO30/PiI+CiAgICA8P3BocCBpZigkZ2VvZGlyX2xhYmVsX3R5cGU9PSdob3Jpem9udGFsJyAgKXsgPz4KICAgIDxkaXYgY2xhc3M9ImNvbC1zbS0yIGNvbC1mb3JtLWxhYmVsIj48L2Rpdj4KICAgIDxkaXYgY2xhc3M9ImNvbC1zbS0xMCI+CiAgICAgICAgPD9waHAgfSA/PgogICAgICAgIDxpbnB1dCB0eXBlPSJidXR0b24iIGlkPSI8P3BocCBlY2hvICRwcmVmaXg7ID8+c2V0X2FkZHJlc3NfYnV0dG9uIiBjbGFzcz0iIGJ0biBidG4tcHJpbWFyeSB0ZXh0LWNlbnRlciBteC1hdXRvIiB2YWx1ZT0iPD9waHAgZXNjX2F0dHJfZSgkbWFwX3RpdGxlLCAnZ2VvZGlyZWN0b3J5Jyk7ID8+IiAvPgogICAgICAgIDw/cGhwCiAgICAgICAgYXVpKCk7CiAgICAgICAgZWNobyBBVUlfQ29tcG9uZW50X0hlbHBlcjo6aGVscF90ZXh0KHN0cmlwc2xhc2hlcyggX18oICdDbGljayBvbiAiU2V0IEFkZHJlc3Mgb24gTWFwIiBhbmQgdGhlbiB5b3UgY2FuIGFsc28gZHJhZyBtYXAgbWFya2VyIHRvIGxvY2F0ZSB0aGUgY29ycmVjdCBhZGRyZXNzJywgJ2dlb2RpcmVjdG9yeScgKSApKTsKICAgICAgICA/PgogICAgICAgIDw/cGhwIGlmKCRnZW9kaXJfbGFiZWxfdHlwZT09J2hvcml6b250YWwnKXsgPz4KICAgIDwvZGl2Pgo8P3BocCB9ID8+CjwvZGl2Pgo8P3BocCB9ID8+CjxkaXYgY2xhc3M9ImZvcm0tZ3JvdXAgcm93eCI+CgogICAgPD9waHAKICAgIC8qKgogICAgICogVmFyaWFibGVzLgogICAgICoKICAgICAqIEB2YXIgYXJyYXkgJG1hcF9vcHRpb25zIFRoZSBtYXAgc2V0dGluZ3Mgb3B0aW9ucy4KICAgICAqIEB2YXIgc3RyaW5nICRtYXBfdHlwZSBUaGUgbWFwIHR5cGUuCiAgICAgKiBAdmFyIHN0cmluZyAkbWFwX2NhbnZhcyBUaGUgbWFwIGNhbnZhcyBzdHJpbmcuCiAgICAgKiBAdmFyIHN0cmluZyAkaGVpZ2h0IFRoZSBtYXAgaGVpZ2h0IHNldHRpbmcuCiAgICAgKiBAdmFyIHN0cmluZyAkd2lkdGggVGhlIG1hcCB3aWR0aCBzZXR0aW5nLgogICAgICovCiAgICAkbWFwX3R5cGUgPSAnYWRkX2xpc3RpbmcnOwogICAgJG1hcF9jYW52YXMgPSAkcHJlZml4IC4nbWFwJyA7CiAgICAkaGVpZ2h0ID0gJzM1MHB4JzsKICAgICR3aWR0aCA9ICcxMDAlJzsKICAgICR3cmFwX2NsYXNzID0gJyc7CiAgICAkaGlkZV9leHBhbmRfbWFwID0gdHJ1ZTsKICAgICRtYXBfb3B0aW9ucyA9IGFycmF5KAogICAgICAgICdtYXBfY2FudmFzJyA9PiAkbWFwX2NhbnZhcywKICAgICAgICAnbWFwX3R5cGUnID0+ICRtYXBfdHlwZSwKICAgICAgICAnaGVpZ2h0JyA9PiAkaGVpZ2h0LAogICAgICAgICd3aWR0aCcgPT4gJHdpZHRoCiAgICApOwogICAgaW5jbHVkZSggR0VPRElSRUNUT1JZX1BMVUdJTl9ESVIgLiAndGVtcGxhdGVzL2Jvb3RzdHJhcC9tYXAvbWFwLnBocCcgKTsKICAgID8+CjwvZGl2PiI7czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBuYW1lc3BhY2VzIjthOjA6e31zOjQzOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGluY2x1ZGVzIjthOjA6e31zOjQ0OiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAGZ1bmN0aW9ucyI7YTowOnt9czo0NDoiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBjb25zdGFudHMiO2E6MDp7fXM6NDI6IgBwaHBEb2N1bWVudG9yXFJlZmxlY3Rpb25cUGhwXEZpbGUAY2xhc3NlcyI7YTowOnt9czo0NToiAHBocERvY3VtZW50b3JcUmVmbGVjdGlvblxQaHBcRmlsZQBpbnRlcmZhY2VzIjthOjA6e31zOjQxOiIAcGhwRG9jdW1lbnRvclxSZWZsZWN0aW9uXFBocFxGaWxlAHRyYWl0cyI7YTowOnt9fQ==";