<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Geodirectory Code Reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/favicon.png" />
    <link rel="apple-touch-icon" href="../images/apple-touch-icon.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-touch-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-touch-icon-114x114.png"/>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/base.css?updated=1652336158">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/template.css?updated=1652336158">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
            <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/js/all.min.js" integrity="sha256-0vuk8LXoyrmCjp1f0O300qo1M75ZQyhH9X3J6d+scmk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8KCYZ2CYMS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8KCYZ2CYMS', {
		'content_group' : 'WooCommerce Core Code Reference',
	});
</script>
        <script src="../js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-top-header">
    <section class="phpdocumentor-section">
        <div class="site-branding">
            <a class="site-logo" href="../index.html"><img width="180" src="../images/logo.png" alt="WPGeodirectory" /></a>
        </div>
        <nav class="main-navigation">
            <ul>
                <li><a href="../hooks/hooks.html">Hooks Reference</a></li>
                <li><a href="https://docs.woocommerce.com/">Documentation</a></li>
                <li><a href="https://woocommerce.github.io/woocommerce-rest-api-docs/">REST API Docs</a></li>
                <li><a href="https://woocommerce.com/careers/?utm_source=woocommerce+core+code+reference&utm_medium=devdocs&utm_campaign=woo+careers" target="_blank">We're hiring!</a></li>
            </ul>
        </nav>
    </section>
</header>

<div class="phpdocumentor-header">
    <section class="phpdocumentor-section">
        <h1 class="phpdocumentor-title">Geodirectory Code Reference</h1>
        <section class="phpdocumentor-search">
    <label class="phpdocumentor-label">
        <span class="visually-hidden">Search (click ESC to close search results)</span>
        <input id="autoComplete" tabindex="1" type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading..." disabled />
    </label>
</section>

    </section>
</div>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <aside class="phpdocumentor-column -four phpdocumentor-sidebar">
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/elementorpro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/elementorpro-modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/Geodirectory.html"><abbr title="\Geodirectory">Geodirectory</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectory.html"><abbr title="\GeoDirectory">GeoDirectory</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/GeoDirectory-Templates.html"><abbr title="\GeoDirectory\Templates">Templates</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAbstracts.html"><abbr title="\GeoDirectoryAbstracts">GeoDirectoryAbstracts</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAPI.html"><abbr title="\GeoDirectoryAPI">GeoDirectoryAPI</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClasses.html"><abbr title="\GeoDirectoryClasses">GeoDirectoryClasses</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminFunctions.html"><abbr title="\GeoDirectoryAdminFunctions">GeoDirectoryAdminFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoruAdmin.html"><abbr title="\GeoDirectoruAdmin">GeoDirectoruAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdmin.html"><abbr title="\GeoDirectoryAdmin">GeoDirectoryAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirAdmin.html"><abbr title="\GeoDirAdmin">GeoDirAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectroyAdmin.html"><abbr title="\GeoDirectroyAdmin">GeoDirectroyAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminSystemStatus.html"><abbr title="\GeoDirectoryAdminSystemStatus">GeoDirectoryAdminSystemStatus</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminTools.html"><abbr title="\GeoDirectoryAdminTools">GeoDirectoryAdminTools</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminWidgets.html"><abbr title="\GeoDirectoryAdminWidgets">GeoDirectoryAdminWidgets</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesEmails.html"><abbr title="\GeoDirectoryClassesEmails">GeoDirectoryClassesEmails</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesData.html"><abbr title="\GeoDirectoryClassesData">GeoDirectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDIrectoryClassesData.html"><abbr title="\GeoDIrectoryClassesData">GeoDIrectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/ElementorPro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/ElementorPro-Modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryFunctions.html"><abbr title="\GeoDirectoryFunctions">GeoDirectoryFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryparamarraytermsAnarrayoftermobjects.html"><abbr title="\GeoDirectoryparamarraytermsAnarrayoftermobjects">GeoDirectoryparamarraytermsAnarrayoftermobjects</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WP.html"><abbr title="\WP">WP</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/WP-Background.html"><abbr title="\WP\Background">Background</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryTemplates.html"><abbr title="\GeoDirectoryTemplates">GeoDirectoryTemplates</abbr></a></h3>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../hooks/hooks.html">Hooks Reference</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">class-geodir-elementor-skin-custom.php</h2>

                

        
                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php
namespace ElementorPro\Modules\Posts\Skins;

use Elementor\Controls_Manager;
use Elementor\Group_Control_Box_Shadow;
use Elementor\Group_Control_Image_Size;
use Elementor\Group_Control_Typography;
use Elementor\Scheme_Color;
use Elementor\Scheme_Typography;
use Elementor\Widget_Base;
use ElementorPro\Plugin;

if ( ! defined( &#039;ABSPATH&#039; ) ) exit; // Exit if accessed directly

/**
 * Props to this plugin  https://wordpress.org/plugins/ele-custom-skin/
 *
 * Class GeoDir_Elementor_Skin_Posts
 * @package ElementorPro\Modules\Posts\Skins
 */
class GeoDir_Elementor_Skin_Posts extends Skin_Base {
	private $template_cache = [];
	private $pid;
	public $settings;

	public function get_id() {
		return &#039;gd_custom&#039;;
	}

	public function get_title() {
		return __( &#039;GD Archive Item&#039;, &#039;geodirectory&#039; );
	}

	protected function _register_controls_actions() {
		parent::_register_controls_actions();

		add_action( &#039;elementor/element/posts/&#039; . $this-&gt;get_id() . &#039;_section_design_layout/after_section_end&#039;, [ $this, &#039;register_navigation_design_controls&#039; ] );
		add_action( &#039;elementor/element/posts/section_pagination/after_section_end&#039;, [ $this, &#039;register_navigation_controls&#039; ] );
	}

	public function register_navigation_controls() {
		do_action( &#039;geodir_ecs_after_pagination_controls&#039;, $this );
	}

	public function register_navigation_design_controls() {
		do_action( &#039;geodir_ecs_after_style_controls&#039;, $this );
	}

	public function register_controls( Widget_Base $widget ) {
		$this-&gt;parent = $widget;

		$this-&gt;add_control(
			&#039;skin_template&#039;,
			[
				&#039;label&#039; =&gt; __( &#039;Select a default template&#039;, &#039;geodirectory&#039; ),
				&#039;description&#039; =&gt; &#039;&lt;div style=&quot;text-align:center;&quot;&gt;&lt;a target=&quot;_blank&quot; style=&quot;text-align: center;font-style: normal;&quot; href=&quot;&#039; . esc_url( admin_url( &#039;/edit.php?post_type=elementor_library&amp;tabs_group&amp;elementor_library_type=geodirectory-archive-item&#039; ) ) . &#039;&quot; class=&quot;elementor-button elementor-button-default elementor-repeater-add&quot;&gt;&#039; . __( &#039;Create/edit a Loop Template&#039;, &#039;geodirectory&#039; ) . &#039;&lt;/a&gt;&lt;/div&gt;&#039;,
				&#039;type&#039; =&gt; Controls_Manager::SELECT2,
				&#039;label_block&#039; =&gt; true,
				&#039;default&#039; =&gt; [],
				&#039;options&#039; =&gt; $this-&gt;get_skin_template(),
			]
		);

		$this-&gt;add_control(//this would make use of 100% if width
			&#039;view&#039;,
			[
				&#039;label&#039; =&gt; __( &#039;View&#039;, &#039;geodirectory&#039; ),
				&#039;type&#039; =&gt; \Elementor\Controls_Manager::HIDDEN,
				&#039;default&#039; =&gt; &#039;top&#039;,
				&#039;prefix_class&#039; =&gt; &#039;elementor-posts--thumbnail-&#039;,
			]
		);

		do_action( &#039;geodir_ecs_after_control&#039;, $this );

		$this-&gt;add_control(
			&#039;hr2&#039;,
			[
				&#039;type&#039; =&gt; \Elementor\Controls_Manager::DIVIDER,
			]
		);

	parent::register_controls( $widget );
		$this-&gt;remove_control( &#039;img_border_radius&#039; );
		$this-&gt;remove_control( &#039;meta_data&#039; );
		$this-&gt;remove_control( &#039;item_ratio&#039; );
		$this-&gt;remove_control( &#039;image_width&#039; );
		$this-&gt;remove_control( &#039;show_title&#039; );
		$this-&gt;remove_control( &#039;title_tag&#039; );
		$this-&gt;remove_control( &#039;masonry&#039; );
		$this-&gt;remove_control( &#039;thumbnail&#039; );
		$this-&gt;remove_control( &#039;thumbnail_size&#039; );
		$this-&gt;remove_control( &#039;show_read_more&#039; );
		$this-&gt;remove_control( &#039;read_more_text&#039; );
		$this-&gt;remove_control( &#039;show_excerpt&#039; );
		$this-&gt;remove_control( &#039;excerpt_length&#039; );
	}

	private function get_post_id(){
		return $this-&gt;pid;
	}

	function get_skin_template(){
		global $wpdb;

		$cache = wp_cache_get( &quot;geodir_elementor_pro_skins&quot; );
		if ( $cache !== false ) {
			return $cache;
		}
		
		$templates = $wpdb-&gt;get_results(
			&quot;SELECT $wpdb-&gt;term_relationships.object_id as ID, $wpdb-&gt;posts.post_title as post_title FROM $wpdb-&gt;term_relationships
				INNER JOIN $wpdb-&gt;term_taxonomy ON
					$wpdb-&gt;term_relationships.term_taxonomy_id=$wpdb-&gt;term_taxonomy.term_taxonomy_id
				INNER JOIN $wpdb-&gt;terms ON 
					$wpdb-&gt;term_taxonomy.term_id=$wpdb-&gt;terms.term_id AND $wpdb-&gt;terms.slug=&#039;geodirectory-archive-item&#039;
				INNER JOIN $wpdb-&gt;posts ON
					$wpdb-&gt;term_relationships.object_id=$wpdb-&gt;posts.ID
			WHERE  $wpdb-&gt;posts.post_status=&#039;publish&#039;&quot;
		);

		$options = [ 0 =&gt; __( &#039;Select a template&#039;, &#039;geodirectory&#039; ) ];
		foreach ( $templates as $template ) {
			$options[ $template-&gt;ID ] = $template-&gt;post_title;
		}

		wp_cache_set( &quot;geodir_elementor_pro_skins&quot;, $options );

		return $options;
	}

	public function render_amp() {

	}

	/**
	 * This is for terms we don&#039;t need passid so we can actually add them in cache.
	 */
	protected function set_used_template( $skin ) {
		if ( ! $skin ) {
			return;
		}

		$this-&gt;used_templates[ $skin ] = $skin;
	}

	protected function get_template() {
		global $gdecs_render_loop, $wp_query, $gd_loop_wp_query, $gdecs_index, $geodir_el_archive_item_tl;

		$gdecs_index++;
		$old_query = $wp_query;
		$gd_loop_wp_query = $wp_query;
		$new_query = new \WP_Query( array( &#039;p&#039; =&gt; get_the_ID(), &#039;post_type&#039; =&gt; get_post_type() ) );
		$wp_query = $new_query;
		$settings = $this-&gt;parent-&gt;get_settings();
		$this-&gt;pid = get_the_ID(); // set the current id in private var useful to passid
		$default_template = $this-&gt;get_instance_value( &#039;skin_template&#039; ) ;
		$template = $default_template;

		$template = apply_filters( &#039;geodir_ecs_action_template&#039;, $template, $this, $gdecs_index );
		$template = $this-&gt;get_current_ID( $template );

		$gdecs_render_loop = get_the_ID() . &quot;,&quot; . $template;

		$return = &#039;&#039;;
		if ( $template ) {
			$this-&gt;set_used_template( $template );

			$geodir_el_archive_item_tl = $template;

			$return = \Elementor\Plugin::instance()-&gt;frontend-&gt;get_builder_content_for_display( $template );

			if ( $return &amp;&amp; version_compare( ELEMENTOR_VERSION, &#039;3.0.0&#039;, &#039;&lt;&#039; ) ) {
				$css_file = \Elementor\Core\DynamicTags\Dynamic_CSS::create( $this-&gt;pid, $template );
				$css_file-&gt;enqueue();

				if ( $css = $css_file-&gt;get_content() ) {
					$css = str_replace( &#039;.elementor-&#039; . $this-&gt;pid . &#039; &#039;, &#039;.elementor-&#039; . $template . &#039;.post-&#039; . $this-&gt;pid . &#039; &#039;, $css );
					$css = &#039;&lt;style id=&quot;elementor-post-dynamic-&#039; . $this-&gt;pid . &#039;&quot;&gt;&#039; . $css . &#039;&lt;/style&gt;&#039;;
					$return = $css . $return;
				}
			}
		}

		$gdecs_render_loop = false;
		$wp_query = $old_query;

		return $return;
	}

	/**
	 * This is for multilang porpouses. Ex: WPML.
	 */
	private function get_current_ID( $id ) {
		$newid = apply_filters( &#039;wpml_object_id&#039;, $id, &#039;elementor_library&#039;, TRUE  );

		return $newid ? $newid : $id;
	}

	protected function render_post_header() {
		$classes = &#039;elementor-post elementor-grid-item&#039;;
		$parent_settings = $this-&gt;parent-&gt;get_settings();
		$parent_settings[ $this-&gt;get_id().&#039;_post_slider&#039; ] = isset( $parent_settings[ $this-&gt;get_id() . &#039;_post_slider&#039; ] )? $parent_settings[ $this-&gt;get_id() . &#039;_post_slider&#039; ] : &quot;&quot;;

		if ( $parent_settings[ $this-&gt;get_id() . &#039;_post_slider&#039; ] == &quot;yes&quot;) {
			$classes .= &#039; swiper-slide&#039;;
		}
		?&gt;
		&lt;article id=&quot;post-&lt;?php the_ID(); ?&gt;&quot; &lt;?php post_class( [ $classes ] ); ?&gt;&gt;
		&lt;?php
	}

	protected function render_post_footer() {
	  ?&gt;&lt;/article&gt;&lt;?php
	}

	protected function render_post() {
		global $geodir_el_archive_item_tl;

		do_action( &#039;geodir_ecs_before_render_post_header&#039;, $this );
			$this-&gt;render_post_header();
		do_action( &#039;geodir_ecs_after_render_post_header&#039;, $this );

		ob_start();
		if ( $this-&gt;get_instance_value( &#039;skin_template&#039; ) ) {
			if ( $this-&gt;get_instance_value( &#039;use_keywords&#039; ) == &quot;yes&quot; ) {
				global $post;
				$template = $this-&gt;get_template();
				$new_template = apply_filters( &#039;geodir_ecs_dynamic_filter&#039;, $template, $post, &quot;&quot;, $this-&gt;parent-&gt;get_settings() );
				echo $new_template ? $new_template : $template;
			} else {
				echo $this-&gt;get_template();
			}
		} else  {
			echo &#039;&lt;div style=&quot;display:table;border:1px solid #c6ced5; background:#dde1e5; width:100%; height:100%; min-height:200px;text-align:center; padding:20px;&quot;&gt;&lt;span style=&quot;vertical-align:middle;display: table-cell;color:#8995a0;&quot;&gt;&#039; . __( &quot;Please select a default template! &quot;, &#039;geodirectory&#039; ) . &#039;&lt;/span&gt;&lt;/div&gt;&#039;;
		}
		$item_content = ob_get_clean();

		// Remove css with template id.
		if ( $item_content &amp;&amp; $geodir_el_archive_item_tl &amp;&amp; version_compare( ELEMENTOR_VERSION, &#039;3.0.0&#039;, &#039;&lt;&#039; ) &amp;&amp; get_post_type( $geodir_el_archive_item_tl ) == &#039;elementor_library&#039; ) {
			$item_content = preg_replace( &#039;#&lt;style id=&quot;elementor-post-dynamic-&#039; . $geodir_el_archive_item_tl . &#039;&quot;&gt;(.*?)&lt;/style&gt;#&#039;, &#039;&#039;, $item_content );
		}

		echo $item_content;

		do_action( &#039;geodir_ecs_before_render_post_footer&#039;, $this );
			$this-&gt;render_post_footer();
		do_action( &#039;geodir_ecs_after_render_post_footer&#039;, $this );

		unset( $geodir_el_archive_item_tl );
	}

	protected function render_loop_header() {
		$parent_settings = $this-&gt;parent-&gt;get_settings();
		$parent_settings[ $this-&gt;get_id().&#039;_post_slider&#039; ] = isset( $parent_settings[ $this-&gt;get_id() . &#039;_post_slider&#039;] )? $parent_settings[ $this-&gt;get_id() . &#039;_post_slider&#039; ] : &quot;&quot;;

		$this-&gt;parent-&gt;add_render_attribute( &#039;container&#039;, [
			&#039;class&#039; =&gt; [
				&#039;elementor-posts-container&#039;,
				&#039;elementor-posts&#039;,
				$parent_settings[ $this-&gt;get_id().&#039;_post_slider&#039; ] == &quot;yes&quot; ? &#039;swiper-wrapper&#039; : &#039;elementor-grid&#039;,
				$this-&gt;get_container_class(),
			],
		] );

		if ( $parent_settings[ $this-&gt;get_id() . &#039;_post_slider&#039; ] == &quot;yes&quot; ) {
			echo &#039;&lt;div class=&quot;swiper-container&quot;&gt;&#039;;
		}
		?&gt;
		&lt;div &lt;?php echo $this-&gt;parent-&gt;get_render_attribute_string( &#039;container&#039; ); ?&gt;&gt;
		&lt;?php
	}

	protected function render_loop_footer() {
		?&gt;
		&lt;/div&gt;
		&lt;?php

		$parent_settings = $this-&gt;parent-&gt;get_settings();
		$parent_settings[ $this-&gt;get_id() . &#039;_post_slider&#039; ] = isset( $parent_settings[ $this-&gt;get_id() . &#039;_post_slider&#039; ] )? $parent_settings[ $this-&gt;get_id() . &#039;_post_slider&#039; ] : &quot;&quot;;
		if ( $parent_settings[ $this-&gt;get_id() . &#039;_post_slider&#039; ] == &quot;yes&quot; ) {
			$this-&gt;slider_elements();
			echo &#039;&lt;/div&gt;&#039;;
		}

		if ( &#039;&#039; === $parent_settings[&#039;pagination_type&#039;] ) {
			return;
		}

		$page_limit = $this-&gt;parent-&gt;get_query()-&gt;max_num_pages;
		if ( &#039;&#039; !== $parent_settings[&#039;pagination_page_limit&#039;] ) {
			$page_limit = min( $parent_settings[&#039;pagination_page_limit&#039;], $page_limit );
		}

		if ( 2 &gt; $page_limit ) {
			return;
		}

		$this-&gt;parent-&gt;add_render_attribute( &#039;pagination&#039;, &#039;class&#039;, &#039;elementor-pagination&#039; );

		$has_numbers = in_array( $parent_settings[&#039;pagination_type&#039;], [ &#039;numbers&#039;, &#039;numbers_and_prev_next&#039; ] );
		$has_prev_next = in_array( $parent_settings[&#039;pagination_type&#039;], [ &#039;prev_next&#039;, &#039;numbers_and_prev_next&#039; ] );

		$links = [];

		if ( $has_numbers ) {
			$paginate_args = [
				&#039;type&#039; =&gt; &#039;array&#039;,
				&#039;current&#039; =&gt; $this-&gt;parent-&gt;get_current_page(),
				&#039;total&#039; =&gt; $page_limit,
				&#039;prev_next&#039; =&gt; false,
				&#039;show_all&#039; =&gt; &#039;yes&#039; !== $parent_settings[&#039;pagination_numbers_shorten&#039;],
				&#039;before_page_number&#039; =&gt; &#039;&lt;span class=&quot;elementor-screen-only&quot;&gt;&#039; . __( &#039;Page&#039;, &#039;elementor-pro&#039; ) . &#039;&lt;/span&gt;&#039;,
			];

			if ( is_singular() &amp;&amp; ! is_front_page() ) {
				global $wp_rewrite;

				if ( $wp_rewrite-&gt;using_permalinks() ) {
					$paginate_args[&#039;base&#039;] = trailingslashit( get_permalink() ) . &#039;%_%&#039;;
					$paginate_args[&#039;format&#039;] = user_trailingslashit( &#039;%#%&#039;, &#039;single_paged&#039; );
				} else {
					$paginate_args[&#039;format&#039;] = &#039;?page=%#%&#039;;
				}
			}

			$links = paginate_links( $paginate_args );
		}

		if ( $has_prev_next ) {
			$prev_next = $this-&gt;parent-&gt;get_posts_nav_link( $page_limit );
			array_unshift( $links, $prev_next[&#039;prev&#039;] );
			$links[] = $prev_next[&#039;next&#039;];
		}

		?&gt;
		&lt;nav class=&quot;elementor-pagination&quot; role=&quot;navigation&quot; aria-label=&quot;&lt;?php esc_attr_e( &#039;Pagination&#039;, &#039;elementor-pro&#039; ); ?&gt;&quot;&gt;
			&lt;?php echo implode( PHP_EOL, $links ); ?&gt;
		&lt;/nav&gt;
		&lt;?php
	}

	private function slider_elements(){
		$this-&gt;settings = $this-&gt;parent-&gt;get_settings();

		do_action( &#039;geodir_ecs_after_slider_elements&#039;, $this );
	}

	private function nothing_found(){
		$this-&gt;render_loop_header();

		$should_escape = apply_filters( &#039;elementor_pro/theme_builder/archive/escape_nothing_found_message&#039;, true );
		$message = $this-&gt;parent-&gt;get_settings_for_display( &#039;nothing_found_message&#039; );
		if ( $should_escape ) {
			$message = esc_html( $message );
		}

		$message = &#039;&lt;div class=&quot;elementor-posts-nothing-found&quot;&gt;&#039; . $message . &#039;&lt;/div&gt;&#039;;
		do_action( &#039;geodir_ecs_not_found&#039;, $this );
		echo  $message;

		$this-&gt;render_loop_footer();
	}

	public function render() {
		$this-&gt;parent-&gt;query_posts();

		/** @var \WP_Query $query */
		$query = $this-&gt;parent-&gt;get_query();

		do_action( &quot;geodir_ecs_before_loop_query&quot;, $query, $this );

		if ( ! $query-&gt;found_posts ) {
			$this-&gt;nothing_found();
			return;
		}

		$this-&gt;render_loop_header();

		// It&#039;s the global `wp_query` it self. and the loop was started from the theme.
		if ( $query-&gt;in_the_loop ) {
			$this-&gt;current_permalink = get_permalink();
			$this-&gt;render_post();
		} else {
			while ( $query-&gt;have_posts() ) {
				$query-&gt;the_post();

				$this-&gt;current_permalink = get_permalink();
				$this-&gt;render_post();
			}
		}

		do_action( &quot;geodir_ecs_after_loop_query&quot;, $query, $this );

		wp_reset_postdata();

		$this-&gt;render_loop_footer();
	}

	public function get_settings_for_display( $setting_key = null ) {
		if ( $setting_key ) {
			$settings = [
				$setting_key =&gt; $this-&gt;parent-&gt;get_settings( $setting_key ),
			];
		} else {
			$settings = $this-&gt;parent-&gt;get_active_settings();
		}

		$controls = $this-&gt;parent-&gt;get_controls();
		$controls = array_intersect_key( $controls, $settings );
		$parsed_settings = $this-&gt;parent-&gt;parse_dynamic_settings( $settings, $controls );

		if ( $setting_key ) {
			return $parsed_settings[ $setting_key ];
		}

		return $parsed_settings;
	}
}

/**
 * It seems the same skin brakes if set to 2 widgets in the same time.
 */
class GeoDir_Elementor_Skin_Archive extends GeoDir_Elementor_Skin_Posts {
	private $template_cache =[];
	private $pid;

	protected function _register_controls_actions() {
		add_action( &#039;elementor/element/archive-posts/section_layout/before_section_end&#039;, [ $this, &#039;register_controls&#039; ] );
		add_action( &#039;elementor/element/archive-posts/section_layout/after_section_end&#039;, [ $this, &#039;register_style_sections&#039; ] );

		add_action( &#039;elementor/element/archive-posts/&#039; . $this-&gt;get_id() . &#039;_section_design_layout/after_section_end&#039;, [ $this, &#039;register_navigation_design_controls&#039; ] );
		add_action( &#039;elementor/element/archive-posts/section_pagination/after_section_end&#039;, [ $this, &#039;register_navigation_controls&#039; ] );
	}

	public function get_id() {
		return &#039;gd_archive_custom&#039;;
	}

	public function get_title() {
		return __( &#039;GD Archive Item&#039;, &#039;geodirectory&#039; );
	}

	/* Remove `posts_per_page` control */
	protected function register_post_count_control() {
	}

}

// Add a custom skin for the POSTS widget
add_action( &#039;elementor/widget/posts/skins_init&#039;, function( $widget ) {
	$widget-&gt;add_skin( new GeoDir_Elementor_Skin_Posts( $widget ) );
} );

// Add a custom skin for the POST Archive widget
add_action( &#039;elementor/widget/archive-posts/skins_init&#039;, function( $widget ) {
	$widget-&gt;add_skin( new GeoDir_Elementor_Skin_Archive( $widget ) );
} );
</code></pre>
            </article>
            </div>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <footer class="phpdocumentor phpdocumentor-footer">
    <div class="phpdocumentor-section">
        <span>Geodirectory Code Reference API documentation generated by <a href="http://www.phpdoc.org/">phpDocumentor</a> on May 12th, 2022 at 06:15 am.</span>
    </div>
</footer>

    <script>
        cssVars({});
    </script>
    <script>
        var searchParams = {
            'searchIndex': '..\/js\/searchIndex.json'
        };
    </script>
    <script src="../js/searchIndex.js?updated=1652336158"></script>
    <script src="../js/search.js?updated=1652336158"></script>
</body>
</html>
