<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Geodirectory Code Reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/favicon.png" />
    <link rel="apple-touch-icon" href="../images/apple-touch-icon.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-touch-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-touch-icon-114x114.png"/>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/base.css?updated=1652336159">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/template.css?updated=1652336159">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
            <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/js/all.min.js" integrity="sha256-0vuk8LXoyrmCjp1f0O300qo1M75ZQyhH9X3J6d+scmk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8KCYZ2CYMS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8KCYZ2CYMS', {
		'content_group' : 'WooCommerce Core Code Reference',
	});
</script>
        <script src="../js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-top-header">
    <section class="phpdocumentor-section">
        <div class="site-branding">
            <a class="site-logo" href="../index.html"><img width="180" src="../images/logo.png" alt="WPGeodirectory" /></a>
        </div>
        <nav class="main-navigation">
            <ul>
                <li><a href="../hooks/hooks.html">Hooks Reference</a></li>
                <li><a href="https://docs.woocommerce.com/">Documentation</a></li>
                <li><a href="https://woocommerce.github.io/woocommerce-rest-api-docs/">REST API Docs</a></li>
                <li><a href="https://woocommerce.com/careers/?utm_source=woocommerce+core+code+reference&utm_medium=devdocs&utm_campaign=woo+careers" target="_blank">We're hiring!</a></li>
            </ul>
        </nav>
    </section>
</header>

<div class="phpdocumentor-header">
    <section class="phpdocumentor-section">
        <h1 class="phpdocumentor-title">Geodirectory Code Reference</h1>
        <section class="phpdocumentor-search">
    <label class="phpdocumentor-label">
        <span class="visually-hidden">Search (click ESC to close search results)</span>
        <input id="autoComplete" tabindex="1" type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading..." disabled />
    </label>
</section>

    </section>
</div>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <aside class="phpdocumentor-column -four phpdocumentor-sidebar">
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/elementorpro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/elementorpro-modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/Geodirectory.html"><abbr title="\Geodirectory">Geodirectory</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectory.html"><abbr title="\GeoDirectory">GeoDirectory</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/GeoDirectory-Templates.html"><abbr title="\GeoDirectory\Templates">Templates</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAbstracts.html"><abbr title="\GeoDirectoryAbstracts">GeoDirectoryAbstracts</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAPI.html"><abbr title="\GeoDirectoryAPI">GeoDirectoryAPI</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClasses.html"><abbr title="\GeoDirectoryClasses">GeoDirectoryClasses</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminFunctions.html"><abbr title="\GeoDirectoryAdminFunctions">GeoDirectoryAdminFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoruAdmin.html"><abbr title="\GeoDirectoruAdmin">GeoDirectoruAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdmin.html"><abbr title="\GeoDirectoryAdmin">GeoDirectoryAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirAdmin.html"><abbr title="\GeoDirAdmin">GeoDirAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectroyAdmin.html"><abbr title="\GeoDirectroyAdmin">GeoDirectroyAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminSystemStatus.html"><abbr title="\GeoDirectoryAdminSystemStatus">GeoDirectoryAdminSystemStatus</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminTools.html"><abbr title="\GeoDirectoryAdminTools">GeoDirectoryAdminTools</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminWidgets.html"><abbr title="\GeoDirectoryAdminWidgets">GeoDirectoryAdminWidgets</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesEmails.html"><abbr title="\GeoDirectoryClassesEmails">GeoDirectoryClassesEmails</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesData.html"><abbr title="\GeoDirectoryClassesData">GeoDirectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDIrectoryClassesData.html"><abbr title="\GeoDIrectoryClassesData">GeoDIrectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/ElementorPro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/ElementorPro-Modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryFunctions.html"><abbr title="\GeoDirectoryFunctions">GeoDirectoryFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryparamarraytermsAnarrayoftermobjects.html"><abbr title="\GeoDirectoryparamarraytermsAnarrayoftermobjects">GeoDirectoryparamarraytermsAnarrayoftermobjects</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WP.html"><abbr title="\WP">WP</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/WP-Background.html"><abbr title="\WP\Background">Background</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryTemplates.html"><abbr title="\GeoDirectoryTemplates">GeoDirectoryTemplates</abbr></a></h3>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../hooks/hooks.html">Hooks Reference</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">class-geodir-widget-categories.php</h2>

                

        
                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php
/**
 * GeoDirectory cpt categories widget.
 *
 * @package GeoDirectory
 * @since 1.5.4
 */

/**
 * GeoDirectory categories widget class.
 *
 * @since 1.5.4
 */
class GeoDir_Widget_Categories extends WP_Super_Duper {

    /**
     * Register the categories with WordPress.
     *
     * @since 2.0.0
     *
     */
    public function __construct() {

        $options = array(
            &#039;textdomain&#039;    =&gt; GEODIRECTORY_TEXTDOMAIN,
            &#039;block-icon&#039;    =&gt; &#039;admin-site&#039;,
            &#039;block-category&#039;=&gt; &#039;geodirectory&#039;,
            &#039;block-keywords&#039;=&gt; &quot;[&#039;categories&#039;,&#039;geo&#039;,&#039;taxonomy&#039;]&quot;,

            &#039;class_name&#039;    =&gt; __CLASS__,
            &#039;base_id&#039;       =&gt; &#039;gd_categories&#039;, // this us used as the widget id and the shortcode id.
            &#039;name&#039;          =&gt; __(&#039;GD &gt; Categories&#039;,&#039;geodirectory&#039;), // the name of the widget.
            &#039;widget_ops&#039;    =&gt; array(
                &#039;classname&#039;   =&gt; &#039;geodir-categories-container &#039;.geodir_bsui_class(), // widget class
                &#039;description&#039; =&gt; esc_html__(&#039;Shows a list of GeoDirectory categories.&#039;,&#039;geodirectory&#039;), // widget description
                &#039;customize_selective_refresh&#039; =&gt; true,
                &#039;geodirectory&#039; =&gt; true,
            ),
            &#039;arguments&#039;     =&gt; array(
                &#039;title&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&#039;Title:&#039;, &#039;geodirectory&#039;),
                    &#039;desc&#039; =&gt; __(&#039;The widget title.&#039;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;text&#039;,
                    &#039;default&#039;  =&gt; &#039;&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;group&#039;     =&gt; __(&quot;Title&quot;,&quot;geodirectory&quot;),
                    &#039;advanced&#039; =&gt; false
                ),
                &#039;post_type&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&#039;Post Type:&#039;, &#039;geodirectory&#039;),
                    &#039;desc&#039; =&gt; __(&#039;The custom post types to show by default. Only used when there are multiple CPTs.&#039;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;select&#039;,
                    &#039;options&#039;   =&gt;  $this-&gt;post_type_options(),
                    &#039;default&#039;  =&gt; &#039;0&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Filters&quot;,&quot;geodirectory&quot;)
                ),
				&#039;cpt_title&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __( &#039;Show CPT title:&#039;, &#039;geodirectory&#039; ),
                    &#039;desc&#039; =&gt; __( &#039;Tick to show CPT title. Ex: Place Categories&#039;, &#039;geodirectory&#039; ),
                    &#039;type&#039; =&gt; &#039;checkbox&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;value&#039;  =&gt; &#039;1&#039;,
                    &#039;default&#039;  =&gt; 0,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
                ),
                &#039;title_tag&#039;  =&gt; array(
	                &#039;title&#039; =&gt; __(&#039;Title tag:&#039;, &#039;geodirectory&#039;),
	                &#039;desc&#039; =&gt; __(&#039;The tag used to display the auto generated CPT title.&#039;, &#039;geodirectory&#039;),
	                &#039;type&#039; =&gt; &#039;select&#039;,
	                &#039;options&#039;   =&gt;  array(
		                &#039;h6&#039;      =&gt; &#039;h6&#039;,
		                &#039;h5&#039;      =&gt; &#039;h5&#039;,
		                &#039;h4&#039;      =&gt; &#039;h4&#039;,
		                &#039;h3&#039;      =&gt; &#039;h3&#039;,
		                &#039;h2&#039;      =&gt; &#039;h2&#039;,
		                &#039;span&#039;    =&gt; &#039;span&#039;,
	                ),
	                &#039;default&#039;  =&gt; &#039;h4&#039;,
	                &#039;desc_tip&#039; =&gt; true,
	                &#039;advanced&#039; =&gt; false,
	                &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
                ),
				&#039;cpt_ajax&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&#039;Add CPT ajax select:&#039;, &#039;geodirectory&#039;),
                    &#039;desc&#039; =&gt; __(&#039;Add CPT list as a dropdown.&#039;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;checkbox&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;value&#039;  =&gt; &#039;1&#039;,
                    &#039;default&#039;  =&gt; 0,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Filters&quot;,&quot;geodirectory&quot;)
                ),
				&#039;filter_ids&#039; =&gt; array(
					&#039;type&#039; =&gt; &#039;text&#039;,
					&#039;title&#039; =&gt; __( &#039;Include/exclude categories:&#039;, &#039;geodirectory&#039; ),
					&#039;desc&#039; =&gt; __( &#039;Enter a comma separated list of category ids (21,8,43) to show the these categories, or a negative list (-21,-8,-43) to exclude these categories.&#039;, &#039;geodirectory&#039; ),
					&#039;default&#039; =&gt; &#039;&#039;,
					&#039;desc_tip&#039; =&gt; true,
					&#039;advanced&#039; =&gt; false,
					&#039;placeholder&#039; =&gt; &quot;21,8,43 (default: empty)&quot;,
					&#039;group&#039; =&gt; __( &quot;Filters&quot;, &quot;geodirectory&quot; )
				),
                &#039;hide_empty&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&#039;Hide empty:&#039;, &#039;geodirectory&#039;),
                    &#039;desc&#039; =&gt; __(&#039;This will hide categories that do not have any listings.&#039;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;checkbox&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;value&#039;  =&gt; &#039;1&#039;,
                    &#039;default&#039;  =&gt; 0,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Filters&quot;,&quot;geodirectory&quot;)
                ),
                &#039;hide_count&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&#039;Hide count:&#039;, &#039;geodirectory&#039;),
                    &#039;desc&#039; =&gt; __(&#039;This will show the number of listings in the categories.&#039;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;checkbox&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;value&#039;  =&gt; &#039;1&#039;,
                    &#039;default&#039;  =&gt; 0,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
                ),
                &#039;hide_icon&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&#039;Hide icon:&#039;, &#039;geodirectory&#039;),
                    &#039;desc&#039; =&gt; __(&#039;This will hide the category icons from the list.&#039;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;checkbox&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;value&#039;  =&gt; &#039;1&#039;,
                    &#039;default&#039;  =&gt; 0,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
                ),
                &#039;use_image&#039;  =&gt; array(
	                &#039;title&#039; =&gt; __(&#039;Use category image:&#039;, &#039;geodirectory&#039;),
	                &#039;desc&#039; =&gt; __(&#039;This will use the category default image instead of the icons.&#039;, &#039;geodirectory&#039;),
	                &#039;type&#039; =&gt; &#039;checkbox&#039;,
	                &#039;desc_tip&#039; =&gt; true,
	                &#039;value&#039;  =&gt; &#039;1&#039;,
	                &#039;default&#039;  =&gt; 0,
	                &#039;advanced&#039; =&gt; false,
	                &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
                ),
				&#039;image_size&#039; =&gt; array(
					&#039;type&#039; =&gt; &#039;select&#039;,
					&#039;title&#039; =&gt; __( &#039;Image size:&#039;, &#039;geodirectory&#039; ),
					&#039;desc&#039; =&gt; __( &#039;Image size to show category image.&#039;, &#039;geodirectory&#039; ),
					&#039;options&#039; =&gt; self::get_image_sizes(),
					&#039;value&#039; =&gt; &#039;&#039;,
					&#039;default&#039; =&gt; &#039;medium&#039;,
					&#039;desc_tip&#039; =&gt; true,
					&#039;advanced&#039; =&gt; false,
					&#039;element_require&#039; =&gt; &#039;([%use_image%]==&quot;1&quot; || [%design_type%]==&quot;image&quot;)&#039;,
					&#039;group&#039; =&gt; __( &#039;Design&#039;, &#039;geodirectory&#039; ),
				),
                &#039;cpt_left&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&#039;Show single column:&#039;, &#039;geodirectory&#039;),
                    &#039;desc&#039; =&gt; __(&#039;This will show list in single column.&#039;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;checkbox&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;value&#039;  =&gt; &#039;1&#039;,
                    &#039;default&#039;  =&gt; 0,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
                ),
                &#039;sort_by&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&#039;Sort by:&#039;, &#039;geodirectory&#039;),
                    &#039;desc&#039; =&gt; __(&#039;Sort categories by.&#039;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;select&#039;,
                    &#039;options&#039;   =&gt;  array(
                        &quot;count&quot; =&gt; __(&#039;Count&#039;, &#039;geodirectory&#039;),
                        &quot;az&quot; =&gt; __(&#039;A-Z&#039;, &#039;geodirectory&#039;),
                    ),
                    &#039;default&#039;  =&gt; &#039;count&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Sorting&quot;,&quot;geodirectory&quot;)
                ),
                &#039;max_level&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&#039;Max sub-cat depth:&#039;, &#039;geodirectory&#039;),
                    &#039;desc&#039; =&gt; __(&#039;The maximum number of sub category levels to show.&#039;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;select&#039;,
                    &#039;options&#039;   =&gt;  array_merge(array(&#039;all&#039; =&gt; __(&#039;All&#039;, &#039;geodirectory&#039;)), range(0, 10)),
                    &#039;default&#039;  =&gt; &#039;1&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Filters&quot;,&quot;geodirectory&quot;)
                ),
                &#039;max_count&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&#039;Max cats to show per CPT:&#039;, &#039;geodirectory&#039;),
                    &#039;desc&#039; =&gt; __(&#039;The maximum number of categories to show per CPT.&#039;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;select&#039;,
                    &#039;options&#039;   =&gt;  array_merge(array(&#039;all&#039; =&gt; __(&#039;All&#039;, &#039;geodirectory&#039;)), range(0, 10) ),
                    &#039;default&#039;  =&gt; &#039;all&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Filters&quot;,&quot;geodirectory&quot;)
                ),
                &#039;max_count_child&#039;  =&gt; array(
	                &#039;title&#039; =&gt; __(&#039;Max sub-cat to show:&#039;, &#039;geodirectory&#039;),
	                &#039;desc&#039; =&gt; __(&#039;The maximum number of sub categories to show.&#039;, &#039;geodirectory&#039;),
	                &#039;type&#039; =&gt; &#039;select&#039;,
	                &#039;options&#039;   =&gt;  array_merge(array(&#039;all&#039; =&gt; __(&#039;All&#039;, &#039;geodirectory&#039;)), range(0, 10) ),
	                &#039;default&#039;  =&gt; &#039;all&#039;,
	                &#039;desc_tip&#039; =&gt; true,
	                &#039;advanced&#039; =&gt; false,
	                &#039;group&#039;     =&gt; __(&quot;Filters&quot;,&quot;geodirectory&quot;)
                ),
                &#039;no_cpt_filter&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&quot;Do not filter for current viewing post type&quot;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;checkbox&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;value&#039;  =&gt; &#039;1&#039;,
                    &#039;default&#039;  =&gt; 0,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Filters&quot;,&quot;geodirectory&quot;)
                ),
                &#039;no_cat_filter&#039;  =&gt; array(
                    &#039;title&#039; =&gt; __(&quot;Tick to show all the categories. Leave unticked to show only child categories of current viewing category.&quot;, &#039;geodirectory&#039;),
                    &#039;type&#039; =&gt; &#039;checkbox&#039;,
                    &#039;desc_tip&#039; =&gt; true,
                    &#039;value&#039;  =&gt; &#039;1&#039;,
                    &#039;default&#039;  =&gt; 0,
                    &#039;advanced&#039; =&gt; false,
                    &#039;group&#039;     =&gt; __(&quot;Filters&quot;,&quot;geodirectory&quot;)
                ),

            )
        );


	    $design_style = geodir_design_style();

	    if($design_style){

		    // title styles
		    $title_args = geodir_get_sd_title_inputs();
		    $options[&#039;arguments&#039;] = $options[&#039;arguments&#039;] + $title_args;

		    $options[&#039;arguments&#039;][&#039;design_type&#039;] = array(
			    &#039;title&#039; =&gt; __(&#039;Design Type&#039;, &#039;geodirectory&#039;),
			    &#039;desc&#039; =&gt; __(&#039;Set the design type&#039;, &#039;geodirectory&#039;),
			    &#039;type&#039; =&gt; &#039;select&#039;,
			    &#039;options&#039;   =&gt;  array(
				    &quot;icon-left&quot; =&gt; __(&#039;Icon Left&#039;, &#039;geodirectory&#039;),
				    &quot;icon-top&quot; =&gt; __(&#039;Icon Top&#039;, &#039;geodirectory&#039;),
				    &quot;image&quot; =&gt; __(&#039;Image Background&#039;, &#039;geodirectory&#039;),
			    ),
			    &#039;default&#039;  =&gt; &#039;&#039;,
			    &#039;desc_tip&#039; =&gt; true,
			    &#039;advanced&#039; =&gt; false,
			    &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
		    );
		    $options[&#039;arguments&#039;][&#039;row_items&#039;] = array(
			    &#039;title&#039; =&gt; __(&#039;Row Items&#039;, &#039;geodirectory&#039;),
			    &#039;desc&#039; =&gt; __(&#039;The number of items in a row on desktop view.&#039;, &#039;geodirectory&#039;),
			    &#039;type&#039; =&gt; &#039;select&#039;,
			    &#039;options&#039;   =&gt;  array(
				    &quot;&quot; =&gt; __(&#039;Default (3)&#039;, &#039;geodirectory&#039;),
				    &quot;1&quot; =&gt; &quot;1&quot;,
				    &quot;2&quot; =&gt; &quot;2&quot;,
				    &quot;3&quot; =&gt; &quot;3&quot;,
				    &quot;4&quot; =&gt; &quot;4&quot;,
				    &quot;5&quot; =&gt; &quot;5&quot;,
				    &quot;6&quot; =&gt; &quot;6&quot;,
			    ),
			    &#039;default&#039;  =&gt; &#039;&#039;,
			    &#039;desc_tip&#039; =&gt; true,
			    &#039;advanced&#039; =&gt; false,
			    &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
		    );
		    $options[&#039;arguments&#039;][&#039;row_positioning&#039;] = array(
			    &#039;title&#039; =&gt; __(&#039;Row Positioning&#039;, &#039;geodirectory&#039;),
			    &#039;desc&#039; =&gt; __(&#039;Positions items that do not fill a whole row.&#039;, &#039;geodirectory&#039;),
			    &#039;type&#039; =&gt; &#039;select&#039;,
			    &#039;options&#039;   =&gt;  array(
				    &quot;&quot; =&gt; __(&#039;Default (left)&#039;, &#039;geodirectory&#039;),
				    &quot;center&quot; =&gt; __(&#039;Center&#039;, &#039;geodirectory&#039;),
				    &quot;right&quot; =&gt; __(&#039;Right&#039;, &#039;geodirectory&#039;),
			    ),
			    &#039;default&#039;  =&gt; &#039;&#039;,
			    &#039;desc_tip&#039; =&gt; true,
			    &#039;advanced&#039; =&gt; false,
			    &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
		    );
		    $options[&#039;arguments&#039;][&#039;card_padding_inside&#039;] = array(
			    &#039;title&#039; =&gt; __(&#039;Card Padding Inside&#039;, &#039;geodirectory&#039;),
			    &#039;desc&#039; =&gt; __(&#039;Set the inside padding for the card&#039;, &#039;geodirectory&#039;),
			    &#039;type&#039; =&gt; &#039;select&#039;,
			    &#039;options&#039;   =&gt;  array(
				    &quot;&quot; =&gt; &quot;3 (default)&quot;,
				    &quot;1&quot; =&gt; &quot;1&quot;,
				    &quot;2&quot; =&gt; &quot;2&quot;,
				    &quot;3&quot; =&gt; &quot;3&quot;,
				    &quot;4&quot; =&gt; &quot;4&quot;,
				    &quot;5&quot; =&gt; &quot;5&quot;,
			    ),
			    &#039;default&#039;  =&gt; &#039;&#039;,
			    &#039;desc_tip&#039; =&gt; true,
			    &#039;advanced&#039; =&gt; false,
			    &#039;element_require&#039; =&gt; &#039;[%design_type%]!=&quot;image&quot;&#039;,
			    &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
		    );
		    $options[&#039;arguments&#039;][&#039;card_color&#039;] = array(
			    &#039;title&#039; =&gt; __(&#039;Card Color&#039;, &#039;geodirectory&#039;),
			    &#039;desc&#039; =&gt; __(&#039;Set the card color&#039;, &#039;geodirectory&#039;),
			    &#039;type&#039; =&gt; &#039;select&#039;,
			    &#039;options&#039;   =&gt;  array(
				                    &quot;&quot; =&gt; __(&#039;Select color&#039;, &#039;geodirectory&#039;),
			                    )+geodir_aui_colors(false,true),
			    &#039;default&#039;  =&gt; &#039;&#039;,
			    &#039;desc_tip&#039; =&gt; true,
			    &#039;advanced&#039; =&gt; false,
			    &#039;element_require&#039; =&gt; &#039;[%design_type%]!=&quot;image&quot;&#039;,
			    &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
		    );

			$options[&#039;arguments&#039;][&#039;card_shadow&#039;] = array(
				&#039;title&#039; =&gt; __( &#039;Card shadow&#039;, &#039;geodirectory&#039; ),
				&#039;desc&#039; =&gt; __( &#039;Set the card shadow style.&#039;, &#039;geodirectory&#039; ),
				&#039;type&#039; =&gt; &#039;select&#039;,
				&#039;options&#039; =&gt; array(
					&#039;small&#039; =&gt; __( &#039;Default(small)&#039;, &#039;geodirectory&#039; ),
					&#039;medium&#039; =&gt; __( &#039;Medium&#039;, &#039;geodirectory&#039; ),
					&#039;large&#039; =&gt; __( &#039;Large&#039;, &#039;geodirectory&#039; ),
					&#039;none&#039; =&gt; __( &#039;None&#039;, &#039;geodirectory&#039; ),
				),
				&#039;default&#039; =&gt; &#039;&#039;,
				&#039;desc_tip&#039; =&gt; true,
				&#039;advanced&#039; =&gt; false,
				&#039;group&#039;  =&gt; __( &#039;Design&#039;, &#039;geodirectory&#039; )
			);

		    $options[&#039;arguments&#039;][&#039;icon_color&#039;] = array(
			    &#039;title&#039; =&gt; __(&#039;Icon Color&#039;, &#039;geodirectory&#039;),
			    &#039;desc&#039; =&gt; __(&#039;Set the icon color&#039;, &#039;geodirectory&#039;),
			    &#039;type&#039; =&gt; &#039;select&#039;,
			    &#039;options&#039;   =&gt;  array(
				                    &quot;&quot; =&gt; __(&#039;Use Category Color (default)&#039;, &#039;geodirectory&#039;),
			                    )+geodir_aui_colors(),
			    &#039;default&#039;  =&gt; &#039;&#039;,
			    &#039;desc_tip&#039; =&gt; true,
			    &#039;advanced&#039; =&gt; false,
			    &#039;element_require&#039; =&gt; &#039;[%design_type%]!=&quot;image&quot;&#039;,
			    &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
		    );

		    $options[&#039;arguments&#039;][&#039;icon_size&#039;] = array(
			    &#039;title&#039; =&gt; __(&#039;Icon Size&#039;, &#039;geodirectory&#039;),
			    &#039;desc&#039; =&gt; __(&#039;Set the icon size&#039;, &#039;geodirectory&#039;),
			    &#039;type&#039; =&gt; &#039;select&#039;,
			    &#039;options&#039;   =&gt;  array(
				    &quot;&quot; =&gt; __(&#039;Boxed Small&#039;, &#039;geodirectory&#039;),
				    &quot;box-medium&quot; =&gt; __(&#039;Boxed Medium&#039;, &#039;geodirectory&#039;),
				    &quot;box-large&quot; =&gt; __(&#039;Boxed Large&#039;, &#039;geodirectory&#039;),
				    &quot;h1&quot; =&gt; &#039;XXL&#039;,
				    &quot;h2&quot; =&gt; &#039;XL&#039;,
				    &quot;h3&quot; =&gt; &#039;L&#039;,
				    &quot;h4&quot; =&gt; &#039;M&#039;,
				    &quot;h5&quot; =&gt; &#039;S&#039;,
				    &quot;h6&quot; =&gt; &#039;XS&#039;,
			    ),
			    &#039;default&#039;  =&gt; &#039;&#039;,
			    &#039;desc_tip&#039; =&gt; true,
			    &#039;advanced&#039; =&gt; false,
			    &#039;element_require&#039; =&gt; &#039;[%design_type%]!=&quot;image&quot;&#039;,
			    &#039;group&#039;     =&gt; __(&quot;Design&quot;,&quot;geodirectory&quot;)
		    );


		    // background
		    $arguments[&#039;bg&#039;]  = geodir_get_sd_background_input();

		    // margins
		    $arguments[&#039;mt&#039;]  = geodir_get_sd_margin_input(&#039;mt&#039;);
		    $arguments[&#039;mr&#039;]  = geodir_get_sd_margin_input(&#039;mr&#039;);
		    $arguments[&#039;mb&#039;]  = geodir_get_sd_margin_input(&#039;mb&#039;,array(&#039;default&#039;=&gt;3));
		    $arguments[&#039;ml&#039;]  = geodir_get_sd_margin_input(&#039;ml&#039;);

		    // padding
		    $arguments[&#039;pt&#039;]  = geodir_get_sd_padding_input(&#039;pt&#039;);
		    $arguments[&#039;pr&#039;]  = geodir_get_sd_padding_input(&#039;pr&#039;);
		    $arguments[&#039;pb&#039;]  = geodir_get_sd_padding_input(&#039;pb&#039;);
		    $arguments[&#039;pl&#039;]  = geodir_get_sd_padding_input(&#039;pl&#039;);

		    // border
		    $arguments[&#039;border&#039;]  = geodir_get_sd_border_input(&#039;border&#039;);
		    $arguments[&#039;rounded&#039;]  = geodir_get_sd_border_input(&#039;rounded&#039;);
		    $arguments[&#039;rounded_size&#039;]  = geodir_get_sd_border_input(&#039;rounded_size&#039;);

		    // shadow
		    $arguments[&#039;shadow&#039;]  = geodir_get_sd_shadow_input(&#039;shadow&#039;);

		    $options[&#039;arguments&#039;] = $options[&#039;arguments&#039;] + $arguments;
	    }


        parent::__construct( $options );
    }

    /**
     * The Super block output function.
     *
     * @param array $args
     * @param array $widget_args
     * @param string $content
     *
     * @return mixed|string|void
     */
    public function output($args = array(), $widget_args = array(),$content = &#039;&#039;){

		add_action(&#039;wp_footer&#039;, array($this, &#039;add_js&#039;));
		
        ob_start();
        // options
        $defaults = array(
            &#039;post_type&#039; =&gt; &#039;0&#039;, // 0 =  all
            &#039;hide_empty&#039; =&gt; &#039;0&#039;,
            &#039;hide_count&#039; =&gt; &#039;0&#039;,
	        &#039;use_image&#039; =&gt; &#039;0&#039;,
	        &#039;image_size&#039; =&gt; &#039;medium&#039;,
			&#039;cpt_ajax&#039; =&gt; &#039;0&#039;,
			&#039;filter_ids&#039; =&gt; array(), // comma separated ids or array
	        &#039;title_tag&#039; =&gt; &#039;h4&#039;,
            &#039;cpt_title&#039; =&gt; &#039;&#039;,
            &#039;card_color&#039; =&gt; &#039;outline-primary&#039;,
			&#039;card_shadow&#039; =&gt; &#039;small&#039;,
            &#039;icon_color&#039; =&gt; &#039;&#039;,
            &#039;icon_size&#039; =&gt; &#039;box-small&#039;,
            &#039;design_type&#039; =&gt; &#039;icon-left&#039;,
            &#039;row_items&#039; =&gt; &#039;3&#039;,
	        &#039;row_positioning&#039;   =&gt; &#039;&#039;,
	        &#039;card_padding_inside&#039;   =&gt; &#039;3&#039;,
            &#039;bg&#039;    =&gt; &#039;&#039;,
            &#039;mt&#039;    =&gt; &#039;&#039;,
            &#039;mb&#039;    =&gt; &#039;3&#039;,
            &#039;mr&#039;    =&gt; &#039;&#039;,
            &#039;ml&#039;    =&gt; &#039;&#039;,
            &#039;pt&#039;    =&gt; &#039;&#039;,
            &#039;pb&#039;    =&gt; &#039;&#039;,
            &#039;pr&#039;    =&gt; &#039;&#039;,
            &#039;pl&#039;    =&gt; &#039;&#039;,
            &#039;border&#039;    =&gt; &#039;&#039;,
            &#039;rounded&#039;    =&gt; &#039;&#039;,
            &#039;rounded_size&#039;    =&gt; &#039;&#039;,
            &#039;shadow&#039;    =&gt; &#039;&#039;,
        );

        /**
         * Parse incoming $args into an array and merge it with $defaults
         */
	    $options = wp_parse_args( $args, $defaults );

//	    print_r($args);
//	    print_r($options);

	    if(empty($options[&#039;card_color&#039;])){$options[&#039;card_color&#039;] = $defaults[&#039;card_color&#039;];}
	    if(empty($options[&#039;icon_size&#039;])){$options[&#039;icon_size&#039;] = $defaults[&#039;icon_size&#039;];}
	    if(empty($options[&#039;design_type&#039;])){$options[&#039;design_type&#039;] = $defaults[&#039;design_type&#039;];}
	    if(empty($options[&#039;card_padding_inside&#039;])){$options[&#039;card_padding_inside&#039;] = $defaults[&#039;card_padding_inside&#039;];}

        $output = self::categories_output( $options );

		$ajax_class = ! empty( $options[&#039;cpt_ajax&#039;] ) ? &#039; gd-wgt-cpt-ajax&#039; : &#039;&#039;;

	    // wrapper class
	    $wrap_class = geodir_build_aui_class($options);

	    if($output){
		    echo &#039;&lt;div class=&quot;gd-categories-widget &#039; . $ajax_class . &#039; &#039; . $wrap_class . &#039;&quot;&gt;&#039;;
		    echo $output;
		    echo &#039;&lt;/div&gt;&#039;;
	    }


        return ob_get_clean();
    }


    /**
     * Get the post type options for search.
     *
     * @since 2.0.0
     *
     * @return array $options
     */
    public function post_type_options(){
        $options = array(&#039;0&#039;=&gt;__(&#039;Auto&#039;,&#039;geodirectory&#039;));

        $post_types = geodir_get_posttypes(&#039;options-plural&#039;);
        if(!empty($post_types)){
            $options = array_merge($options,$post_types);
        }

        //print_r($options);

        return $options;
    }

    /**
     * Get categories.
     *
     * @since 2.0.0
     *
     * @param array $params Category parameter.
     */
	public static function get_categories( $params ) {
		$params[&#039;via_ajax&#039;] = true;
		$output = self::categories_output( $params );
		if ( ! empty( $output ) ) {
			echo $output;
		} else {
			$design_style = geodir_design_style();
			$alert_class = $design_style ? &#039;alert alert-info&#039; : &#039;&#039;;
			echo &#039;&lt;div class=&quot;gd-cptcats-empty &#039;.$alert_class.&#039;&quot;&gt;&#039; . __( &#039;No categories found&#039;,&#039;geodirectory&#039; ) . &#039;&lt;/div&gt;&#039;;
		}
	}
	
	/**
	 * Adds the javascript in the footer for best of widget.
	 *
	 * @since 2.0.0
	 */
	public function add_js() {
		?&gt;
        &lt;script type=&quot;text/javascript&quot;&gt;
            if (!window.gdCategoriesJs) {
	            document.addEventListener(&quot;DOMContentLoaded&quot;, function(event) {
                    jQuery(&#039;.geodir-cat-list-tax&#039;).on(&quot;change&quot;, function(e) {
                        e.preventDefault();
                        var $widgetBox = jQuery(this).closest(&#039;.geodir-categories-container&#039;);
                        var $container = jQuery(&#039;.gd-cptcat-rows&#039;, $widgetBox);
                        $container.addClass(&#039;gd-loading&#039;);
                        $container.html(&#039;&lt;i class=&quot;fas fa-cog fa-spin&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&#039;);
                        var data = {
                            &#039;action&#039;: &#039;geodir_cpt_categories&#039;,
                            &#039;security&#039;: geodir_params.basic_nonce,
                            &#039;ajax_cpt&#039;: jQuery(this).val()
                        };
                        jQuery(&#039;.gd-wgt-params&#039;, $widgetBox).find(&#039;input&#039;).each(function() {
                            if (jQuery(this).attr(&#039;name&#039;)) {
                                data[jQuery(this).attr(&#039;name&#039;)] = jQuery(this).val();
                            }
                        });
                        jQuery.post(geodir_params.ajax_url, data, function(response) {
                            $container.html(response);
                            $container.removeClass(&#039;gd-loading&#039;);
                        });
                    })
                });
                window.gdCategoriesJs = true;
			}
        &lt;/script&gt;
		&lt;?php
	}


	/**
	 * Get the cpt categories content.
	 *
	 * @since 1.5.4
	 * @since 1.6.6 New parameters $no_cpt_filter &amp;no_cat_filter added.
	 *
	 * @global object $post The post object.
	 * @global bool $gd_use_query_vars If true then use query vars to get current location terms.
	 *
	 * @param array $params An array of cpt categories parameters.
	 * @return string CPT categories content.
	 */
	public static function categories_output($params) {

		global $post, $gd_use_query_vars;

		$old_gd_use_query_vars = $gd_use_query_vars;

		$gd_use_query_vars = geodir_is_page(&#039;detail&#039;) ? true : false;

		$args = wp_parse_args((array)$params,
			array(
				&#039;title&#039; =&gt; &#039;&#039;,
				&#039;title_tag&#039; =&gt; &#039;span&#039;,
				&#039;post_type&#039; =&gt; array(), // NULL for all
				&#039;hide_empty&#039; =&gt; &#039;&#039;,
				&#039;hide_count&#039; =&gt; &#039;&#039;,
				&#039;hide_icon&#039; =&gt; &#039;&#039;,
				&#039;use_image&#039; =&gt; &#039;&#039;,
				&#039;cpt_left&#039; =&gt; &#039;&#039;,
				&#039;sort_by&#039; =&gt; &#039;count&#039;,
				&#039;max_count&#039; =&gt; &#039;all&#039;,
				&#039;max_count_child&#039; =&gt; &#039;all&#039;,
				&#039;max_level&#039; =&gt; &#039;1&#039;,
				&#039;no_cpt_filter&#039; =&gt; &#039;&#039;,
				&#039;no_cat_filter&#039; =&gt; &#039;&#039;,
				&#039;cpt_ajax&#039; =&gt; &#039;&#039;,
				&#039;filter_ids&#039; =&gt; array(), // comma separated ids or array
				&#039;cpt_title&#039; =&gt; &#039;&#039;,
				&#039;card_color&#039; =&gt; &#039;outline-primary&#039;,
				&#039;card_shadow&#039; =&gt; &#039;small&#039;,
				&#039;icon_color&#039; =&gt; &#039;&#039;,
				&#039;icon_size&#039; =&gt; &#039;box-small&#039;,
				&#039;design_type&#039; =&gt; &#039;icon-left&#039;,
				&#039;row_items&#039; =&gt; &#039;3&#039;,
				&#039;row_positioning&#039;   =&gt; &#039;&#039;,
				&#039;card_padding_inside&#039;   =&gt; &#039;3&#039;,

				&#039;bg&#039;    =&gt; &#039;&#039;,
		        &#039;mt&#039;    =&gt; &#039;&#039;,
		        &#039;mb&#039;    =&gt; &#039;3&#039;,
		        &#039;mr&#039;    =&gt; &#039;&#039;,
		        &#039;ml&#039;    =&gt; &#039;&#039;,
		        &#039;pt&#039;    =&gt; &#039;&#039;,
		        &#039;pb&#039;    =&gt; &#039;&#039;,
		        &#039;pr&#039;    =&gt; &#039;&#039;,
		        &#039;pl&#039;    =&gt; &#039;&#039;,
		        &#039;border&#039;    =&gt; &#039;&#039;,
		        &#039;rounded&#039;    =&gt; &#039;&#039;,
		        &#039;rounded_size&#039;    =&gt; &#039;&#039;,
		        &#039;shadow&#039;    =&gt; &#039;&#039;,
			)
		);

		$sort_by = isset($args[&#039;sort_by&#039;]) &amp;&amp; in_array($args[&#039;sort_by&#039;], array(&#039;az&#039;, &#039;count&#039;)) ? sanitize_text_field( $args[&#039;sort_by&#039;] ) : &#039;count&#039;;
		$cpt_filter = empty($args[&#039;no_cpt_filter&#039;]) ? true : false;
		$cat_filter = empty($args[&#039;no_cat_filter&#039;]) ? true : false;
		$cpt_ajax = ! empty( $args[&#039;cpt_ajax&#039;] ) ? true : false;

		$gd_post_types = geodir_get_posttypes(&#039;array&#039;);

		$post_type_arr = !is_array($args[&#039;post_type&#039;]) ? explode(&#039;,&#039;, $args[&#039;post_type&#039;]) : $args[&#039;post_type&#039;];
		$current_posttype = geodir_get_current_posttype();

		$is_listing = false;
		$is_detail = false;
		$is_category = false;
		$current_term_id = 0;
		$post_ID = 0;
		$is_listing_page = geodir_is_page(&#039;listing&#039;);
		$is_detail_page = geodir_is_page(&#039;detail&#039;);
		if ( $is_listing_page || $is_detail_page || geodir_is_page( &#039;search&#039; ) ) {
			$current_posttype = geodir_get_current_posttype();

			if ($current_posttype != &#039;&#039; &amp;&amp; isset($gd_post_types[$current_posttype])) {
				if ($is_detail_page) {
					$is_detail = true;
					$post_ID = is_object($post) &amp;&amp; !empty($post-&gt;ID) ? (int)$post-&gt;ID : 0;
				} else {
					$is_listing = true;
					if (is_tax()) { // category page
						$current_term_id = get_queried_object_id();

						if ($current_term_id &amp;&amp; $current_posttype &amp;&amp; get_query_var(&#039;taxonomy&#039;) == $current_posttype . &#039;category&#039;) {
							$is_category = true;
						}
					} elseif ( geodir_is_page( &#039;search&#039; ) &amp;&amp; isset( $_REQUEST[&#039;spost_category&#039;] ) &amp;&amp; ( ( is_array( $_REQUEST[&#039;spost_category&#039;] ) &amp;&amp; ! empty( $_REQUEST[&#039;spost_category&#039;][0] ) ) || ( ! is_array( $_REQUEST[&#039;spost_category&#039;] ) &amp;&amp; ! empty( $_REQUEST[&#039;spost_category&#039;] ) ) ) ) {
						$is_category = true;

						if ( is_array( $_REQUEST[&#039;spost_category&#039;] ) &amp;&amp; 1 == count( $_REQUEST[&#039;spost_category&#039;]) ) {
							$current_term_id = absint( $_REQUEST[&#039;spost_category&#039;][0] );
						} else {
							$current_term_id = absint( $_REQUEST[&#039;spost_category&#039;] );
						}
					}
				}
			}
		}

		$parent_category = 0;
		if (($is_listing || $is_detail) &amp;&amp; $cpt_filter) {
			$post_type_arr = array($current_posttype);
		}

		$post_types = array();
		if (!empty($post_type_arr)) {
			if (in_array(&#039;0&#039;, $post_type_arr)) {
				$post_types = $gd_post_types;
			} else {
				foreach ($post_type_arr as $cpt) {
					if (isset($gd_post_types[$cpt])) {
						$post_types[$cpt] = $gd_post_types[$cpt];
					}
				}
			}
		}

		if (empty($post_type_arr)) {
			$post_types = $gd_post_types;
		}

		$hide_empty = !empty($args[&#039;hide_empty&#039;]) ? true : false;
		$max_count = strip_tags($args[&#039;max_count&#039;]);
		$max_count_child = strip_tags($args[&#039;max_count_child&#039;]);
		$all_childs = $max_count_child == &#039;all&#039; ? true : false;
		$max_count = $max_count &gt; 0 ? (int)$max_count : 0;
		$max_count_child = $max_count_child &gt; 0 ? (int)$max_count_child : 0;
		$max_level = $args[&#039;max_level&#039;]==&#039;all&#039; ? 0 : strval(absint($args[&#039;max_level&#039;]));
		$hide_count = !empty($args[&#039;hide_count&#039;]) ? true : false;
		$hide_icon = !empty($args[&#039;hide_icon&#039;]) ? true : false;
		$use_image = !empty($args[&#039;use_image&#039;]) ? true : false;
		$cpt_left = !empty($args[&#039;cpt_left&#039;]) ? true : false;
		$image_size = ! empty( $args[&#039;image_size&#039;] ) ? $args[&#039;image_size&#039;] : &#039;medium&#039;;

		// Include/exclude terms
		if ( ! empty( $args[&#039;filter_ids&#039;] ) ) {
			$filter_ids = is_array( $args[&#039;filter_ids&#039;] ) ? implode( &#039;,&#039;, $args[&#039;filter_ids&#039;] ) : $args[&#039;filter_ids&#039;];
		} else {
			$filter_ids = &#039;&#039;;
		}

		$filter_terms = array(
			&#039;include&#039; =&gt; array(),
			&#039;exclude&#039; =&gt; array(),
		);

		if ( ! empty( $filter_ids ) ) {
			$_filter_ids = explode( &quot;,&quot;, $filter_ids );

			foreach( $_filter_ids as $filter_id ) {
				$filter_id = trim( $filter_id );

				if ( absint( $filter_id ) &gt; 0 ) {
					if ( abs( $filter_id ) != $filter_id ) {
						$filter_terms[&#039;exclude&#039;][] = absint( $filter_id );
					} else {
						$filter_terms[&#039;include&#039;][] = absint( $filter_id );
					}
				}
			}
		}

		if($cpt_left){
			$cpt_left_class = &quot;gd-cpt-flat&quot;;
		}else{
			$cpt_left_class = &#039;&#039;;
		}

		$orderby = &#039;count&#039;;
		$order = &#039;DESC&#039;;
		if ($sort_by == &#039;az&#039;) {
			$orderby = &#039;name&#039;;
			$order = &#039;ASC&#039;;
		}

		$via_ajax = ! empty($params[&#039;via_ajax&#039;]) &amp;&amp; wp_doing_ajax() ? true : false;
		$ajax_cpt = ! empty($params[&#039;ajax_cpt&#039;]) &amp;&amp; $via_ajax ? sanitize_text_field( $params[&#039;ajax_cpt&#039;] ) : &#039;&#039;;
		$set_location = array();
		if ( $via_ajax ) {
			if ( ! empty( $params[&#039;ajax_is_listing&#039;] ) ) {
				$is_listing = true;
			}
			if ( ! empty( $params[&#039;ajax_is_detail&#039;] ) ) {
				$is_detail = true;
			}
			if ( ! empty( $params[&#039;ajax_is_category&#039;] ) ) {
				$is_category = true;
			}
			if ( ! empty( $params[&#039;ajax_post_ID&#039;] ) ) {
				$post_ID = absint( $params[&#039;ajax_post_ID&#039;] );
			}
			if ( ! empty( $params[&#039;ajax_current_term_id&#039;] ) ) {
				$current_term_id = absint( $params[&#039;ajax_current_term_id&#039;] );
			}
			if ( GeoDir_Post_types::supports( $ajax_cpt, &#039;location&#039; ) ) {
				foreach ( $params as $_key =&gt; $_value ) {
					if ( strpos( $_key, &#039;_gd_set_loc_&#039; ) === 0 &amp;&amp; ( $_key = substr( sanitize_text_field( $_key ), 12 ) ) &amp;&amp; ( is_scalar( $_value ) || ( ! is_object( $_value ) &amp;&amp; ! is_array( $_value ) ) ) ) {
						$set_location[ $_key ] = sanitize_text_field( stripslashes( $_value ) );
					}
				}
			}
		}

		$output = &#039;&#039;;
		if (!empty($post_types)) {
			global $geodirectory;
			// Backup
			$backup_geodirectory = $geodirectory;

			$design_style = geodir_design_style();

			$cpt_options = array();
			$cpt_list = &#039;&#039;;
			$cpt_count = 0;
			$cpt_opened = false;
			$cpt_closed = false;
			foreach ($post_types as $cpt =&gt; $cpt_info) {

				$cpt_count++;
				if ($ajax_cpt &amp;&amp; $ajax_cpt !== $cpt) {
					continue;
				}
				$cpt_options[] = &#039;&lt;option value=&quot;&#039; . $cpt . &#039;&quot; &#039; . selected( $cpt, $current_posttype, false ) . &#039;&gt;&#039; . wp_sprintf( __( &#039;%s Categories&#039;, &#039;geodirectory&#039; ), __( $cpt_info[&#039;labels&#039;][&#039;singular_name&#039;], &#039;geodirectory&#039; ) ) . &#039;&lt;/option&gt;&#039;;

				// if ajaxed then only show the first one
				if($cpt_ajax &amp;&amp; $cpt_list != &#039;&#039;){ continue;}

				if ( $via_ajax &amp;&amp; $set_location ) {
					foreach ( $set_location as $_key =&gt; $_value ) {
						$geodirectory-&gt;location-&gt;{$_key} = $_value;
					}
				}

				$parent_category = ($is_category &amp;&amp; $cat_filter &amp;&amp; $cpt == $current_posttype) ? $current_term_id : 0;
				$cat_taxonomy = $cpt . &#039;category&#039;;
				$skip_childs = false;

				$category_args = array(
					&#039;orderby&#039;    =&gt; $orderby, 
					&#039;order&#039;      =&gt; $order, 
					&#039;hide_empty&#039; =&gt; $hide_empty, 
					&#039;number&#039;     =&gt; $max_count,
				);

				// Include terms
				if ( ! empty( $filter_terms[&#039;include&#039;] ) ) {
					$category_args[&#039;include&#039;] = $filter_terms[&#039;include&#039;];
				}

				// Exclude terms
				if ( ! empty( $filter_terms[&#039;exclude&#039;] ) ) {
					$category_args[&#039;exclude&#039;] = $filter_terms[&#039;exclude&#039;];
				}

				/**
				 * Filters the category arguments passed to get_terms when fetching categories for GD Categories widget
				 */
				$category_args = apply_filters( &#039;geodir_gd_category_widget_category_args&#039;, $category_args, $cat_taxonomy );

				if ($cat_filter &amp;&amp; $cpt == $current_posttype &amp;&amp; $is_detail &amp;&amp; $post_ID) {
					$skip_childs   = true;
					$category_args[&#039;object_ids&#039;] = $post_ID;
					$categories    = get_terms($cat_taxonomy, $category_args);
				} else {
					if ( empty( $category_args[&#039;include&#039;] ) || $parent_category &gt; 0 ) {
						$category_args[&#039;parent&#039;] = $parent_category;
					}
					$categories = get_terms($cat_taxonomy, $category_args);
				}

				if ($hide_empty) {
					$categories = geodir_filter_empty_terms($categories);
				}
				if ($sort_by == &#039;count&#039;) {
					$categories = geodir_sort_terms($categories, &#039;count&#039;);
				}

				$close_wrap = false;

				if (!empty($categories)) {
					$term_icons = !$hide_icon ? geodir_get_term_icon() : array();

//					print_r($term_icons);
					$row_class = &#039;&#039;;

					if ($is_listing) {
						$row_class = $is_category ? &#039; gd-cptcat-categ&#039; : &#039; gd-cptcat-listing&#039;;
					}
					$cpt_row = &#039;&#039;;
					$open_wrap = true;
					if($design_style){
						if( empty( $args[&#039;cpt_title&#039;] ) &amp;&amp; $cpt_opened ){
							$open_wrap = false;
						}
					}

					if($open_wrap){
						$cpt_row .= &#039;&lt;div class=&quot;gd-cptcat-row gd-cptcat-&#039; . $cpt . $row_class . &#039; &#039;.$cpt_left_class.&#039;&quot;&gt;&#039;;
						$cpt_opened = true;
					}

					if ( ! empty( $args[&#039;cpt_title&#039;] ) &amp;&amp; ! $cpt_ajax ) {
						$cpt_row .= &#039;&lt;&#039; . esc_attr( $args[&#039;title_tag&#039;] ) . &#039; class=&quot;gd-cptcat-title&quot;&gt;&#039; . wp_sprintf( __( &#039;%s Categories&#039;, &#039;geodirectory&#039; ), __( $cpt_info[&#039;labels&#039;][&#039;singular_name&#039;], &#039;geodirectory&#039; ) ) . &#039;&lt;/&#039; . esc_attr( $args[&#039;title_tag&#039;] ) . &#039;&gt;&#039;;
					}

					if($design_style &amp;&amp; $open_wrap){

						$desktop_class = absint($args[&#039;row_items&#039;]) ? &quot;row-cols-md-&quot;.absint($args[&#039;row_items&#039;]) : &quot;row-cols-md-3&quot;;
						$col_class = $cpt_left ? &#039;row-cols-1&#039; : &#039;row-cols-1 row-cols-sm-2 &#039;.$desktop_class;

						// row_positioning
						if(!empty($args[&#039;row_positioning&#039;]) &amp;&amp; $args[&#039;row_positioning&#039;]==&#039;center&#039;){
							$col_class .= &quot; justify-content-center&quot;;
						}elseif(!empty($args[&#039;row_positioning&#039;]) &amp;&amp; $args[&#039;row_positioning&#039;]==&#039;right&#039;){
							$col_class .= &quot; justify-content-end&quot;;
						}

						$cpt_row .= &#039;&lt;div class=&quot;row &#039;.$col_class.&#039;&quot;&gt;&#039;;
					}

					foreach ($categories as $category) {
						$term_icon = &#039;&#039;;
						$cat_color =&#039;&#039;;

						if(!$hide_icon) {
							$term_icon_class = &#039;&#039;;
							if ( $design_style ) {
								$term_icon_class = &#039;mw-100 mh-100&#039;;
								if ( ! empty($args[&#039;design_type&#039;]) &amp;&amp; $args[&#039;design_type&#039;] == &#039;image&#039; ) {
									$term_icon_class .= &#039; embed-item-contain align-top card-img&#039;;
								}
							}
							$term_icon_class = $term_icon_class != &#039;&#039; ? &#039; class=&quot;&#039; . $term_icon_class . &#039;&quot;&#039; : &#039;&#039;;
							$term_icon_url = ! empty( $term_icons ) &amp;&amp; isset( $term_icons[ $category-&gt;term_id ] ) ? $term_icons[ $category-&gt;term_id ] : &#039;&#039;;
							$term_icon_url = $term_icon_url != &#039;&#039; ? &#039;&lt;img alt=&quot;&#039; . esc_attr( $category-&gt;name ) . &#039; icon&quot; src=&quot;&#039; . $term_icon_url . &#039;&quot; &#039; . $term_icon_class . &#039;/&gt; &#039; : &#039;&#039;;
							$cat_font_icon = get_term_meta( $category-&gt;term_id, &#039;ct_cat_font_icon&#039;, true );
							$cat_color     = get_term_meta( $category-&gt;term_id, &#039;ct_cat_color&#039;, true );
							$cat_color     = $cat_color ? $cat_color : &#039;#ababab&#039;;

							// use_image
							if($use_image){
								$term_image = get_term_meta( $category-&gt;term_id, &#039;ct_cat_default_img&#039;, true );
								if(!empty($term_image[&#039;id&#039;])){
									$cat_font_icon = false;
									$img_background_class = !empty($args[&#039;design_type&#039;]) &amp;&amp; $args[&#039;design_type&#039;]==&#039;image&#039; ? &#039; card-img&#039; : &#039;mw-100 mh-100&#039;;
									$img_args = $design_style ? array(&#039;class&#039;=&gt;&#039;embed-item-cover-xy align-top &#039;.$img_background_class) : array();
									$term_icon_url = wp_get_attachment_image( $term_image[&#039;id&#039;], $image_size, false, $img_args );
								}
							}

							$term_icon     = $cat_font_icon ? &#039;&lt;i class=&quot;&#039; . $cat_font_icon . &#039;&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&#039; : $term_icon_url;
						}

						$term_link = get_term_link( $category, $category-&gt;taxonomy );
						/** Filter documented in includes/general_functions.php **/
						$term_link = apply_filters( &#039;geodir_category_term_link&#039;, $term_link, $category-&gt;term_id, $cpt );
						$count = $category-&gt;count;

						/**
						 * Whether include child categories posts count in parent category or not.
						 *
						 * @since 2.0.0.96
						 *
						 * @param bool $child_term_count True to include child categories posts count. Default true.
						 * @param int $category-&gt;term_id Term ID.
						 * @param string $category-&gt;taxonomy Term taxonomy.
						 */
						$child_term_count = apply_filters( &#039;geodir_categories_include_child_terms_posts_count&#039;, true, $category-&gt;term_id, $category-&gt;taxonomy );

						if ( $child_term_count ) {
							$tax_terms = get_terms( $category-&gt;taxonomy, array( &#039;child_of&#039; =&gt; $category-&gt;term_id ) );
							if ( ! empty( $tax_terms ) ) {
								foreach ( $tax_terms as $tax_term ) {
									$count += $tax_term-&gt;count;
								}
							}
						}

						$count = !$hide_count ? &#039; &lt;span class=&quot;gd-cptcat-count&quot;&gt;&#039; . $count . &#039;&lt;/span&gt;&#039; : &#039;&#039;;

						$cpt_row .= $design_style ? &#039;&lt;div class=&quot;gd-cptcat-ul gd-cptcat-parent col mb-4&quot;&gt;&#039; : &#039;&lt;ul class=&quot;gd-cptcat-ul gd-cptcat-parent  &#039;.$cpt_left_class.&#039;&quot;&gt;&#039;;

						$cpt_row .= self::categories_loop_output(&#039;gd-cptcat-li-main&#039;,$hide_count,$count,$cat_color,$term_link,$category-&gt;name,$term_icon,$hide_icon,$use_image, 0, $args);

						$child_cats = &#039;&#039;;
						if (!$skip_childs &amp;&amp; ($all_childs || $max_count_child &gt; 0) &amp;&amp; ($max_level == &#039;all&#039; || (int)$max_level &gt; 0)) {
							$child_cats .= self::child_cats( $category-&gt;term_id, $cpt, $hide_empty, $hide_count, $sort_by, $max_count_child, $max_level, $term_icons, $hide_icon,$use_image, 1, $filter_terms,$args );
						}
						$cpt_row .= $child_cats;

						$cpt_row .= $design_style ? &#039;&lt;/div&gt;&#039; : &#039;&lt;/li&gt;&#039;;

						$cpt_row .= $design_style ? &#039;&lt;/div&gt;&#039; : &#039;&#039;;
						$cpt_row .= $design_style ? &#039;&lt;/div&gt;&#039; : &#039;&lt;/ul&gt;&#039;;
					}


					$close_wrap = true;
					if($design_style){
						if( $cpt_opened &amp;&amp; empty( $args[&#039;cpt_title&#039;] ) &amp;&amp; $cpt_count &lt; count($post_types)  ){
							$close_wrap = false;
						}
					}


					if($design_style &amp;&amp; $close_wrap){
						$cpt_row .= &#039;&lt;/div&gt;&#039;;
					}

					if($close_wrap){
						$cpt_row .= &#039;&lt;/div&gt;&#039;;
					}


					$cpt_list .= $cpt_row;

					// check if closed or not
					if($design_style &amp;&amp; $cpt_count == count($post_types) &amp;&amp; !$close_wrap ){
						$cpt_list .= &#039;&lt;/div&gt;&lt;/div&gt;&#039;;
					}
				} else {
					// Check if closed or not
					if ( $design_style &amp;&amp; $cpt_count == count( $post_types ) &amp;&amp; ! $close_wrap &amp;&amp; $cpt_list != &#039;&#039; ) {
						$cpt_list .= &#039;&lt;/div&gt;&lt;/div&gt;&#039;;
					}
				}
			}

			if ( !$via_ajax &amp;&amp; $cpt_ajax &amp;&amp; ! empty( $cpt_options ) ) {
				global $geodirectory;
				$post_type = is_array( $args[&#039;post_type&#039;] ) ? implode( &#039;,&#039;, $args[&#039;post_type&#039;] ) : (! empty($args[&#039;post_type&#039;]) ? $args[&#039;post_type&#039;] : &#039;0&#039;);
				$output .= &#039;&lt;div class=&quot;gd-cptcats-select&quot;&gt;&lt;div class=&quot;gd-wgt-params&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;post_type&quot; value=&quot;&#039; . esc_attr( $post_type ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;cpt_ajax&quot; value=&quot;&#039; . $cpt_ajax . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;filter_ids&quot; value=&quot;&#039; . $filter_ids . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;cpt_title&quot; value=&quot;&#039; . absint( $args[&#039;cpt_title&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;title_tag&quot; value=&quot;&#039; . $args[&#039;title_tag&#039;] . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;hide_empty&quot; value=&quot;&#039; . $hide_empty . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;hide_count&quot; value=&quot;&#039; . $hide_count . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;hide_icon&quot; value=&quot;&#039; . $hide_icon . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;cpt_left&quot; value=&quot;&#039; . $cpt_left . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;sort_by&quot; value=&quot;&#039; . $sort_by . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;max_level&quot; value=&quot;&#039; . $max_level . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;max_count&quot; value=&quot;&#039; . $max_count . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;no_cpt_filter&quot; value=&quot;&#039; . absint( $args[&#039;no_cpt_filter&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;no_cat_filter&quot; value=&quot;&#039; . absint( $args[&#039;no_cat_filter&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;ajax_is_listing&quot; value=&quot;&#039; . $is_listing . &#039;&quot;&gt;&#039;;


				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;card_color&quot; value=&quot;&#039; . esc_attr( $args[&#039;card_color&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;icon_color&quot; value=&quot;&#039; . esc_attr( $args[&#039;icon_color&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;icon_size&quot; value=&quot;&#039; . esc_attr( $args[&#039;icon_size&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;design_type&quot; value=&quot;&#039; . esc_attr( $args[&#039;design_type&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;row_items&quot; value=&quot;&#039; . absint( $args[&#039;row_items&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;row_positioning&quot; value=&quot;&#039; . esc_attr( $args[&#039;row_positioning&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;card_padding_inside&quot; value=&quot;&#039; . absint( $args[&#039;card_padding_inside&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;bg&quot; value=&quot;&#039; . esc_attr( $args[&#039;bg&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;mt&quot; value=&quot;&#039; . absint( $args[&#039;mt&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;mb&quot; value=&quot;&#039; . absint( $args[&#039;mb&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;mr&quot; value=&quot;&#039; . absint( $args[&#039;mr&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;ml&quot; value=&quot;&#039; . absint( $args[&#039;ml&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;pt&quot; value=&quot;&#039; . absint( $args[&#039;pt&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;pb&quot; value=&quot;&#039; . absint( $args[&#039;pb&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;pr&quot; value=&quot;&#039; . absint( $args[&#039;pr&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;pl&quot; value=&quot;&#039; . absint( $args[&#039;pl&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;border&quot; value=&quot;&#039; . esc_attr( $args[&#039;border&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;rounded&quot; value=&quot;&#039; . esc_attr( $args[&#039;rounded&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;rounded_size&quot; value=&quot;&#039; . esc_attr( $args[&#039;rounded_size&#039;] ) . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;shadow&quot; value=&quot;&#039; . esc_attr( $args[&#039;shadow&#039;] ) . &#039;&quot;&gt;&#039;;

				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;ajax_is_detail&quot; value=&quot;&#039; . $is_detail . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;ajax_is_category&quot; value=&quot;&#039; . $is_category . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;ajax_post_ID&quot; value=&quot;&#039; . $post_ID . &#039;&quot;&gt;&#039;;
				$output .= &#039;&lt;input type=&quot;hidden&quot; name=&quot;ajax_current_term_id&quot; value=&quot;&#039; . $current_term_id . &#039;&quot;&gt;&#039;;
				if ( ! empty( $geodirectory-&gt;location ) ) {
					foreach ( $geodirectory-&gt;location as $key =&gt; $value ) {
						if ( is_scalar( $value ) || ( ! is_object( $value ) &amp;&amp; ! is_array( $value ) ) ) {
							$output .= &#039;&lt;input type=&quot;hidden&quot; data-set-param=&quot;1&quot; name=&quot;_gd_set_loc_&#039; . esc_attr( $key ) . &#039;&quot; value=&quot;&#039; . esc_attr( $value ) . &#039;&quot;&gt;&#039;;
						}
					}
				}
				$select_class = $design_style ? &#039;form-control mb-3&#039; : &#039;&#039;;
				$output .= &#039;&lt;/div&gt;&lt;select class=&quot;geodir-cat-list-tax geodir-select &#039;.$select_class.&#039;&quot; aria-label=&quot;&#039; . esc_attr__( &#039;CPT Categories&#039;, &#039;geodirectory&#039; ) . &#039;&quot;&gt;&#039; . implode( &#039;&#039;, $cpt_options ) . &#039;&lt;/select&gt;&#039;;
				$output .= &#039;&lt;/div&gt;&lt;div class=&quot;gd-cptcat-rows&quot;&gt;&#039;;
			}
			$output .= $cpt_list;
			if ( !$via_ajax &amp;&amp; $cpt_ajax &amp;&amp; ! empty( $cpt_options ) ) {
				$output .= &#039;&lt;/div&gt;&#039;;
			}

			// Set back
			$geodirectory = $backup_geodirectory;
		}

		$gd_use_query_vars = $old_gd_use_query_vars;

		return $output;
	}

	public static function categories_loop_output( $li_class = &#039;gd-cptcat-li-main&#039;, $hide_count = false, $cat_count = &#039;&#039;, $cat_color = &#039;&#039;, $term_link = &#039;&#039;, $cat_name = &#039;&#039;, $cat_icon = false, $hide_icon = false, $use_image = false, $depth = 0, $args = array() ) {
		$cpt_row = &#039;&#039;;

		$design_style = geodir_design_style();

		if ( $design_style ) {
			$style = !empty($args[&#039;design_type&#039;]) ? esc_attr($args[&#039;design_type&#039;]) : &#039;icon-left&#039;;
			if($style==&#039;icon-left&#039;){$style = &#039;icon-left&#039;;}
			elseif($style==&#039;icon-top&#039;){$style = &#039;icon-top&#039;;}
			elseif($style==&#039;image&#039;){$style = &#039;image&#039;;}
			else{$style = &#039;icon-left&#039;;}
			$style = $depth ? &#039;sub-item&#039; : $style;

			$card_shadow = ! empty( $args[&#039;card_shadow&#039;] ) ? $args[&#039;card_shadow&#039;] : &#039;small&#039;;

			// card class
			if ( $card_shadow == &#039;none&#039; ) {
				$card_class = &#039;shadow-none&#039;;
			} else if ( $card_shadow == &#039;medium&#039; ) {
				$card_class = &#039;shadow&#039;;
			} else if ( $card_shadow == &#039;large&#039; ) {
				$card_class = &#039;shadow-lg&#039;;
			} else {
				$card_class = &#039;shadow-sm&#039;;
			}

			$template =  $design_style.&quot;/categories/$style.php&quot;;

			$cpt_row .= geodir_get_template_html( $template ,array(
				&#039;li_class&#039; =&gt;  $li_class,
				&#039;hide_count&#039;   =&gt;  $hide_count,
				&#039;cat_count&#039;    =&gt;  $cat_count,
				&#039;cat_color&#039;    =&gt;  $cat_color,
				&#039;term_link&#039;    =&gt;  $term_link,
				&#039;cat_name&#039; =&gt;  $cat_name,
				&#039;cat_icon&#039; =&gt;  $cat_icon,
				&#039;hide_icon&#039;    =&gt;  $hide_icon,
				&#039;use_image&#039;    =&gt;  $use_image,
				&#039;depth&#039;    =&gt;  $depth,
				&#039;card_class&#039; =&gt; $card_class,
				&#039;args&#039;  =&gt;  $args
			));
			
		}else{
			$cpt_row .= &#039;&lt;li class=&quot;gd-cptcat-li &#039;.$li_class.&#039;&quot;&gt;&#039;;
			$count = !$hide_count ? &#039; &lt;span class=&quot;gd-cptcat-count&quot;&gt;&#039; . $cat_count . &#039;&lt;/span&gt;&#039; : &#039;&#039;;

			if(!$hide_icon){
				$cpt_row .= &#039;&lt;span class=&quot;gd-cptcat-cat-left&quot; style=&quot;background: &#039;.$cat_color.&#039;;&quot;&gt;&lt;a href=&quot;&#039; . esc_url($term_link) . &#039;&quot; title=&quot;&#039; . esc_attr($cat_name) . &#039;&quot;&gt;&#039;;
				$cpt_row .= &quot;&lt;span class=&#039;gd-cptcat-icon&#039; &gt;$cat_icon&lt;/span&gt;&quot;;
				$cpt_row .= &#039;&lt;/a&gt;&lt;/span&gt;&#039;;
			}


			$cpt_row .= &#039;&lt;span class=&quot;gd-cptcat-cat-right&quot;&gt;&lt;a href=&quot;&#039; . esc_url($term_link) . &#039;&quot; title=&quot;&#039; . esc_attr($cat_name) . &#039;&quot;&gt;&#039;;
			$cpt_row .= $cat_name . $count . &#039;&lt;/a&gt;&lt;/span&gt;&#039;;
		}



		return $cpt_row;
	}

	/**
	 * Get the child categories content.
	 *
	 * @since 1.5.4
	 * @since 2.0.0.86 New parameter $filter_terms added.
	 *
	 * @param int $parent_id Parent category id.
	 * @param string $cpt The post type.
	 * @param bool $hide_empty If true then filter the empty categories.
	 * @param bool $show_count If true then category count will be displayed.
	 * @param string $sort_by Sorting order for categories.
	 * @param bool|string $max_count Max no of sub-categories count to display.
	 * @param bool|string $max_level Max depth level sub-categories to display.
	 * @param array $term_icons Array of terms icons url.
	 * @param int $depth Category depth level. Default 1.
	 * @param array $filter_terms Array of terms to include/exclude.
	 * @return string Html content.
	 */
	public static function child_cats( $parent_id, $cpt, $hide_empty, $hide_count, $sort_by, $max_count, $max_level, $term_icons,$hide_icon, $use_image, $depth = 1, $filter_terms = array(), $args = array() ) {
		$cat_taxonomy = $cpt . &#039;category&#039;;
		$image_size = ! empty( $args[&#039;image_size&#039;] ) ? $args[&#039;image_size&#039;] : &#039;medium&#039;;

		$orderby = &#039;count&#039;;
		$order = &#039;DESC&#039;;
		if ($sort_by == &#039;az&#039;) {
			$orderby = &#039;name&#039;;
			$order = &#039;ASC&#039;;
		}

		if ($max_level != &#039;all&#039; &amp;&amp; $depth &gt; (int)$max_level ) {
			return &#039;&#039;;
		}

		$term_args = array( &#039;orderby&#039; =&gt; $orderby, &#039;order&#039; =&gt; $order, &#039;hide_empty&#039; =&gt; $hide_empty, &#039;parent&#039; =&gt; $parent_id, &#039;number&#039; =&gt; $max_count );
		// Include terms
		if ( ! empty( $filter_terms[&#039;include&#039;] ) &amp;&amp; empty( $parent_id ) ) {
			$term_args[&#039;include&#039;] = $filter_terms[&#039;include&#039;];
		}

		// Exclude terms
		if ( ! empty( $filter_terms[&#039;exclude&#039;] ) ) {
			$term_args[&#039;exclude&#039;] = $filter_terms[&#039;exclude&#039;];
		}

		$child_cats = get_terms( $cat_taxonomy, $term_args );
		if ( $hide_empty ) {
			$child_cats = geodir_filter_empty_terms( $child_cats );
		}

		if (empty($child_cats)) {
			return &#039;&#039;;
		}

		if ($sort_by == &#039;count&#039;) {
			$child_cats = geodir_sort_terms($child_cats, &#039;count&#039;);
		}

		$design_style = geodir_design_style();

		if($design_style ){
			$link_height = !empty($args[&#039;card_padding_inside&#039;]) &amp;&amp; $args[&#039;card_padding_inside&#039;] &lt; 3 ? &quot;15px&quot; : &quot;22px&quot;;
			$content = $depth == 1 ? &#039;&lt;div class=&quot;gd-cptcat-li gd-cptcat-li-sub-container dropdown w-100 position-absolute&quot; style=&quot;bottom: 0;left: 0;height:&#039;.$link_height.&#039;;&quot;&gt;&#039; : &#039;&#039;;
			$content .= $depth == 1 ? &#039;&lt;a class=&quot;btn btn-link z-index-1 p-0 text-reset w-100 align-top&quot; href=&quot;#&quot; id=&quot;cat-submenu-&#039;.$parent_id.&#039;&quot; data-toggle=&quot;dropdown&quot; aria-haspopup=&quot;true&quot; aria-expanded=&quot;false&quot; aria-label&gt;&lt;span class=&quot;sr-only&quot;&gt;&#039; . __( &quot;Expand sub-categories&quot;, &quot;geodirectory&quot; ) . &#039;&lt;/span&gt;&lt;i class=&quot;fas fa-chevron-down align-top&quot;&gt;&lt;/i&gt;&lt;/a&gt;&#039; : &#039;&#039;;
			$content .= $depth == 1 ? &#039;&lt;ul class=&quot;p-0 mt-1 gd-cptcat-ul gd-cptcat-sub gd-cptcat-sub-&#039; . $depth . &#039;  dropdown-menu dropdown-caret-0&quot; aria-labelledby=&quot;cat-submenu-&#039;.$parent_id.&#039;&quot;&gt;&#039; : &#039;&#039;;
		}else{
			$content = &#039;&lt;li class=&quot;gd-cptcat-li gd-cptcat-li-sub-container&quot;&gt;&lt;ul class=&quot;gd-cptcat-ul gd-cptcat-sub gd-cptcat-sub-&#039; . $depth . &#039;&quot;&gt;&#039;;
		}


		$depth++;
		foreach ($child_cats as $category) {
			$term_icon_url = !empty($term_icons) &amp;&amp; isset($term_icons[$category-&gt;term_id]) ? $term_icons[$category-&gt;term_id] : &#039;&#039;;
			$term_icon_url = $term_icon_url != &#039;&#039; ? &#039;&lt;img alt=&quot;&#039; . esc_attr($category-&gt;name) . &#039; icon&quot; src=&quot;&#039; . $term_icon_url . &#039;&quot; /&gt; &#039; : &#039;&#039;;
			$cat_font_icon = get_term_meta( $category-&gt;term_id, &#039;ct_cat_font_icon&#039;, true );
			$cat_color = get_term_meta( $category-&gt;term_id, &#039;ct_cat_color&#039;, true );
			$cat_color = $cat_color ? $cat_color : &#039;#ababab&#039;;

			// use_image
			if($use_image){
				$term_image = get_term_meta( $category-&gt;term_id, &#039;ct_cat_default_img&#039;, true );
				if(!empty($term_image[&#039;id&#039;])){
					$cat_font_icon = false;
					$term_icon_url = wp_get_attachment_image( $term_image[&#039;id&#039;], $image_size );
				}
			}

			$term_icon = $cat_font_icon ? &#039;&lt;i class=&quot;fas &#039;.$cat_font_icon.&#039;&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt;&#039; : $term_icon_url;
			$term_link = get_term_link( $category, $category-&gt;taxonomy );
			/** Filter documented in includes/general_functions.php **/
			$term_link = apply_filters( &#039;geodir_category_term_link&#039;, $term_link, $category-&gt;term_id, $cpt );
			$count = !$hide_count ? &#039; &lt;span class=&quot;gd-cptcat-count&quot;&gt;&#039; . $category-&gt;count . &#039;&lt;/span&gt;&#039; : &#039;&#039;;

			$content .= self::categories_loop_output(&#039;gd-cptcat-li-sub&#039;,$hide_count,$count,$cat_color,$term_link,$category-&gt;name,$term_icon,$hide_icon,$use_image,$depth, $args);

			$content .= self::child_cats( $category-&gt;term_id, $cpt, $hide_empty, $hide_count, $sort_by, $max_count, $max_level, $term_icons,$hide_icon,$use_image, $depth, $filter_terms,$args );
		}

		if($design_style ){
			$content .= $depth == 2 ? &#039;&lt;/ul&gt;&#039; : &#039;&#039;;
			$content .= $depth == 2 ? &#039;&lt;/div&gt;&#039; : &#039;&#039;;
		}else{
			$content .= &#039;&lt;/li&gt;&#039;;
			$content .= &#039;&lt;/ul&gt;&#039;;
		}


		return $content;
	}

	/**
	 * Get images sizes.
	 *
	 * @since 2.1.0.12
	 *
	 * @return array Image sizes.
	 */
	public static function get_image_sizes() {
		$image_sizes = array( 
			&#039;&#039; =&gt; &#039;default (medium)&#039;
		);

		$sizes = get_intermediate_image_sizes();

		if ( ! empty( $sizes ) ) {
			foreach( $sizes as $size ) {
				$image_sizes[ $size ] = $size;
			}
		}

		$image_sizes[&#039;full&#039;] = &#039;full&#039;;

		return $image_sizes;
	}
}</code></pre>
            </article>
            </div>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <footer class="phpdocumentor phpdocumentor-footer">
    <div class="phpdocumentor-section">
        <span>Geodirectory Code Reference API documentation generated by <a href="http://www.phpdoc.org/">phpDocumentor</a> on May 12th, 2022 at 06:15 am.</span>
    </div>
</footer>

    <script>
        cssVars({});
    </script>
    <script>
        var searchParams = {
            'searchIndex': '..\/js\/searchIndex.json'
        };
    </script>
    <script src="../js/searchIndex.js?updated=1652336159"></script>
    <script src="../js/search.js?updated=1652336159"></script>
</body>
</html>
