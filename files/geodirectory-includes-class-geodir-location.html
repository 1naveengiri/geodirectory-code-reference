<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Geodirectory Code Reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/favicon.png" />
    <link rel="apple-touch-icon" href="../images/apple-touch-icon.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-touch-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-touch-icon-114x114.png"/>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/base.css?updated=1652334990">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/template.css?updated=1652334990">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
            <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/js/all.min.js" integrity="sha256-0vuk8LXoyrmCjp1f0O300qo1M75ZQyhH9X3J6d+scmk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8KCYZ2CYMS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8KCYZ2CYMS', {
		'content_group' : 'WooCommerce Core Code Reference',
	});
</script>
        <script src="../js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-top-header">
    <section class="phpdocumentor-section">
        <div class="site-branding">
            <a class="site-logo" href="../index.html"><img width="180" src="../images/logo.svg" alt="WooCommerce" /></a>
        </div>
        <nav class="main-navigation">
            <ul>
                <li><a href="../hooks/hooks.html">Hooks Reference</a></li>
                <li><a href="https://docs.woocommerce.com/">Documentation</a></li>
                <li><a href="https://woocommerce.github.io/woocommerce-rest-api-docs/">REST API Docs</a></li>
                <li><a href="https://woocommerce.com/careers/?utm_source=woocommerce+core+code+reference&utm_medium=devdocs&utm_campaign=woo+careers" target="_blank">We're hiring!</a></li>
            </ul>
        </nav>
    </section>
</header>

<div class="phpdocumentor-header">
    <section class="phpdocumentor-section">
        <h1 class="phpdocumentor-title">Geodirectory Code Reference</h1>
        <section class="phpdocumentor-search">
    <label class="phpdocumentor-label">
        <span class="visually-hidden">Search (click ESC to close search results)</span>
        <input id="autoComplete" tabindex="1" type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading..." disabled />
    </label>
</section>

    </section>
</div>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <aside class="phpdocumentor-column -four phpdocumentor-sidebar">
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/elementorpro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/elementorpro-modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/Geodirectory.html"><abbr title="\Geodirectory">Geodirectory</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectory.html"><abbr title="\GeoDirectory">GeoDirectory</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/GeoDirectory-Templates.html"><abbr title="\GeoDirectory\Templates">Templates</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAbstracts.html"><abbr title="\GeoDirectoryAbstracts">GeoDirectoryAbstracts</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAPI.html"><abbr title="\GeoDirectoryAPI">GeoDirectoryAPI</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClasses.html"><abbr title="\GeoDirectoryClasses">GeoDirectoryClasses</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminFunctions.html"><abbr title="\GeoDirectoryAdminFunctions">GeoDirectoryAdminFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoruAdmin.html"><abbr title="\GeoDirectoruAdmin">GeoDirectoruAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdmin.html"><abbr title="\GeoDirectoryAdmin">GeoDirectoryAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirAdmin.html"><abbr title="\GeoDirAdmin">GeoDirAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectroyAdmin.html"><abbr title="\GeoDirectroyAdmin">GeoDirectroyAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminSystemStatus.html"><abbr title="\GeoDirectoryAdminSystemStatus">GeoDirectoryAdminSystemStatus</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminTools.html"><abbr title="\GeoDirectoryAdminTools">GeoDirectoryAdminTools</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminWidgets.html"><abbr title="\GeoDirectoryAdminWidgets">GeoDirectoryAdminWidgets</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesEmails.html"><abbr title="\GeoDirectoryClassesEmails">GeoDirectoryClassesEmails</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesData.html"><abbr title="\GeoDirectoryClassesData">GeoDirectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDIrectoryClassesData.html"><abbr title="\GeoDIrectoryClassesData">GeoDIrectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/ElementorPro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/ElementorPro-Modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryFunctions.html"><abbr title="\GeoDirectoryFunctions">GeoDirectoryFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryparamarraytermsAnarrayoftermobjects.html"><abbr title="\GeoDirectoryparamarraytermsAnarrayoftermobjects">GeoDirectoryparamarraytermsAnarrayoftermobjects</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WP.html"><abbr title="\WP">WP</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/WP-Background.html"><abbr title="\WP\Background">Background</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryTemplates.html"><abbr title="\GeoDirectoryTemplates">GeoDirectoryTemplates</abbr></a></h3>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../hooks/hooks.html">Hooks Reference</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">class-geodir-location.php</h2>

                

        
                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php

if ( ! defined( &#039;ABSPATH&#039; ) ) {
	exit;
}

/**
 * GeoDirectory GeoDir_Location.
 *
 * Locations functions.
 *
 * @class    GeoDir_Location
 * @package  GeoDirectory/Classes
 * @category Class
 * @author   AyeCode
 */
class GeoDir_Location {

	public $country;
	public $country_slug;
	public $country_iso2;
	public $country_iso3;
	public $region;
	public $region_slug;
	public $city;
	public $city_slug;
	public $latitude;
	public $longitude;
	public $type;
	public $is_default;
	public $id;



	public function __construct( $data = array()) {

		if(empty($data)){
			//$this-&gt;set_current();
			add_action( &#039;wp&#039;, array( $this, &#039;set_current&#039; ), 0 );
			add_action( &#039;geodir_settings_save_general&#039;, array( $this, &#039;clear_cache&#039; ));

		}

		add_action( &#039;geodir_address_extra_listing_fields&#039;, array( $this, &#039;set_multi_city&#039; ), 1, 1 );
	}

	public function clear_cache(){
		wp_cache_delete(&quot;geodir_get_default_location&quot;);
	}

	public function set_current(){
		$location = new stdClass();
		$location-&gt;city = geodir_get_option(&#039;default_location_city&#039;);
		$location-&gt;region = geodir_get_option(&#039;default_location_region&#039;);
		$location-&gt;country = geodir_get_option(&#039;default_location_country&#039;);
		$location-&gt;latitude = geodir_get_option(&#039;default_location_latitude&#039;);
		$location-&gt;longitude = geodir_get_option(&#039;default_location_longitude&#039;);

		// slugs
		$location-&gt;city_slug = urldecode( sanitize_title( $location-&gt;city ) );
		$location-&gt;region_slug = urldecode( sanitize_title( $location-&gt;region ) );
		$location-&gt;country_slug = urldecode( sanitize_title( $location-&gt;country ) );

		// id
		$location-&gt;id = 0;

		// type
		$location-&gt;type = &#039;city&#039;;

		// is_default
		$location-&gt;is_default = 1;
		
		
		// set search values
		if(isset($_REQUEST[&#039;geodir_search&#039;]) &amp;&amp; $_REQUEST[&#039;geodir_search&#039;] &amp;&amp; geodir_is_page(&#039;search&#039;)){
			$location-&gt;city = &#039;&#039;;
			$location-&gt;region = &#039;&#039;;
			$location-&gt;country = &#039;&#039;;
			$location-&gt;latitude = &#039;&#039;;
			$location-&gt;longitude = &#039;&#039;;
			$location-&gt;city_slug = &#039;&#039;;
			$location-&gt;region_slug = &#039;&#039;;
			$location-&gt;country_slug = &#039;&#039;;
			$location-&gt;id = 0;
			$location-&gt;type = &#039;search&#039;;
			$location-&gt;is_default = 0;

			// set GPS
			$latlon = $this-&gt;get_latlon();
			if(!empty($latlon[&#039;lat&#039;])){$location-&gt;latitude = $latlon[&#039;lat&#039;];}
			if(!empty($latlon[&#039;lon&#039;])){$location-&gt;longitude = $latlon[&#039;lon&#039;];}
		}
		

		/**
		 * Filter the default location.
		 *
		 * @since 1.0.0
		 * @package GeoDirectory
		 *
		 * @param string $location_result The default location object.
		 */
		$location_result = apply_filters(&#039;geodir_set_current_location&#039;, $location );

		$this-&gt;country_slug = $location_result-&gt;country_slug;
		$this-&gt;country = $location_result-&gt;country;
		$this-&gt;region_slug = $location_result-&gt;region_slug;
		$this-&gt;region = $location_result-&gt;region;
		$this-&gt;city_slug  = $location_result-&gt;city_slug ;
		$this-&gt;city = $location_result-&gt;city;
		$this-&gt;latitude = $location_result-&gt;latitude;
		$this-&gt;longitude = $location_result-&gt;longitude;
		$this-&gt;type = $location_result-&gt;type;
		$this-&gt;is_default = $location_result-&gt;is_default;
		$this-&gt;id = $location_result-&gt;id;
		
	}

	/**
	 * Returns the default location.
	 *
	 * @since 1.0.0
	 * @package GeoDirectory
	 * @return object
	 */
	public function get_default_location()
	{

		// check cache
		$cache = wp_cache_get(&quot;geodir_get_default_location&quot;);
		if($cache !== false){
			return $cache;
		}

		$location = new stdClass();
		$location-&gt;city = geodir_get_option(&#039;default_location_city&#039;);
		$location-&gt;region = geodir_get_option(&#039;default_location_region&#039;);
		$location-&gt;country = geodir_get_option(&#039;default_location_country&#039;);
		$location-&gt;latitude = geodir_get_option(&#039;default_location_latitude&#039;);
		$location-&gt;longitude = geodir_get_option(&#039;default_location_longitude&#039;);

		// slugs
		$location-&gt;city_slug = sanitize_title($location-&gt;city);
		$location-&gt;region_slug = sanitize_title($location-&gt;region);
		$location-&gt;country_slug = sanitize_title($location-&gt;country);

		/**
		 * Filter the default location.
		 *
		 * @since 1.0.0
		 * @package GeoDirectory
		 *
		 * @param string $location_result The default location object.
		 */
		$location_result = apply_filters(&#039;geodir_get_default_location&#039;, $location );

		wp_cache_set(&quot;geodir_get_default_location&quot;, $location_result );


		return $location_result;
	}


	public function get_country_name_from_slug($slug){
		return geodir_get_option(&#039;default_location_country&#039;);
	}

	public function get_region_name_from_slug($slug){
		return geodir_get_option(&#039;default_location_region&#039;);
	}

	public function get_city_name_from_slug($slug){
		return geodir_get_option(&#039;default_location_city&#039;);
	}

	public function get_post_location( $gd_post ) {
		if ( geodir_core_multi_city() ) {
			return $this-&gt;multi_city_location( $gd_post );
		}

		return $this-&gt;get_default_location();
	}


	/**
	 * Returns location slug using location string.
	 *
	 * @since 1.0.0
	 * @package GeoDirectory
	 * @param string $location_string The location string.
	 * @return string The location slug.
	 */
	public function create_location_slug($location_string)
	{

		/**
		 * Filter the location slug.
		 *
		 * @since 1.0.0
		 * @package GeoDirectory
		 *
		 * @param string $location_string Sanitized location string.
		 */
		return urldecode(apply_filters(&#039;geodir_location_slug_check&#039;, sanitize_title($location_string)));
	}

	/**
	 * Checks whether the default location is set or not.
	 *
	 * @since 1.0.0
	 * @package GeoDirectory
	 * @return bool
	 */
	public function is_default_location_set()
	{
		$default_location = $this-&gt;get_default_location();
		if (!empty($default_location))
			return true;
		else
			return false;
	}

	/**
	 * Get ISO2 of the country.
	 *
	 * @since 1.6.16
	 * @package GeoDirectory
	 * @param string $country The country name.
	 * @return string Country ISO2 code.
	 */
	function get_country_iso2($country) {
		global $wp_country_database;

		if ($result = $wp_country_database-&gt;get_country_iso2($country)) {
			return $result;
		}

		return $country;
	}

	/**
	 * Get ISO2 of the country.
	 *
	 * @since 1.6.16
	 * @package GeoDirectory
	 * @param string $country The country name.
	 * @return string Country ISO2 code.
	 */
	function get_country_iso3($country) {
		global $wp_country_database;

		if ($result = $wp_country_database-&gt;get_country_iso3($country)) {
			return $result;
		}

		return $country;
	}


	/**
	 * Get the lat and lon from the query var
	 *
	 * @return array
	 */
	public function get_latlon(){
		global $wp;
		$latlon = array();
		if(!empty($wp-&gt;query_vars[&#039;latlon&#039;])){
			$gps = explode(&quot;,&quot;,$wp-&gt;query_vars[&#039;latlon&#039;]);
			$latlon[&#039;lat&#039;] = isset($gps[0]) ? filter_var($gps[0], FILTER_SANITIZE_NUMBER_FLOAT, FILTER_FLAG_ALLOW_FRACTION) : &#039;&#039;;
			$latlon[&#039;lon&#039;] = isset($gps[1]) ? filter_var($gps[1], FILTER_SANITIZE_NUMBER_FLOAT, FILTER_FLAG_ALLOW_FRACTION) : &#039;&#039;;
		}elseif( !empty($_REQUEST[&#039;sgeo_lat&#039;]) &amp;&amp; !empty($_REQUEST[&#039;sgeo_lon&#039;])){
			$latlon[&#039;lat&#039;] = isset($_REQUEST[&#039;sgeo_lat&#039;]) ? filter_var($_REQUEST[&#039;sgeo_lat&#039;], FILTER_SANITIZE_NUMBER_FLOAT, FILTER_FLAG_ALLOW_FRACTION) : &#039;&#039;;
			$latlon[&#039;lon&#039;] = isset($_REQUEST[&#039;sgeo_lon&#039;]) ? filter_var($_REQUEST[&#039;sgeo_lon&#039;], FILTER_SANITIZE_NUMBER_FLOAT, FILTER_FLAG_ALLOW_FRACTION) : &#039;&#039;;
		}
		return $latlon;
	}


	/**
	 * An array of the used location vars.
	 *
	 * These are used in the where queries.
	 *
	 * @return array
	 */
	public function allowed_query_variables(){
		return array(&#039;country&#039;,&#039;region&#039;,&#039;city&#039;);
	}

	public function is_type_gps() {
		$gps_type = false;

		if ( $this-&gt;type &amp;&amp; in_array( $this-&gt;type, array( &#039;gps&#039;, &#039;me&#039;, &#039;search&#039; ) ) &amp;&amp; ! empty( $this-&gt;get_latlon() ) ) {
			$gps_type = true;
		}

		return $gps_type;
	}

	/**
	 * This is used to put country, region &amp; city fields on add/edit listing page.
	 *
	 * @since 2.1.0.7
	 *
	 * @global object $gd_post The post object.
	 *
	 * @param array $field The array of setting for the custom field.
	 */
	public function set_multi_city( $field ) {
		global $gd_post, $geodir_label_type;

		if ( ! geodir_core_multi_city() ) {
			return;
		}

		$location = $this-&gt;get_default_location();
		$name = $field[&#039;name&#039;];
		$prefix = $name . &#039;_&#039;;
		$is_required = true;

		if ( ! empty( $gd_post-&gt;country ) ) {
			$country = $gd_post-&gt;country;
		}  else if ( ! empty( $location-&gt;country ) ) {
			$country = $location-&gt;country;
		} else {
			$country = &#039;&#039;;
		}

		if ( ! empty( $gd_post-&gt;region ) ) {
			$region = $gd_post-&gt;region;
		}  else if ( ! empty( $location-&gt;region ) ) {
			$region = $location-&gt;region;
		} else {
			$region = &#039;&#039;;
		}

		if ( ! empty( $gd_post-&gt;city ) ) {
			$city = $gd_post-&gt;city;
		} else if ( ! empty( $location-&gt;city ) ) {
			$city = $location-&gt;city;
		} else {
			$city = &#039;&#039;;
		}

		$design_style = geodir_design_style();

		if ( $design_style ) {
			$required = ! empty( $is_required ) ? &#039; &lt;span class=&quot;text-danger&quot;&gt;*&lt;/span&gt;&#039; : &#039;&#039;;

			// Country
			echo aui()-&gt;select( array(
				&#039;id&#039;               =&gt; $prefix . &quot;country&quot;,
				&#039;name&#039;             =&gt; &quot;country&quot;,
				&#039;placeholder&#039;      =&gt; esc_attr__( &#039;Choose a country&amp;hellip;&#039;, &#039;geodirectory&#039; ),
				&#039;value&#039;            =&gt; esc_attr( stripslashes( $country ) ),
				&#039;required&#039;         =&gt; $is_required,
				&#039;label&#039;            =&gt; esc_attr__( &#039;Country&#039;, &#039;geodirectory&#039; ) . $required,
				&#039;label_type&#039;       =&gt; ! empty( $geodir_label_type ) ? $geodir_label_type : &#039;horizontal&#039;,
				&#039;help_text&#039;        =&gt; __( &#039;Click on above field and type to filter list.&#039;, &#039;geodirectory&#039; ),
				&#039;options&#039;          =&gt; geodir_get_country_dl( $country, $prefix ),
				&#039;extra_attributes&#039; =&gt; array(
					&#039;data-address-type&#039; =&gt; &#039;country&#039;,
					&#039;field_type&#039;        =&gt; $field[&#039;type&#039;]
				),
				&#039;wrap_attributes&#039; =&gt; geodir_conditional_field_attrs( $field, &#039;country&#039;, &#039;select&#039; )
			) );

			// Region
			echo aui()-&gt;input( array(
				&#039;type&#039;             =&gt; &#039;text&#039;,
				&#039;id&#039;               =&gt; $prefix . &quot;region&quot;,
				&#039;name&#039;             =&gt; &quot;region&quot;,
				&#039;value&#039;            =&gt; esc_attr( stripslashes( $region ) ),
				&#039;required&#039;         =&gt; $is_required,
				&#039;label_show&#039;       =&gt; true,
				&#039;label&#039;            =&gt; esc_attr__( &#039;Region&#039;, &#039;geodirectory&#039; ) . $required,
				&#039;label_type&#039;       =&gt; ! empty( $geodir_label_type ) ? $geodir_label_type : &#039;horizontal&#039;,
				&#039;placeholder&#039;      =&gt; ( ! empty( $location-&gt;region ) ? esc_attr( stripslashes( $location-&gt;region ) ) : &#039;&#039; ),
				&#039;help_text&#039;        =&gt; __( &#039;Enter listing region.&#039;, &#039;geodirectory&#039; ),
				&#039;extra_attributes&#039; =&gt; array(
					&#039;data-address-type&#039; =&gt; &#039;region&#039;,
					&#039;field_type&#039;        =&gt; &#039;text&#039;,
					&#039;data-tags&#039;         =&gt; &quot;false&quot;
				),
				&#039;wrap_attributes&#039; =&gt; geodir_conditional_field_attrs( $field, &#039;region&#039;, &#039;select&#039; )
			) );

			// City
			echo aui()-&gt;input( array(
				&#039;type&#039;             =&gt; &#039;text&#039;,
				&#039;id&#039;               =&gt; $prefix . &quot;city&quot;,
				&#039;name&#039;             =&gt; &quot;city&quot;,
				&#039;value&#039;            =&gt; esc_attr( stripslashes( $city ) ),
				&#039;required&#039;         =&gt; $is_required,
				&#039;label_show&#039;       =&gt; true,
				&#039;label&#039;            =&gt; esc_attr__( &#039;City&#039;, &#039;geodirectory&#039; ) . $required,
				&#039;label_type&#039;       =&gt; ! empty( $geodir_label_type ) ? $geodir_label_type : &#039;horizontal&#039;,
				&#039;placeholder&#039;      =&gt; ( ! empty( $location-&gt;city ) ? esc_attr( stripslashes( $location-&gt;city ) ) : &#039;&#039; ),
				&#039;help_text&#039;        =&gt; __( &#039;Enter listing city.&#039;, &#039;geodirectory&#039; ),
				&#039;extra_attributes&#039; =&gt; array(
					&#039;data-address-type&#039; =&gt; &#039;city&#039;,
					&#039;field_type&#039;        =&gt; &#039;text&#039;,
					&#039;data-tags&#039;         =&gt; &quot;false&quot;
				),
				&#039;wrap_attributes&#039; =&gt; geodir_conditional_field_attrs( $field, &#039;city&#039;, &#039;select&#039; )
			) );
		} else {
			?&gt;
			&lt;div id=&quot;geodir_&lt;?php echo $prefix . &#039;country&#039;; ?&gt;_row&quot;
				 class=&quot;geodir_form_row clearfix gd-fieldset-details geodir-address-row-multi&lt;?php echo ( $is_required ? &#039; required_field&#039; : &#039;&#039; ); ?&gt;&quot;&gt;
				&lt;label for=&quot;&lt;?php echo $prefix ?&gt;country&quot;&gt;&lt;?php echo esc_attr__( &#039;Country&#039;, &#039;geodirectory&#039; ) . ( $is_required ? &#039; &lt;span&gt;*&lt;/span&gt;&#039; : &#039;&#039; ); ?&gt;&lt;/label&gt;
				&lt;select id=&quot;&lt;?php echo $prefix ?&gt;country&quot; name=&quot;country&quot; data-placeholder=&quot;&lt;?php esc_attr_e( &#039;Choose a country&amp;hellip;&#039;, &#039;geodirectory&#039; ); ?&gt;&quot; class=&quot;geodir_textfield textfield_x geodir-select&quot; field_type=&quot;&lt;?php echo $field[&#039;type&#039;]; ?&gt;&quot; data-address-type=&quot;country&quot;&gt;
					&lt;?php echo geodir_get_country_dl( $country, $prefix ); ?&gt;
				&lt;/select&gt;
				&lt;span
					class=&quot;geodir_message_note&quot;&gt;&lt;?php _e( &#039;Click on above field and type to filter list.&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/span&gt;
				&lt;?php if ( $is_required ) { ?&gt;
					&lt;span class=&quot;geodir_message_error&quot;&gt;&lt;?php _e( &#039;Listing country is required.&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/span&gt;
				&lt;?php } ?&gt;
			&lt;/div&gt;
			&lt;div id=&quot;geodir_&lt;?php echo $prefix . &#039;region&#039;; ?&gt;_row&quot;
				 class=&quot;geodir_form_row clearfix gd-fieldset-details geodir-address-row-multi&lt;?php echo ( $is_required ? &#039; required_field&#039; : &#039;&#039; ); ?&gt;&quot;&gt;
				&lt;label for=&quot;&lt;?php echo $prefix ?&gt;region&quot;&gt;&lt;?php echo esc_attr__( &#039;Region&#039;, &#039;geodirectory&#039; ) . ( $is_required ? &#039; &lt;span&gt;*&lt;/span&gt;&#039; : &#039;&#039; ); ?&gt;&lt;/label&gt;
				&lt;input type=&quot;text&quot; id=&quot;&lt;?php echo $prefix ?&gt;region&quot; name=&quot;region&quot; value=&quot;&lt;?php echo esc_attr( stripslashes( $region ) ); ?&gt;&quot; placeholder=&quot;&lt;?php echo ( ! empty( $location-&gt;region ) ? esc_attr( stripslashes( $location-&gt;region ) ) : &#039;&#039; ); ?&gt;&quot; class=&quot;geodir_textfield textfield_x&quot; field_type=&quot;text&quot; data-address-type=&quot;region&quot; /&gt;
				&lt;span class=&quot;geodir_message_note&quot;&gt;&lt;?php _e( &#039;Enter listing region.&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/span&gt;
				&lt;?php if ( $is_required ) { ?&gt;
					&lt;span class=&quot;geodir_message_error&quot;&gt;&lt;?php _e( &#039;Listing region is required.&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/span&gt;
				&lt;?php } ?&gt;
			&lt;/div&gt;
			&lt;div id=&quot;geodir_&lt;?php echo $prefix . &#039;city&#039;; ?&gt;_row&quot;
				 class=&quot;geodir_form_row clearfix gd-fieldset-details geodir-address-row-multi&lt;?php echo ( $is_required ? &#039; required_field&#039; : &#039;&#039; ); ?&gt;&quot;&gt;
				&lt;label for=&quot;&lt;?php echo $prefix ?&gt;city&quot;&gt;&lt;?php echo esc_attr__( &#039;City&#039;, &#039;geodirectory&#039; ) . ( $is_required ? &#039; &lt;span&gt;*&lt;/span&gt;&#039; : &#039;&#039; ); ?&gt;&lt;/label&gt;
				&lt;input type=&quot;text&quot; id=&quot;&lt;?php echo $prefix ?&gt;city&quot; name=&quot;city&quot; value=&quot;&lt;?php echo esc_attr( stripslashes( $city ) ); ?&gt;&quot; placeholder=&quot;&lt;?php echo ( ! empty( $location-&gt;city ) ? esc_attr( stripslashes( $location-&gt;city ) ) : &#039;&#039; ); ?&gt;&quot; class=&quot;geodir_textfield textfield_x&quot; field_type=&quot;text&quot; data-address-type=&quot;city&quot; /&gt;
				&lt;span class=&quot;geodir_message_note&quot;&gt;&lt;?php _e( &#039;Enter listing city.&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/span&gt;
				&lt;?php if ( $is_required ) { ?&gt;
					&lt;span class=&quot;geodir_message_error&quot;&gt;&lt;?php _e( &#039;Listing city is required.&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/span&gt;
				&lt;?php } ?&gt;
			&lt;/div&gt;
			&lt;?php
		}
	}

	/**
	 * Set post location.
	 *
	 * @since 2.1.0.7
	 *
	 * @param  object $gd_post The post object.
	 * @return object Post location object.
	 */
	public function multi_city_location( $gd_post ) {
		$location = new stdClass();

		// Names
		$location-&gt;city = ! empty( $gd_post-&gt;city ) ? stripslashes( $gd_post-&gt;city ) : &#039;&#039;;
		$location-&gt;region = ! empty( $gd_post-&gt;region ) ? stripslashes( $gd_post-&gt;region ) : &#039;&#039;;
		$location-&gt;country = ! empty( $gd_post-&gt;country ) ? stripslashes( $gd_post-&gt;country ) : &#039;&#039;;

		// Slugs
		$location-&gt;city_slug = $location-&gt;city ? sanitize_title( $location-&gt;city ) : &#039;&#039;;
		$location-&gt;region_slug = $location-&gt;region ? sanitize_title( $location-&gt;region ) : &#039;&#039;;
		$location-&gt;country_slug = $location-&gt;country ? sanitize_title( $location-&gt;country ) : &#039;&#039;;

		// GPS
		$location-&gt;latitude = ! empty( $gd_post-&gt;latitude ) ? $gd_post-&gt;latitude : &#039;&#039;;
		$location-&gt;longitude = ! empty( $gd_post-&gt;longitude ) ? $gd_post-&gt;longitude : &#039;&#039;;

		return $location;
	}
}
</code></pre>
            </article>
            </div>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <footer class="phpdocumentor phpdocumentor-footer">
    <div class="phpdocumentor-section">
        <span>Geodirectory Code Reference API documentation generated by <a href="http://www.phpdoc.org/">phpDocumentor</a> on May 12th, 2022 at 05:56 am.</span>
    </div>
</footer>

    <script>
        cssVars({});
    </script>
    <script>
        var searchParams = {
            'searchIndex': '..\/js\/searchIndex.json'
        };
    </script>
    <script src="../js/searchIndex.js?updated=1652334990"></script>
    <script src="../js/search.js?updated=1652334990"></script>
</body>
</html>
