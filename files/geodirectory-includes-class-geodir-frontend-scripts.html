<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Geodirectory Code Reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/favicon.png" />
    <link rel="apple-touch-icon" href="../images/apple-touch-icon.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-touch-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-touch-icon-114x114.png"/>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/base.css?updated=1652336886">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/template.css?updated=1652336886">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
            <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/js/all.min.js" integrity="sha256-0vuk8LXoyrmCjp1f0O300qo1M75ZQyhH9X3J6d+scmk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8KCYZ2CYMS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8KCYZ2CYMS', {
		'content_group' : 'WooCommerce Core Code Reference',
	});
</script>
        <script src="../js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-top-header">
    <section class="phpdocumentor-section">
        <div class="site-branding">
            <a class="site-logo" href="../index.html"><img width="180" src="../images/logo.png" alt="WPGeodirectory" /></a>
        </div>
        <nav class="main-navigation">
            <ul>
                <li><a href="../hooks/hooks.html">Hooks Reference</a></li>
                <li><a href="https://docs.woocommerce.com/">Documentation</a></li>
                <li><a href="https://woocommerce.github.io/woocommerce-rest-api-docs/">REST API Docs</a></li>
                <li><a href="https://woocommerce.com/careers/?utm_source=woocommerce+core+code+reference&utm_medium=devdocs&utm_campaign=woo+careers" target="_blank">We're hiring!</a></li>
            </ul>
        </nav>
    </section>
</header>

<div class="phpdocumentor-header">
    <section class="phpdocumentor-section">
        <h1 class="phpdocumentor-title">Geodirectory Code Reference</h1>
        <section class="phpdocumentor-search">
    <label class="phpdocumentor-label">
        <span class="visually-hidden">Search (click ESC to close search results)</span>
        <input id="autoComplete" tabindex="1" type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading..." disabled />
    </label>
</section>

    </section>
</div>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <aside class="phpdocumentor-column -four phpdocumentor-sidebar">
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/elementorpro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/elementorpro-modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/Geodirectory.html"><abbr title="\Geodirectory">Geodirectory</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectory.html"><abbr title="\GeoDirectory">GeoDirectory</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/GeoDirectory-Templates.html"><abbr title="\GeoDirectory\Templates">Templates</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAbstracts.html"><abbr title="\GeoDirectoryAbstracts">GeoDirectoryAbstracts</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAPI.html"><abbr title="\GeoDirectoryAPI">GeoDirectoryAPI</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClasses.html"><abbr title="\GeoDirectoryClasses">GeoDirectoryClasses</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminFunctions.html"><abbr title="\GeoDirectoryAdminFunctions">GeoDirectoryAdminFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoruAdmin.html"><abbr title="\GeoDirectoruAdmin">GeoDirectoruAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdmin.html"><abbr title="\GeoDirectoryAdmin">GeoDirectoryAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirAdmin.html"><abbr title="\GeoDirAdmin">GeoDirAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectroyAdmin.html"><abbr title="\GeoDirectroyAdmin">GeoDirectroyAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminSystemStatus.html"><abbr title="\GeoDirectoryAdminSystemStatus">GeoDirectoryAdminSystemStatus</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminTools.html"><abbr title="\GeoDirectoryAdminTools">GeoDirectoryAdminTools</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminWidgets.html"><abbr title="\GeoDirectoryAdminWidgets">GeoDirectoryAdminWidgets</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesEmails.html"><abbr title="\GeoDirectoryClassesEmails">GeoDirectoryClassesEmails</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesData.html"><abbr title="\GeoDirectoryClassesData">GeoDirectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDIrectoryClassesData.html"><abbr title="\GeoDIrectoryClassesData">GeoDIrectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/ElementorPro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/ElementorPro-Modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryFunctions.html"><abbr title="\GeoDirectoryFunctions">GeoDirectoryFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryparamarraytermsAnarrayoftermobjects.html"><abbr title="\GeoDirectoryparamarraytermsAnarrayoftermobjects">GeoDirectoryparamarraytermsAnarrayoftermobjects</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WP.html"><abbr title="\WP">WP</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/WP-Background.html"><abbr title="\WP\Background">Background</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryTemplates.html"><abbr title="\GeoDirectoryTemplates">GeoDirectoryTemplates</abbr></a></h3>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../hooks/hooks.html">Hooks Reference</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">class-geodir-frontend-scripts.php</h2>

                

        
                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php
/**
 * Handle frontend scripts
 *
 * @class       GeoDir_Frontend_Scripts
 * @version     2.0.0
 * @package     GeoDirectory
 * @category    Class
 * @author      GeoDirectory
 */

if ( ! defined( &#039;ABSPATH&#039; ) ) {
	exit;
}

/**
 * GeoDir_Frontend_Scripts Class.
 */
class GeoDir_Frontend_Scripts {

	/**
	 * Contains an array of script handles registered by GeoDir.
	 * @var array
	 */
	private static $scripts = array();

	/**
	 * Contains an array of script handles registered by GeoDir.
	 * @var array
	 */
	private static $styles = array();

	/**
	 * Contains an array of script handles localized by GeoDir.
	 * @var array
	 */
	private static $wp_localize_scripts = array();

	/**
	 * Hook in methods.
	 */
	public static function init() {
		add_action( &#039;wp_enqueue_scripts&#039;, array( __CLASS__, &#039;load_scripts&#039; ) );
		add_action( &#039;wp_print_scripts&#039;, array( __CLASS__, &#039;localize_printed_scripts&#039; ), 5 );
		add_action( &#039;wp_print_footer_scripts&#039;, array( __CLASS__, &#039;localize_printed_scripts&#039; ), 5 );

		// locations scripts
		if(!isset($_REQUEST[&#039;et_fb&#039;]))
		add_action(&#039;wp_footer&#039;, array( __CLASS__, &#039;js_location_functions&#039; )); //@todo this script needs overhalled

		// fix script conflicts, eg flexslider being added twice
		add_action( &#039;wp_enqueue_scripts&#039;, array( __CLASS__, &#039;fix_script_conflicts&#039;), 100 );
		// Localize jQuery Timepicker
		add_action( &#039;wp_enqueue_scripts&#039;, &#039;geodir_localize_jquery_ui_timepicker&#039;, 1001 );

		// allow async tags
		add_filter(&#039;clean_url&#039;, array( __CLASS__, &#039;js_async&#039;), 11, 1);

	}


	/**
	 * Adds async tag to javascript for faster page loading.
	 *
	 * @since 1.0.0
	 * @package GeoDirectory
	 * @param string $url The javascript file url.
	 * @return string The modified javascript string.
	 */
	public static function js_async($url)
	{
		if (strpos($url, &#039;#asyncload&#039;)===false)
			return $url;
		else
			return str_replace(&#039;#asyncload&#039;, &#039;&#039;, $url).&quot;&#039; defer async=&#039;async&quot;;
	}

	/**
	 * Dequeue scripts to fix JS conflicts.
	 *
	 * @since 1.6.22
	 */
	public static function fix_script_conflicts() {
		if ( geodir_is_page( &#039;single&#039; ) ) {
			// Some themes don&#039;t load comment reply JS.
			if ( ! wp_script_is( &#039;comment-reply&#039;, &#039;enqueued&#039; ) ) {
				wp_enqueue_script( &#039;comment-reply&#039; );
			}

			if ( wp_script_is( &#039;flexslider&#039;, &#039;enqueued&#039; ) &amp;&amp; wp_script_is( &#039;jquery-flexslider&#039;, &#039;enqueued&#039; ) ) {
				wp_dequeue_script( &#039;flexslider&#039; );
			}
		}
	}

	/**
	 * Prints location related javascript.
	 *
	 * @since 1.0.0
	 * @since 1.6.16 Fix: Single quote in default city name causes problem in add new city.
	 * @package GeoDirectory
	 */
	public static function js_location_functions() {
		global $geodirectory;
		$default_search_for_text = geodir_get_option( &#039;search_default_text&#039; );
		if ( ! $default_search_for_text ) {
			$default_search_for_text = geodir_get_search_default_text();
		}

		$default_near_text = geodir_get_option( &#039;search_default_near_text&#039; );
		if ( ! $default_near_text ) {
			$default_near_text = geodir_get_search_default_near_text();
		}

		$search_location = $geodirectory-&gt;location-&gt;get_default_location();

		$default_search_for_text = addslashes(stripslashes($default_search_for_text));
		$default_near_text = addslashes(stripslashes($default_near_text));
		$city = !empty($search_location) ? addslashes(stripslashes($search_location-&gt;city)) : &#039;&#039;;
		?&gt;
		&lt;script type=&quot;text/javascript&quot;&gt;
			var default_location = &#039;&lt;?php echo $city ;?&gt;&#039;;
			var latlng;
			var address;
			var dist = 0;
			var Sgeocoder = (typeof google!==&#039;undefined&#039; &amp;&amp; typeof google.maps!==&#039;undefined&#039;) ? new google.maps.Geocoder() : {};

			&lt;?php if ( geodir_lazy_load_map() ) { ?&gt;
			jQuery(function($) {
				if ($(&#039;.geodir-listing-search input[name=&quot;snear&quot;]&#039;).length &amp;&amp; !window.geodirMapAllScriptsLoaded) {
					$(&#039;.geodir-listing-search input[name=&quot;snear&quot;]&#039;).each(function() {
						if (!window.geodirMapAllScriptsLoaded) {
							$(this).on(&#039;focus&#039;, function(e){
								/* Load lazy load scripts */
								if (!window.geodirMapAllScriptsLoaded &amp;&amp; !window.geodirApiScriptLoading) {
									$(this).geodirLoadMap({loadJS: true});
									jQuery(window).trigger(&#039;resize&#039;);
								}
							});
						}
					});
				}
			});
			&lt;?php } ?&gt;

			function geodir_setup_submit_search($form) {
				jQuery(&#039;.geodir_submit_search&#039;).off(&#039;click&#039;);// unbind any other click events
				jQuery(&#039;.geodir_submit_search&#039;).on(&quot;click&quot;,function(e) {
					e.preventDefault();

					var s = &#039; &#039;;
					var $form = jQuery(this).closest(&#039;form&#039;);
					&lt;?php if ( geodir_design_style() &amp;&amp; geodir_is_page( &#039;search&#039; ) ) { ?&gt;
					if ($form.data(&#039;show&#039;) == &#039;advanced&#039;) {
						if (jQuery(&#039;form.geodir-search-show-all:visible&#039;).length) {
							$form = jQuery(&#039;form.geodir-search-show-all&#039;);
						} else if (jQuery(&#039;form.geodir-search-show-main:visible&#039;).length) {
							$form = jQuery(&#039;form.geodir-search-show-main&#039;);
						} else if (jQuery(&#039;[name=&quot;geodir_search&quot;]&#039;).closest(&#039;form:visible&#039;).length) {
							$form = jQuery(&#039;[name=&quot;geodir_search&quot;]&#039;).closest(&#039;form&#039;);
						}
					}

					if (!(geodir_params.hasAjaxSearch &amp;&amp; !window.gdAsCptChanged)) {
						if ($form.data(&#039;show&#039;) == &#039;main&#039; &amp;&amp; jQuery(&#039;form.geodir-search-show-advanced:visible&#039;).length) {
							var formData = jQuery(&#039;form.geodir-search-show-advanced:visible&#039;).serializeArray();
							if (formData &amp;&amp; typeof formData == &#039;object&#039; &amp;&amp; formData.length) {
								$form.find(&#039;.geodir-advanced-data&#039;).remove();
								$form.append(&#039;&lt;div class=&quot;geodir-advanced-data&quot; style=&quot;display:none&quot;&gt;&lt;/div&gt;&#039;);
								jQuery.each(formData, function (i, obj){
									jQuery(&#039;&lt;input type=&quot;hidden&quot;&gt;&#039;).prop(obj).appendTo(jQuery(&#039;.geodir-advanced-data&#039;));
								});
							}
						}
					}
					&lt;?php } ?&gt;

					if (jQuery(&quot;#sdistance input[type=&#039;radio&#039;]:checked&quot;).length != 0) dist = jQuery(&quot;#sdistance input[type=&#039;radio&#039;]:checked&quot;).val();
					if (jQuery(&#039;.search_text&#039;, $form).val() == &#039;&#039; || jQuery(&#039;.search_text&#039;, $form).val() == &#039;&lt;?php echo $default_search_for_text;?&gt;&#039;) jQuery(&#039;.search_text&#039;, $form).val(s);

					// Disable location based search for disabled location post type.
					if (jQuery(&#039;.search_by_post&#039;, $form).val() != &#039;&#039; &amp;&amp; typeof gd_cpt_no_location == &#039;function&#039;) {
						if (gd_cpt_no_location(jQuery(&#039;.search_by_post&#039;, $form).val())) {
							jQuery(&#039;.snear&#039;, $form).remove();
							jQuery(&#039;.sgeo_lat&#039;, $form).remove();
							jQuery(&#039;.sgeo_lon&#039;, $form).remove();
							jQuery(&#039;select[name=&quot;sort_by&quot;]&#039;, $form).remove();
							jQuery($form).trigger(&quot;submit&quot;);
							return;
						}
					}

					if (
						dist &gt; 0
						|| (jQuery(&#039;select[name=&quot;sort_by&quot;]&#039;).val() == &#039;nearest&#039;
						|| jQuery(&#039;select[name=&quot;sort_by&quot;]&#039;, $form).val() == &#039;farthest&#039;)
						|| (jQuery(&quot;.snear&quot;, $form).val() != &#039;&#039; &amp;&amp; jQuery(&quot;.snear&quot;, $form).val() != &#039;&lt;?php echo $default_near_text;?&gt;&#039; &amp;&amp; !jQuery(&#039;.geodir-location-search-type&#039;, $form).val() )
					) {

						// OSM can&#039;t handel post code with no space so we test for it and add one if needed
						if(window.gdMaps === &#039;osm&#039;){
							var $near_val = jQuery(&quot;.snear&quot;, $form).val();
							var $is_post_code = $near_val.match(&quot;^([A-Za-z][A-Ha-hJ-Yj-y]?[0-9][A-Za-z0-9]??[0-9][A-Za-z]{2}|[Gg][Ii][Rr] ?0[Aa]{2})$&quot;);
							if($is_post_code){
								$near_val = $near_val.replace(/.{3}$/,&#039; $&amp;&#039;);
								jQuery(&quot;.snear&quot;, $form).val($near_val);
							}
						}

						geodir_setsearch($form);
					} else {
						jQuery(&quot;.snear&quot;, $form).val(&#039;&#039;);
						jQuery($form).trigger(&quot;submit&quot;);
					}
				});
				// Clear near search GPS for core
				if (!jQuery(&#039;input.geodir-location-search-type&#039;).length &amp;&amp; jQuery(&#039;[name=&quot;snear&quot;]&#039;).length){
					jQuery(&#039;[name=&quot;snear&quot;]&#039;).off(&#039;keyup&#039;);
					jQuery(&#039;[name=&quot;snear&quot;]&#039;).on(&#039;keyup&#039;, function($){
						jQuery(&#039;.sgeo_lat&#039;).val(&#039;&#039;);
						jQuery(&#039;.sgeo_lon&#039;).val(&#039;&#039;);
					});
				}
			}

			jQuery(document).ready(function() {
				geodir_setup_submit_search();
				//setup advanced search form on form ajax load
				jQuery(&quot;body&quot;).on(&quot;geodir_setup_search_form&quot;, function($form){
					geodir_setup_submit_search($form);
				});
			});

			function geodir_setsearch($form) {
				if ((dist &gt; 0 || (jQuery(&#039;select[name=&quot;sort_by&quot;]&#039;, $form).val() == &#039;nearest&#039; || jQuery(&#039;select[name=&quot;sort_by&quot;]&#039;, $form).val() == &#039;farthest&#039;)) &amp;&amp; (jQuery(&quot;.snear&quot;, $form).val() == &#039;&#039; || jQuery(&quot;.snear&quot;, $form).val() == &#039;&lt;?php echo $default_near_text;?&gt;&#039;)) jQuery(&quot;.snear&quot;, $form).val(default_location);
				geocodeAddress($form);
			}

			function updateSearchPosition(latLng, $form) {
				if (window.gdMaps === &#039;google&#039;) {
					jQuery(&#039;.sgeo_lat&#039;).val(latLng.lat());
					jQuery(&#039;.sgeo_lon&#039;).val(latLng.lng());
				} else if (window.gdMaps === &#039;osm&#039;) {
					jQuery(&#039;.sgeo_lat&#039;).val(latLng.lat);
					jQuery(&#039;.sgeo_lon&#039;).val(latLng.lon);
				}
				jQuery($form).trigger(&quot;submit&quot;); // submit form after insering the lat long positions
			}

			function geocodeAddress($form) {
				// Call the geocode function
				Sgeocoder = window.gdMaps == &#039;google&#039; ? new google.maps.Geocoder() : null;

				if (jQuery(&#039;.snear&#039;, $form).val() == &#039;&#039; || ( jQuery(&#039;.sgeo_lat&#039;).val() != &#039;&#039; &amp;&amp; jQuery(&#039;.sgeo_lon&#039;).val() != &#039;&#039;  ) || jQuery(&#039;.snear&#039;, $form).val().match(&quot;^&lt;?php _e(&#039;In:&#039;,&#039;geodirectory&#039;);?&gt;&quot;)) {
					if (jQuery(&#039;.snear&#039;, $form).val().match(&quot;^&lt;?php _e(&#039;In:&#039;,&#039;geodirectory&#039;);?&gt;&quot;)) {
						jQuery(&quot;.snear&quot;, $form).val(&#039;&#039;);
					}
					jQuery($form).trigger(&quot;submit&quot;);
				} else {
					var address = jQuery(&quot;.snear&quot;, $form).val();

					if (jQuery(&#039;.snear&#039;, $form).val() == &#039;&lt;?php echo $default_near_text;?&gt;&#039;) {
						initialise2();
					} else {
						&lt;?php
						$near_add = geodir_get_option(&#039;search_near_addition&#039;);
						/**
						 * Adds any extra info to the near search box query when trying to geolocate it via google api.
						 *
						 * @since 1.0.0
						 */
						$near_add2 = apply_filters(&#039;geodir_search_near_addition&#039;, &#039;&#039;);
						?&gt;
						var search_address = address&lt;?php echo ( $near_add ? &#039;+&quot;, &#039; . $near_add . &#039;&quot;&#039; : &#039;&#039; ) . $near_add2; ?&gt;;
						if (window.gdMaps === &#039;google&#039;) {
							Sgeocoder.geocode({&#039;address&#039;: search_address},
								function (results, status) {
									if (status == google.maps.GeocoderStatus.OK) {
										updateSearchPosition(results[0].geometry.location, $form);
									} else {
										alert(&quot;&lt;?php esc_attr_e(&#039;Search was not successful for the following reason :&#039;, &#039;geodirectory&#039;);?&gt;&quot; + status);
									}
								});
						} else if (window.gdMaps === &#039;osm&#039;) {
							geocodePositionOSM(false, search_address, false, false,
								function(geo) {
									if (typeof geo !== &#039;undefined&#039; &amp;&amp; geo.lat &amp;&amp; geo.lon) {
										updateSearchPosition(geo, $form);
									} else {
										alert(&quot;&lt;?php esc_attr_e(&#039;Search was not successful for the requested address.&#039;, &#039;geodirectory&#039;);?&gt;&quot;);
									}
								});
						} else {
							jQuery($form).trigger(&quot;submit&quot;);
						}
					}
				}
			}

			function initialise2() {
				if (!window.gdMaps) {
					return;
				}

				if (window.gdMaps === &#039;google&#039;) {
					var latlng = new google.maps.LatLng(56.494343, -4.205446);
					var myOptions = {
						zoom: 4,
						mapTypeId: google.maps.MapTypeId.TERRAIN,
						disableDefaultUI: true
					}
				} else if (window.gdMaps === &#039;osm&#039;) {
					var latlng = new L.LatLng(56.494343, -4.205446);
					var myOptions = {
						zoom: 4,
						mapTypeId: &#039;TERRAIN&#039;,
						disableDefaultUI: true
					}
				}
				try { prepareGeolocation(); } catch (e) {}
				doGeolocation();
			}

			function doGeolocation() {
				if (navigator.geolocation) {
					navigator.geolocation.getCurrentPosition(positionSuccess, positionError);
				} else {
					positionError(-1);
				}
			}

			function positionError(err) {
				var msg;
				switch (err.code) {
					case err.UNKNOWN_ERROR:
						msg = &quot;&lt;?php _e(&#039;Unable to find your location&#039;,&#039;geodirectory&#039;);?&gt;&quot;;
						break;
					case err.PERMISSION_DENINED:
						msg = &quot;&lt;?php _e(&#039;Permission denied in finding your location&#039;,&#039;geodirectory&#039;);?&gt;&quot;;
						break;
					case err.POSITION_UNAVAILABLE:
						msg = &quot;&lt;?php _e(&#039;Your location is currently unknown&#039;,&#039;geodirectory&#039;);?&gt;&quot;;
						break;
					case err.BREAK:
						msg = &quot;&lt;?php _e(&#039;Attempt to find location took too long&#039;,&#039;geodirectory&#039;);?&gt;&quot;;
						break;
					default:
						msg = &quot;&lt;?php _e(&#039;Location detection not supported in browser&#039;,&#039;geodirectory&#039;);?&gt;&quot;;
				}
				jQuery(&#039;#info&#039;).html(msg);
			}

			function positionSuccess(position) {
				var coords = position.coords || position.coordinate || position;
				jQuery(&#039;.sgeo_lat&#039;).val(coords.latitude);
				jQuery(&#039;.sgeo_lon&#039;).val(coords.longitude);

				jQuery(&#039;.geodir-listing-search&#039;).trigger(&quot;submit&quot;);
			}

			/**
			 * On unload page do some cleaning so back button cache does not store these values.
			 */
			jQuery(window).on(&quot;beforeunload&quot;, function(e) {
				if(jQuery(&#039;.sgeo_lat&#039;).length ){
					jQuery(&#039;.sgeo_lat&#039;).val(&#039;&#039;);
					jQuery(&#039;.sgeo_lon&#039;).val(&#039;&#039;);
				}
			});
		&lt;/script&gt;
		&lt;?php
	}

    /**
     * Return protocol relative asset URL.
     *
     * @since 2.0.0
     *
     * @param string $path URL Path.
     * @return string
     */
	private static function get_asset_url( $path ) {
		return str_replace( array( &#039;http:&#039;, &#039;https:&#039; ), &#039;&#039;, plugins_url( $path, geodir_plugin_url() ) );
	}

	/**
	 * Register a script for use.
     *
     * @since 2.0.0
	 *
	 * @uses   wp_register_script()
	 * @access private
	 * @param  string   $handle Handle.
	 * @param  string   $path Path.
	 * @param  array $deps Optional.  Deps. Default jquery.
	 * @param  string   $version Optional. Version Default GEODIRECTORY_VERSION.
	 * @param  boolean  $in_footer Optional. In footer. Default true.
	 */
	private static function register_script( $handle, $path, $deps = array( &#039;jquery&#039; ), $version = GEODIRECTORY_VERSION, $in_footer = true ) {
		self::$scripts[] = $handle;
		// BuddyBoss loads basic version of select2.
		if ( $handle == &#039;select2&#039; &amp;&amp; wp_script_is( &#039;select2&#039;, &#039;registered&#039; ) &amp;&amp; ( ! geodir_design_style() || function_exists( &#039;buddyboss_theme&#039; ) || class_exists( &#039;BuddyBoss_Theme&#039; ) ) ) {
			wp_deregister_script( &#039;select2&#039; ); // Fix conflict with select2 basic version loaded via 3rd party plugins.
		}
		wp_register_script( $handle, $path, $deps, $version, $in_footer );
	}

	/**
	 * Register and enqueue a script for use.
     *
     * @since 2.0.0
	 *
	 * @uses   wp_enqueue_script()
	 * @access private
	 * @param  string   $handle Handle.
	 * @param  string   $path Optional. Script path. Default null.
	 * @param  array $deps Optional. Deps. Default jquery.
	 * @param  string   $version Optional. Version. Default GEODIRECTORY_VERSION.
	 * @param  boolean  $in_footer Optional. In footer. Default true.
	 */
	public static function enqueue_script( $handle, $path = &#039;&#039;, $deps = array( &#039;jquery&#039; ), $version = GEODIRECTORY_VERSION, $in_footer = true ) {
		if ( ! in_array( $handle, self::$scripts ) &amp;&amp; $path ) {
			self::register_script( $handle, $path, $deps, $version, $in_footer );
		}
		wp_enqueue_script( $handle );
	}

	/**
	 * Register a style for use.
     *
     * @since 2.0.0
	 *
	 * @uses   wp_register_style()
	 * @access private
	 * @param  string   $handle Handle.
	 * @param  string   $path Style path.
	 * @param  array  $deps Optional. Deps. Default array.
	 * @param  string   $version Optional. Version. Default GEODIRECTORY_VERSION.
	 * @param  string   $media Optional. Media. Default all.
	 * @param  boolean  $has_rtl Optional. Has rtl. Default false.
	 */
	private static function register_style( $handle, $path, $deps = array(), $version = GEODIRECTORY_VERSION, $media = &#039;all&#039;, $has_rtl = false ) {
		self::$styles[] = $handle;
		if ( $handle == &#039;select2&#039; &amp;&amp; wp_style_is( &#039;select2&#039;, &#039;registered&#039; ) ) {
			wp_deregister_style( &#039;select2&#039; ); // Fix conflict with select2 basic version loaded via 3rd party plugins.
		}
		wp_register_style( $handle, $path, $deps, $version, $media );

		if ( $has_rtl ) {
			wp_style_add_data( $handle, &#039;rtl&#039;, &#039;replace&#039; );
		}
	}

	/**
	 * Register and enqueue a styles for use.
     *
     * @since 2.0.0
	 *
	 * @uses   wp_enqueue_style()
	 * @access private
	 * @param  string   $handle Handle.
	 * @param  string   $path Optional. Style path. Default null.
	 * @param  array $deps Optional. Deps. Default array.
	 * @param  string   $version Optional. Version. Default GEODIRECTORY_VERSION.
	 * @param  string   $media Optional. Media. Default all.
	 * @param  boolean  $has_rtl Optional. Has rtl. Default false.
	 */
	private static function enqueue_style( $handle, $path = &#039;&#039;, $deps = array(), $version = GEODIRECTORY_VERSION, $media = &#039;all&#039;, $has_rtl = false ) {
		if ( ! in_array( $handle, self::$styles ) &amp;&amp; $path ) {
			self::register_style( $handle, $path, $deps, $version, $media, $has_rtl );
		}
		wp_enqueue_style( $handle );
	}

	/**
	 * Register all GeoDir scripts.
     *
     * @since 2.0.0
	 */
	private static function register_scripts() {

		$map_lang = &quot;&amp;language=&quot; . GeoDir_Maps::map_language();
		$map_key = GeoDir_Maps::google_api_key(true);
		/** This filter is documented in geodirectory_template_tags.php */
		$map_extra = apply_filters(&#039;geodir_googlemap_script_extra&#039;, &#039;&#039;);

		$suffix           = defined( &#039;SCRIPT_DEBUG&#039; ) &amp;&amp; SCRIPT_DEBUG ? &#039;&#039; : &#039;.min&#039;;
		$aui = geodir_design_style() ? &#039;/aui&#039; : &#039;&#039;;
		$register_scripts = array(
			&#039;select2&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/js/select2/select2.full&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array( &#039;jquery&#039; ),
				&#039;version&#039; =&gt; &#039;4.0.4&#039;,
			),
			&#039;geodir-select2&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/js/geodir-select2&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array( &#039;jquery&#039;, &#039;select2&#039; ),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir-jquery-ui-timepicker&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/js/jquery.ui.timepicker&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array(&#039;jquery-ui-datepicker&#039;, &#039;jquery-ui-slider&#039;),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir-map&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/js/geodir-map&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array( &#039;jquery&#039; ),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir-google-maps&#039; =&gt; array(
				&#039;src&#039;     =&gt; &#039;https://maps.google.com/maps/api/js?&#039; . $map_lang . $map_key . $map_extra,
				&#039;deps&#039;    =&gt; array(),
				&#039;version&#039; =&gt; &#039;&#039;,
			),
			&#039;geodir-g-overlappingmarker&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/jawj/oms&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array( &#039;jquery&#039; ),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir-leaflet&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/leaflet/leaflet&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array(),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;leaflet-routing-machine&#039; =&gt; array(
				&#039;src&#039;     =&gt;  geodir_plugin_url() . &#039;/assets/leaflet/routing/leaflet-routing-machine&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array(&#039;geodir-leaflet&#039;),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir-leaflet-geo&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/leaflet/osm.geocode&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array(&#039;geodir-leaflet&#039;),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir-o-overlappingmarker&#039; =&gt; array(
				&#039;src&#039;     =&gt;  geodir_plugin_url() . &#039;/assets/jawj/oms-leaflet&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array(),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir-goMap&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/js/goMap&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array(&#039;jquery&#039;),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir-map-widget&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets&#039;.$aui.&#039;/js/map&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array(&#039;jquery&#039;),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir-plupload&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets&#039;.$aui.&#039;/js/geodirectory-plupload&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array(&#039;plupload&#039;,&#039;jquery&#039;,&#039;jquery-ui-sortable&#039;),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir&#039; =&gt; array(
				&#039;src&#039;     =&gt;  geodir_plugin_url() . &#039;/assets&#039;.$aui.&#039;/js/geodirectory&#039;. $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array(&#039;jquery&#039;),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;jquery-flexslider&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/js/jquery.flexslider&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array(&#039;jquery&#039;),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir-add-listing&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets&#039;.$aui.&#039;/js/add-listing&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array( &#039;jquery&#039; ),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			),
			&#039;geodir_lity&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/js/libraries/gd_lity&#039; . $suffix . &#039;.js&#039;,
				&#039;deps&#039;    =&gt; array(&#039;jquery&#039;),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
			)
		);
		foreach ( $register_scripts as $name =&gt; $props ) {
			self::register_script( $name, $props[&#039;src&#039;], $props[&#039;deps&#039;], $props[&#039;version&#039;] );
		}
	}

	/**
	 * Register all GeoDir styles.
     *
     * @since 2.0.0
	 */
	private static function register_styles() {
		$register_styles = array(
			&#039;select2&#039; =&gt; array(
				&#039;src&#039;     =&gt;  geodir_plugin_url() . &#039;/assets/css/select2/select2.css&#039;,
				&#039;deps&#039;    =&gt; array(),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
				&#039;has_rtl&#039; =&gt; false,
			),
			&#039;geodir-core&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/css/gd_core_frontend.css&#039;,
				&#039;deps&#039;    =&gt; array(),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
				&#039;has_rtl&#039; =&gt; false,
			),
			&#039;geodir-rtl&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/css/frontend.css&#039;,
				&#039;deps&#039;    =&gt; array(),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
				&#039;has_rtl&#039; =&gt; true,
			),
			&#039;leaflet&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/leaflet/leaflet.css&#039;,
				&#039;deps&#039;    =&gt; array(),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
				&#039;has_rtl&#039; =&gt; false,
			),
			&#039;leaflet-routing-machine&#039; =&gt; array(
				&#039;src&#039;     =&gt; geodir_plugin_url() . &#039;/assets/leaflet/routing/leaflet-routing-machine.css&#039;,
				&#039;deps&#039;    =&gt; array(),
				&#039;version&#039; =&gt; GEODIRECTORY_VERSION,
				&#039;has_rtl&#039; =&gt; false,
			),
		);
		foreach ( $register_styles as $name =&gt; $props ) {
			self::register_style( $name, $props[&#039;src&#039;], $props[&#039;deps&#039;], $props[&#039;version&#039;], &#039;all&#039;, $props[&#039;has_rtl&#039;] );
		}
	}

	/**
	 * Register/queue frontend scripts.
     *
     * @since 2.0.0
	 */
	public static function load_scripts() {
		global $post;

		$design_style = geodir_design_style();

		// Register scripts/styles
		self::register_scripts();
		self::register_styles();

		if ( ! $design_style ) {
			// global enqueues
			// css
			self::enqueue_style( &#039;select2&#039; );
			self::enqueue_style( &#039;geodir-core&#039; );
			// js
			self::enqueue_script( &#039;select2&#039; );
			self::enqueue_script( &#039;geodir-select2&#039; );
			self::enqueue_script( &#039;geodir&#039; );
			self::enqueue_script( &#039;geodir_lity&#039; );

			// rtl
			if ( is_rtl() ) {
				self::enqueue_style( &#039;geodir-rtl&#039; );
			}

			// add-listing
			if ( geodir_is_page( &#039;add-listing&#039; ) &amp;&amp; ! isset( $_REQUEST[&#039;ct_builder&#039;] ) ) {
				self::enqueue_script( &#039;geodir-plupload&#039; );
				self::enqueue_script( &#039;geodir-add-listing&#039; );
				self::enqueue_script( &#039;geodir-jquery-ui-timepicker&#039; );

				wp_enqueue_script( &#039;jquery-ui-autocomplete&#039; ); // add listing only?
			}
		} else {
			// js
			self::enqueue_script( &#039;geodir&#039; ); // original

			// add-listing @todo do we need all these?
			if ( geodir_is_page( &#039;add-listing&#039; ) &amp;&amp; ! isset( $_REQUEST[&#039;ct_builder&#039;] ) ) {
				self::enqueue_script( &#039;geodir-plupload&#039; );
				self::enqueue_script( &#039;geodir-add-listing&#039; );
			}
		}

		$map_api = GeoDir_Maps::active_map();
		wp_add_inline_script( &#039;jquery&#039;, &quot;window.gdSetMap = window.gdSetMap || &#039;&quot; . $map_api . &quot;&#039;;window.gdLoadMap = window.gdLoadMap || &#039;&quot; . geodir_lazy_load_map() . &quot;&#039;;&quot;);

		// Maps
		if ( geodir_lazy_load_map() ) {
			// Lazy Load
			if ( $map_api != &#039;none&#039; &amp;&amp; geodir_is_page( &#039;add-listing&#039; ) ) {
				self::enqueue_script( &#039;geodir-map&#039; );
			}
		} else {
			// Normal
			if ( in_array( $map_api, array( &#039;auto&#039;, &#039;google&#039; ) ) ) {
				self::enqueue_script(&#039;geodir-google-maps&#039;);
				self::enqueue_script(&#039;geodir-g-overlappingmarker&#039;);
			} elseif ( $map_api == &#039;osm&#039; ) {
				self::enqueue_style(&#039;leaflet&#039;);
				self::enqueue_style(&#039;leaflet-routing-machine&#039;);

				self::enqueue_script(&#039;geodir-leaflet&#039;);
				self::enqueue_script(&#039;geodir-leaflet-geo&#039;);
				self::enqueue_script(&#039;leaflet-routing-machine&#039;);
				self::enqueue_script(&#039;geodir-o-overlappingmarker&#039;);
			}

			if ( $map_api != &#039;none&#039; ) {
				wp_enqueue_script( &#039;geodir-goMap&#039; );

				if ( $footer_script = GeoDir_Maps::footer_script() ) {
					wp_add_inline_script( &#039;geodir-goMap&#039;, $footer_script, &#039;before&#039; );
				}
			}
		}
	}

	/**
	 * Localize a GeoDir script once.
	 * @access private
	 * @since  2.3.0 this needs less wp_script_is() calls due to https://core.trac.wordpress.org/ticket/28404 being added in WP 4.0.
	 * @param  string $handle
	 */
	private static function localize_script( $handle ) {
		if ( ! in_array( $handle, self::$wp_localize_scripts ) &amp;&amp; wp_script_is( $handle ) &amp;&amp; ( $data = self::get_script_data( $handle ) ) ) {
			$name                        = str_replace( &#039;-&#039;, &#039;_&#039;, $handle ) . &#039;_params&#039;;
			self::$wp_localize_scripts[] = $handle;
			wp_localize_script( $handle, $name, apply_filters( $name, $data ) );
		}
	}

	/**
	 * Return data for script handles.
     *
     * @since 2.0.0
     *
	 * @access private
	 * @param  string $handle
	 * @return array|bool
	 */
	private static function get_script_data( $handle ) {
		global $wp;

		switch ( $handle ) {
			case &#039;geodir&#039; :
				/**
				 * Filter the `geodir_var` data array that outputs the  wp_localize_script() translations and variables.
				 *
				 * This is used by addons to add JS translatable variables.
				 *
				 * @since 1.4.4
				 * @param array $geodir_vars_data {
				 *    geodir var data used by addons to add JS translatable variables.
				 *
				 *    @type string $siteurl Site url.
				 *    @type string $geodir_plugin_url Geodirectory core plugin url.
				 *    @type string $geodir_ajax_url Geodirectory plugin ajax url.
				 *    @type int $geodir_gd_modal Disable GD modal that displays slideshow images in popup?.
				 *    @type int $is_rtl Checks if current locale is RTL.
				 *
				 * }
				 */
				return apply_filters(&#039;geodir_vars_data&#039;,
					array(
						&#039;siteurl&#039; =&gt; get_option(&#039;siteurl&#039;),
						&#039;plugin_url&#039; =&gt; geodir_plugin_url(),
						&#039;ajax_url&#039; =&gt; admin_url( &#039;admin-ajax.php&#039; ),
						&#039;gd_modal&#039; =&gt; (int)geodir_get_option(&#039;geodir_disable_gb_modal&#039;),
						&#039;is_rtl&#039; =&gt; is_rtl() ? 1 : 0, // fix rtl issue
						&#039;basic_nonce&#039; =&gt; wp_create_nonce( &#039;geodir_basic_nonce&#039;),// fix rtl issue
						&#039;text_add_fav&#039;      =&gt; apply_filters(&#039;geodir_add_favourite_text&#039;, __( &#039;Add to Favorites&#039;, &#039;geodirectory&#039; )),
						&#039;text_fav&#039;          =&gt; apply_filters(&#039;geodir_favourite_text&#039;, __(&#039;Favorite&#039;, &#039;geodirectory&#039; ) ),
						&#039;text_remove_fav&#039;   =&gt; apply_filters(&#039;geodir_remove_favourite_text&#039;, __( &#039;Remove from Favorites&#039;, &#039;geodirectory&#039; )),
						&#039;text_unfav&#039;        =&gt; apply_filters(&#039;geodir_unfavourite_text&#039;, __( &#039;Unfavorite&#039;, &#039;geodirectory&#039; )),
						&#039;icon_fav&#039;          =&gt; apply_filters(&#039;geodir_favourite_icon&#039;, &#039;fas fa-heart&#039;),
						&#039;icon_unfav&#039;        =&gt; apply_filters(&#039;geodir_unfavourite_icon&#039;, &#039;fas fa-heart&#039;),
					) + geodir_params()
				);
			break;
			case &#039;geodir-select2&#039; :
				return array(
					//&#039;countries&#039;                 =&gt; json_encode( array_merge( WC()-&gt;countries-&gt;get_allowed_country_states(), WC()-&gt;countries-&gt;get_shipping_country_states() ) ),
					&#039;i18n_select_state_text&#039;    =&gt; esc_attr__( &#039;Select an option&amp;hellip;&#039;, &#039;geodirectory&#039; ),
					&#039;i18n_no_matches&#039;           =&gt; _x( &#039;No matches found&#039;, &#039;enhanced select&#039;, &#039;geodirectory&#039; ),
					&#039;i18n_ajax_error&#039;           =&gt; _x( &#039;Loading failed&#039;, &#039;enhanced select&#039;, &#039;geodirectory&#039; ),
					&#039;i18n_input_too_short_1&#039;    =&gt; _x( &#039;Please enter 1 or more characters&#039;, &#039;enhanced select&#039;, &#039;geodirectory&#039; ),
					&#039;i18n_input_too_short_n&#039;    =&gt; _x( &#039;Please enter %item% or more characters&#039;, &#039;enhanced select&#039;, &#039;geodirectory&#039; ),
					&#039;i18n_input_too_long_1&#039;     =&gt; _x( &#039;Please delete 1 character&#039;, &#039;enhanced select&#039;, &#039;geodirectory&#039; ),
					&#039;i18n_input_too_long_n&#039;     =&gt; _x( &#039;Please delete %item% characters&#039;, &#039;enhanced select&#039;, &#039;geodirectory&#039; ),
					&#039;i18n_selection_too_long_1&#039; =&gt; _x( &#039;You can only select 1 item&#039;, &#039;enhanced select&#039;, &#039;geodirectory&#039; ),
					&#039;i18n_selection_too_long_n&#039; =&gt; _x( &#039;You can only select %item% items&#039;, &#039;enhanced select&#039;, &#039;geodirectory&#039; ),
					&#039;i18n_load_more&#039;            =&gt; _x( &#039;Loading more results&amp;hellip;&#039;, &#039;enhanced select&#039;, &#039;geodirectory&#039; ),
					&#039;i18n_searching&#039;            =&gt; _x( &#039;Searching&amp;hellip;&#039;, &#039;enhanced select&#039;, &#039;geodirectory&#039; ),
				);
			break;
			case &#039;geodir-plupload&#039; :
				// place js config array for plupload
				$plupload_init = array(
					&#039;runtimes&#039; =&gt; &#039;html5,silverlight,html4&#039;,
					&#039;browse_button&#039; =&gt; &#039;plupload-browse-button&#039;, // will be adjusted per uploader
					&#039;container&#039; =&gt; &#039;plupload-upload-ui&#039;, // will be adjusted per uploader
					//&#039;drop_element&#039; =&gt; &#039;dropbox&#039;, // will be adjusted per uploader
					&#039;file_data_name&#039; =&gt; &#039;async-upload&#039;, // will be adjusted per uploader
					&#039;multiple_queues&#039; =&gt; true,
					&#039;max_file_size&#039; =&gt; geodir_max_upload_size(),
					&#039;url&#039; =&gt; admin_url(&#039;admin-ajax.php&#039;),
					&#039;flash_swf_url&#039; =&gt; includes_url(&#039;js/plupload/plupload.flash.swf&#039;),
					&#039;silverlight_xap_url&#039; =&gt; includes_url(&#039;js/plupload/plupload.silverlight.xap&#039;),
					&#039;filters&#039; =&gt; array(array(&#039;title&#039; =&gt; __(&#039;Allowed Files&#039;, &#039;geodirectory&#039;), &#039;extensions&#039; =&gt; &#039;*&#039;)),
					&#039;multipart&#039; =&gt; true,
					&#039;urlstream_upload&#039; =&gt; true,
					&#039;multi_selection&#039; =&gt; false, // will be added per uploader
					// additional post data to send to our ajax hook
					&#039;multipart_params&#039; =&gt; array(
						&#039;_ajax_nonce&#039; =&gt; wp_create_nonce( &quot;geodir_attachment_upload&quot; ), // will be added per uploader
						&#039;action&#039; =&gt; &#039;geodir_post_attachment_upload&#039;, // the ajax action name
						&#039;imgid&#039; =&gt; 0, // will be added per uploader
						&#039;post_id&#039; =&gt; 0 // will be added per uploader
					)
				);
				$thumb_img_arr = array();

				if (isset($_REQUEST[&#039;pid&#039;]) &amp;&amp; $_REQUEST[&#039;pid&#039;] != &#039;&#039;)
					$thumb_img_arr = geodir_get_images($_REQUEST[&#039;pid&#039;]);

				$totImg = &#039;&#039;;
				$image_limit = &#039;&#039;;
				if (!empty($thumb_img_arr)) {
					$totImg = count($thumb_img_arr);
				}
				$base_plupload_config = json_encode($plupload_init);

				return array(&#039;base_plupload_config&#039; =&gt; $base_plupload_config,
				             &#039;totalImg&#039; =&gt; $totImg,
				             &#039;image_limit&#039; =&gt; $image_limit,
				             &#039;upload_img_size&#039; =&gt; geodir_max_upload_size()
				);
				break;
			case &#039;geodir-map&#039; :
				return geodir_map_params();
				break;

		}
		return false;
	}

	/**
	 * Localize scripts only when enqueued.
     *
     * @since 2.0.0
	 */
	public static function localize_printed_scripts() {
		foreach ( self::$scripts as $handle ) {
			self::localize_script( $handle );
		}
	}
}

GeoDir_Frontend_Scripts::init();
</code></pre>
            </article>
            </div>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <footer class="phpdocumentor phpdocumentor-footer">
    <div class="phpdocumentor-section">
        <span>Geodirectory Code Reference API documentation generated by <a href="http://www.phpdoc.org/">phpDocumentor</a> on May 12th, 2022 at 06:28 am.</span>
    </div>
</footer>

    <script>
        cssVars({});
    </script>
    <script>
        var searchParams = {
            'searchIndex': '..\/js\/searchIndex.json'
        };
    </script>
    <script src="../js/searchIndex.js?updated=1652336886"></script>
    <script src="../js/search.js?updated=1652336886"></script>
</body>
</html>
