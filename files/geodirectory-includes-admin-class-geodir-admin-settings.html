<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Geodirectory Code Reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/favicon.png" />
    <link rel="apple-touch-icon" href="../images/apple-touch-icon.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-touch-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-touch-icon-114x114.png"/>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/base.css?updated=1652337337">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/template.css?updated=1652337337">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
            <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/js/all.min.js" integrity="sha256-0vuk8LXoyrmCjp1f0O300qo1M75ZQyhH9X3J6d+scmk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8KCYZ2CYMS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8KCYZ2CYMS', {
		'content_group' : 'WooCommerce Core Code Reference',
	});
</script>
        <script src="../js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-top-header">
    <section class="phpdocumentor-section">
        <div class="site-branding">
            <a class="site-logo" href="../index.html"><img width="180" src="../images/logo.png" alt="WPGeodirectory" /></a>
        </div>
        <nav class="main-navigation">
            <ul>
                <li><a href="../hooks/hooks.html">Hooks Reference</a></li>
                <li><a href="https://docs.woocommerce.com/">Documentation</a></li>
                <li><a href="https://woocommerce.github.io/woocommerce-rest-api-docs/">REST API Docs</a></li>
                <li><a href="https://woocommerce.com/careers/?utm_source=woocommerce+core+code+reference&utm_medium=devdocs&utm_campaign=woo+careers" target="_blank">We're hiring!</a></li>
            </ul>
        </nav>
    </section>
</header>

<div class="phpdocumentor-header">
    <section class="phpdocumentor-section">
        <h1 class="phpdocumentor-title">Geodirectory Code Reference</h1>
        <section class="phpdocumentor-search">
    <label class="phpdocumentor-label">
        <span class="visually-hidden">Search (click ESC to close search results)</span>
        <input id="autoComplete" tabindex="1" type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading..." disabled />
    </label>
</section>

    </section>
</div>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <aside class="phpdocumentor-column -four phpdocumentor-sidebar">
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/elementorpro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/elementorpro-modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/Geodirectory.html"><abbr title="\Geodirectory">Geodirectory</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectory.html"><abbr title="\GeoDirectory">GeoDirectory</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/GeoDirectory-Templates.html"><abbr title="\GeoDirectory\Templates">Templates</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAbstracts.html"><abbr title="\GeoDirectoryAbstracts">GeoDirectoryAbstracts</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAPI.html"><abbr title="\GeoDirectoryAPI">GeoDirectoryAPI</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClasses.html"><abbr title="\GeoDirectoryClasses">GeoDirectoryClasses</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminFunctions.html"><abbr title="\GeoDirectoryAdminFunctions">GeoDirectoryAdminFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoruAdmin.html"><abbr title="\GeoDirectoruAdmin">GeoDirectoruAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdmin.html"><abbr title="\GeoDirectoryAdmin">GeoDirectoryAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirAdmin.html"><abbr title="\GeoDirAdmin">GeoDirAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectroyAdmin.html"><abbr title="\GeoDirectroyAdmin">GeoDirectroyAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminSystemStatus.html"><abbr title="\GeoDirectoryAdminSystemStatus">GeoDirectoryAdminSystemStatus</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminTools.html"><abbr title="\GeoDirectoryAdminTools">GeoDirectoryAdminTools</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminWidgets.html"><abbr title="\GeoDirectoryAdminWidgets">GeoDirectoryAdminWidgets</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesEmails.html"><abbr title="\GeoDirectoryClassesEmails">GeoDirectoryClassesEmails</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesData.html"><abbr title="\GeoDirectoryClassesData">GeoDirectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDIrectoryClassesData.html"><abbr title="\GeoDIrectoryClassesData">GeoDIrectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/ElementorPro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/ElementorPro-Modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryFunctions.html"><abbr title="\GeoDirectoryFunctions">GeoDirectoryFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryparamarraytermsAnarrayoftermobjects.html"><abbr title="\GeoDirectoryparamarraytermsAnarrayoftermobjects">GeoDirectoryparamarraytermsAnarrayoftermobjects</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WP.html"><abbr title="\WP">WP</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/WP-Background.html"><abbr title="\WP\Background">Background</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryTemplates.html"><abbr title="\GeoDirectoryTemplates">GeoDirectoryTemplates</abbr></a></h3>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../hooks/hooks.html">Hooks Reference</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">class-geodir-admin-settings.php</h2>

                

        
                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php
/**
 * GeoDirectory Admin Settings Class
 *
 * @author   AyeCode
 * @category Admin
 * @package  GeoDirectory/Admin
 * @version  2.0.0
 */

if ( ! defined( &#039;ABSPATH&#039; ) ) {
	exit;
}


/**
 * GeoDir_Admin_Settings Class.
 */
class GeoDir_Admin_Settings {

	/**
	 * Setting pages.
	 *
	 * @var array
	 */
	private static $settings = array();

	/**
	 * Error messages.
	 *
	 * @var array
	 */
	private static $errors   = array();

	/**
	 * Update messages.
	 *
	 * @var array
	 */
	private static $messages = array();

	/**
	 * Include the settings page classes.
	 */
	public static function get_settings_pages() {
		if ( empty( self::$settings ) ) {
			$settings = array();

			include_once( dirname( __FILE__ ) . &#039;/settings/class-geodir-settings-page.php&#039; );

			$post_type = isset($_REQUEST[&#039;post_type&#039;]) ? sanitize_title($_REQUEST[&#039;post_type&#039;]) : &#039;&#039;;
			// CPT Settings
			if(isset($_REQUEST[&#039;page&#039;]) &amp;&amp; $_REQUEST[&#039;page&#039;]==$post_type.&#039;-settings&#039;){
				$settings[] = include( &#039;settings/class-geodir-settings-cpt-cf.php&#039; );
				$settings[] = include( &#039;settings/class-geodir-settings-cpt-sorting.php&#039; );
				$settings[] = include( &#039;settings/class-geodir-settings-cpt-tabs.php&#039; );
				$settings[] = include( &#039;settings/class-geodir-settings-cpt.php&#039; );

			} else {
				$settings[] = include( &#039;settings/class-geodir-settings-general.php&#039; );
				$settings[] = include( &#039;settings/class-geodir-settings-emails.php&#039; );
				$settings[] = include( &#039;settings/class-geodir-settings-design.php&#039; );
				$settings[] = include( &#039;settings/class-geodir-settings-import-export.php&#039; );
				$settings[] = include( &#039;settings/class-geodir-settings-api.php&#039; );
			}

			self::$settings = apply_filters( &#039;geodir_get_settings_pages&#039;, $settings );
		}

		return self::$settings;
	}

	/**
	 * Save the settings.
	 */
	public static function save() {
		global $current_tab;

		if ( empty( $_REQUEST[&#039;_wpnonce&#039;] ) || ! wp_verify_nonce( $_REQUEST[&#039;_wpnonce&#039;], &#039;geodirectory-settings&#039; ) ) {
			die( __( &#039;Action failed. Please refresh the page and retry.&#039;, &#039;geodirectory&#039; ) );
		}

		// Trigger actions
		do_action( &#039;geodir_settings_save_&#039; . $current_tab );
		do_action( &#039;geodir_update_options_&#039; . $current_tab );
		do_action( &#039;geodir_update_options&#039; );

		self::add_message( __( &#039;Your settings have been saved.&#039;, &#039;geodirectory&#039; ) );
		self::check_download_folder_protection();

		// Clear any unwanted data and flush rules
		delete_transient( &#039;geodir_cache_excluded_uris&#039; );
		wp_schedule_single_event( time(), &#039;geodir_flush_rewrite_rules&#039; );

		do_action( &#039;geodir_settings_saved&#039; );
	}

	/**
	 * Add a message.
	 * @param string $text
	 */
	public static function add_message( $text ) {
		self::$messages[] = $text;
	}

	/**
	 * Add an error.
	 * @param string $text
	 */
	public static function add_error( $text ) {
		self::$errors[] = $text;
	}

	/**
	 * Output messages + errors.
	 * @return string
	 */
	public static function show_messages() {
		if ( sizeof( self::$errors ) &gt; 0 ) {
			foreach ( self::$errors as $error ) {
				echo &#039;&lt;div id=&quot;message&quot; class=&quot;error inline&quot;&gt;&lt;p&gt;&lt;strong&gt;&#039; . esc_html( $error ) . &#039;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&#039;;
			}
		} elseif ( sizeof( self::$messages ) &gt; 0 ) {
			foreach ( self::$messages as $message ) {
				echo &#039;&lt;div id=&quot;message&quot; class=&quot;updated inline&quot;&gt;&lt;p&gt;&lt;strong&gt;&#039; . esc_html( $message ) . &#039;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&#039;;
			}
		}
	}

	/**
	 * Settings page.
	 *
	 * Handles the display of the main geodirectory settings page in admin.
	 */
	public static function output($tab = &#039;&#039;) {
		global $current_section, $current_tab;

		$suffix = defined( &#039;SCRIPT_DEBUG&#039; ) &amp;&amp; SCRIPT_DEBUG ? &#039;&#039; : &#039;.min&#039;;

		do_action( &#039;geodir_settings_start&#039; );

		//wp_enqueue_script( &#039;geodir_settings&#039;, GeoDir()-&gt;plugin_url() . &#039;/assets/js/admin/settings&#039; . $suffix . &#039;.js&#039;, array( &#039;jquery&#039;, &#039;jquery-ui-datepicker&#039;, &#039;jquery-ui-sortable&#039;, &#039;iris&#039;, &#039;select2&#039; ), GeoDir()-&gt;version, true );

		wp_localize_script( &#039;geodir_settings&#039;, &#039;geodir_settings_params&#039;, array(
			&#039;i18n_nav_warning&#039; =&gt; __( &#039;The changes you made will be lost if you navigate away from this page.&#039;, &#039;geodirectory&#039; ),
		) );

		// Include settings pages
		self::get_settings_pages();

		// Get current tab/section
		if($tab){
			$current_tab = sanitize_title( $tab);

		}else{
			$current_tab = empty( $_GET[&#039;tab&#039;] ) ? &#039;general&#039; : sanitize_title( $_GET[&#039;tab&#039;] );

		}
		$current_section = empty( $_REQUEST[&#039;section&#039;] ) ? &#039;&#039; : sanitize_title( $_REQUEST[&#039;section&#039;] );

		// Save settings if data has been posted
		if ( ! empty( $_POST ) ) {
			self::save();
		}

		// Add any posted messages
		if ( ! empty( $_GET[&#039;gd_error&#039;] ) ) {
			self::add_error( stripslashes( $_GET[&#039;gd_error&#039;] ) );
		}

		if ( ! empty( $_GET[&#039;gd_message&#039;] ) ) {
			self::add_message( stripslashes( $_GET[&#039;gd_message&#039;] ) );
		}

		// Get tabs for the settings page
		$tabs = apply_filters( &#039;geodir_settings_tabs_array&#039;, array() );
		
//		print_r($tabs);exit;

		include( dirname( __FILE__ ) . &#039;/views/html-admin-settings.php&#039; );
	}

	/**
	 * Get a setting from the settings API.
	 *
	 * @param mixed $option_name
	 * @return string
	 */
	public static function get_option( $option_name, $default = &#039;&#039; ) {
		return geodir_get_option( $option_name, $default );
	}

	/**
	 * Output admin fields.
	 *
	 * Loops though the geodirectory options array and outputs each field.
	 *
	 * @param array $options Opens array to output
	 */
	public static function output_fields( $options ) {
		$disable_advanced = geodir_get_option( &#039;admin_disable_advanced&#039;, false );

		foreach ( $options as $value ) {
			if ( ! isset( $value[&#039;type&#039;] ) ) {
				continue;
			}

			if ( $disable_advanced ) {
				$value[&#039;advanced&#039;] = false;
			}

			if ( ! isset( $value[&#039;id&#039;] ) ) {
				$value[&#039;id&#039;] = &#039;&#039;;
			}
			if ( ! isset( $value[&#039;title&#039;] ) ) {
				$value[&#039;title&#039;] = isset( $value[&#039;name&#039;] ) ? $value[&#039;name&#039;] : &#039;&#039;;
			}
			if ( ! isset( $value[&#039;class&#039;] ) ) {
				$value[&#039;class&#039;] = &#039;&#039;;
			}
			if ( ! isset( $value[&#039;css&#039;] ) ) {
				$value[&#039;css&#039;] = &#039;&#039;;
			}
			if ( ! isset( $value[&#039;default&#039;] ) ) {
				$value[&#039;default&#039;] = &#039;&#039;;
			}
			if ( ! isset( $value[&#039;desc&#039;] ) ) {
				$value[&#039;desc&#039;] = &#039;&#039;;
			}
			if ( ! isset( $value[&#039;desc_tip&#039;] ) ) {
				$value[&#039;desc_tip&#039;] = false;
			}
			if ( ! isset( $value[&#039;placeholder&#039;] ) ) {
				$value[&#039;placeholder&#039;] = &#039;&#039;;
			}

			// Custom attribute handling
			$custom_attributes = array();

			if ( ! empty( $value[&#039;custom_attributes&#039;] ) &amp;&amp; is_array( $value[&#039;custom_attributes&#039;] ) ) {
				$custom_attributes = $value[&#039;custom_attributes&#039;];
//				foreach ( $value[&#039;custom_attributes&#039;] as $attribute =&gt; $attribute_value ) {
//					$custom_attributes[] = esc_attr( $attribute ) . &#039;=&quot;&#039; . esc_attr( $attribute_value ) . &#039;&quot;&#039;;
//				}
			}

			// Description handling
			$field_description = self::get_field_description( $value );
			extract( $field_description );


			$boxed_settings = true;

			$label_type =  isset($_REQUEST[&#039;page&#039;]) &amp;&amp; $_REQUEST[&#039;page&#039;]==&#039;gd-setup&#039; ? &#039;top&#039; : &#039;horizontal&#039;;


			// Switch based on type
			switch ( $value[&#039;type&#039;] ) {

				// Section Titles
				case &#039;page-title&#039;:

					if ( ! empty( $value[&#039;title&#039;] ) ) {

						echo &#039;&lt;div class=&quot;gd-setting-page-title&quot;&gt;&lt;h2 class=&quot;gd-settings-title h4 mb-0 &quot;&gt;&#039;;
						echo esc_html( $value[&#039;title&#039;] );
						if(!empty($value[&#039;title_html&#039;])){echo $value[&#039;title_html&#039;];}
						if(isset($value[&#039;desc_tip&#039;]) &amp;&amp; $value[&#039;desc_tip&#039;]){
							echo $tooltip_html;
						}
						echo &#039;&lt;/h2&gt;&lt;/div&gt;&#039;;
					}
					break;
				case &#039;title&#039;:
				case &#039;sectionstart&#039;:



					if ( $boxed_settings ) {
						$advanced = (isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;]) ? geodir_advanced_toggle_class() :&#039;&#039;;
						echo &#039;&lt;div class=&quot;accordion &#039;.$advanced.&#039;&quot; &gt;&lt;div class=&quot;card p-0 mw-100 border-0 shadow-sm&quot; style=&quot;overflow: initial;&quot;&gt;&#039; . &quot;\n\n&quot;;
						if ( ! empty( $value[&#039;title&#039;] ) ) {

						echo &#039;&lt;div class=&quot;card-header bg-white rounded-top&quot;&gt;&lt;h2 class=&quot;gd-settings-title h5 mb-0 &quot;&gt;&#039;;
							echo esc_html( $value[&#039;title&#039;] );
							if(!empty($value[&#039;title_html&#039;])){echo $value[&#039;title_html&#039;];}
							if(isset($value[&#039;desc_tip&#039;]) &amp;&amp; $value[&#039;desc_tip&#039;]){
								echo $tooltip_html;
							}
						echo &#039;&lt;/h2&gt;&lt;/div&gt;&#039;;
						}

						echo &#039;&lt;div class=&quot;card-body&quot;&gt;&#039; . &quot;\n\n&quot;;

						//print_r($value);
						if ( ! empty( $value[&#039;desc&#039;] ) &amp;&amp; (!isset($value[&#039;desc_tip&#039;]) || !$value[&#039;desc_tip&#039;]) ) {
							echo wpautop( wptexturize( wp_kses_post( $value[&#039;desc&#039;] ) ) );
						}

						if(isset($value[&#039;seo_helper_tags&#039;]) &amp;&amp; $value[&#039;seo_helper_tags&#039;]){
							echo GeoDir_SEO::helper_tags($value[&#039;seo_helper_tags&#039;]);
						}



						if ( ! empty( $value[&#039;id&#039;] ) ) {
							do_action( &#039;geodir_settings_&#039; . sanitize_title( $value[&#039;id&#039;] ) );
						}
					}else{

						if ( ! empty( $value[&#039;title&#039;] ) ) {
							$advanced = (isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;]) ? geodir_advanced_toggle_class() :&#039;&#039;;
							echo &#039;&lt;h2 class=&quot;gd-settings-title h4 clearfix &#039;.$advanced.&#039;&quot;&gt;&#039;;
							echo esc_html( $value[&#039;title&#039;] );
							if(!empty($value[&#039;title_html&#039;])){echo $value[&#039;title_html&#039;];}
							if(isset($value[&#039;desc_tip&#039;]) &amp;&amp; $value[&#039;desc_tip&#039;]){
								echo $tooltip_html;
							}
							echo &#039;&lt;/h2&gt;&#039;;
						}

						if ( ! empty( $value[&#039;desc&#039;] ) &amp;&amp; (!isset($value[&#039;desc_tip&#039;]) || !$value[&#039;desc_tip&#039;]) ) {
							echo wpautop( wptexturize( wp_kses_post( $value[&#039;desc&#039;] ) ) );
						}

						if(isset($value[&#039;seo_helper_tags&#039;]) &amp;&amp; $value[&#039;seo_helper_tags&#039;]){
							echo GeoDir_SEO::helper_tags($value[&#039;seo_helper_tags&#039;]);
						}

						echo &#039;&lt;table class=&quot;form-table&quot;&gt;&#039; . &quot;\n\n&quot;;

						if ( ! empty( $value[&#039;id&#039;] ) ) {
							do_action( &#039;geodir_settings_&#039; . sanitize_title( $value[&#039;id&#039;] ) );
						}
					}


					break;

				// Section start
//				case &#039;sectionstart&#039;:
//
//					echo  $boxed_settings ? &#039;&lt;div&gt;&lt;div&gt;&lt;div&gt;&#039; : &#039;&lt;table&gt;&#039;;
////
//					break;

				// Section Ends
				case &#039;sectionend&#039;:
					if ( ! empty( $value[&#039;id&#039;] ) ) {
						do_action( &#039;geodir_settings_&#039; . sanitize_title( $value[&#039;id&#039;] ) . &#039;_end&#039; );
					}

					echo  $boxed_settings ? &#039;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#039; : &#039;&lt;/table&gt;&#039;;
//					echo &#039;&lt;/table&gt;&#039;;
//					echo &#039;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#039;;
					if ( ! empty( $value[&#039;id&#039;] ) ) {
						do_action( &#039;geodir_settings_&#039; . sanitize_title( $value[&#039;id&#039;] ) . &#039;_after&#039; );
					}
					break;

				// Standard text inputs and subtypes like &#039;number&#039;
				case &#039;text&#039;:
				case &#039;email&#039;:
				case &#039;number&#039;:
				case &#039;password&#039; :

					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}

				echo aui()-&gt;input(
					array(
						&#039;id&#039;                =&gt; $value[&#039;id&#039;],
						&#039;name&#039;              =&gt; $value[&#039;id&#039;],
						&#039;label_type&#039;        =&gt; $label_type,
						&#039;label_col&#039;        =&gt; &#039;3&#039;,
						&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
						&#039;class&#039; =&gt; !empty($value[&#039;class&#039;]) ? $value[&#039;class&#039;] : &#039;&#039;,
						&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
						&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
						&#039;type&#039;              =&gt;  $value[&#039;type&#039;] ?  $value[&#039;type&#039;]  : &#039;text&#039;,
						&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
						&#039;required&#039;       =&gt; !empty($value[&#039;required&#039;]) ? true : false,
						&#039;value&#039; =&gt; $option_value,
						&#039;help_text&#039;  =&gt; isset($description) ? $description : &#039;&#039;,
						&#039;extra_attributes&#039;  =&gt; !empty($custom_attributes) ? $custom_attributes : array(),
						&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
					)
				);

					break;

				// Color picker.
				case &#039;color&#039; :
					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}

					$custom_attributes[&#039;data-default-color&#039;] = esc_attr( $value[&#039;default&#039;] );

					echo aui()-&gt;input(
						array(
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;        =&gt; &#039;3&#039;,
							&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
//							&#039;label_force_left&#039;  =&gt; true,
							//&#039;required&#039;          =&gt; true,
							&#039;class&#039; =&gt; $value[&#039;class&#039;].&#039; gd-color-picker d-none&#039;,
//							&#039;wrap_class&#039;    =&gt; &#039;gd-row-color-picker&#039;,
							&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() . &quot; gd-row-color-picker&quot; : &#039; gd-row-color-picker &#039;,
							&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
							&#039;type&#039;              =&gt;  $value[&#039;type&#039;] ?  $value[&#039;type&#039;]  : &#039;text&#039;,
							&#039;value&#039; =&gt; $option_value,
							&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
							&#039;help_text&#039;  =&gt; isset($description) ? $description : &#039;&#039;,
							&#039;extra_attributes&#039;  =&gt; !empty($custom_attributes) ? $custom_attributes : array(),
							&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
						)
					);

					break;

				// Color picker.
				case &#039;image&#039; :
					// add required scripts
					add_thickbox();
					wp_enqueue_script(&#039;media-upload&#039;);
					wp_enqueue_media();


					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}
					$image_size = ! empty( $value[&#039;image_size&#039;] ) ? $value[&#039;image_size&#039;] : &#039;thumbnail&#039;;

					if($option_value){
						$remove_class = &#039;&#039;;
						if ( strpos( $option_value, &#039;dashicons-&#039; ) === 0 ) {
							$show_img = &#039;&lt;div class=&quot;dashicons-before &#039; . esc_attr( $option_value ) . &#039;&quot;&gt;&lt;/div&gt;&#039;;
						} else if ( strpos( $option_value, &#039;plugins/geodirectory&#039; ) === 0 ) {
							$show_img = &#039;&lt;img src=&quot;&#039; . esc_url( geodir_file_relative_url( $option_value, true ) ) . &#039;&quot; /&gt;&#039;;
						} else {
							$show_img = wp_get_attachment_image($option_value, $image_size);
						}
					}else{
						$remove_class = &#039;gd-hidden&#039;;
						$show_img = &#039;&lt;img src=&quot;&#039;.admin_url( &#039;images/media-button-image.gif&#039; ).&#039;&quot; /&gt;&#039;;
					}


					// @todo this can be improved a lot.
					echo aui()-&gt;input(
						array(
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;        =&gt; &#039;3&#039;,
							&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
							&#039;class&#039; =&gt; !empty($value[&#039;class&#039;]) ? $value[&#039;class&#039;] : &#039;&#039;,
							//&#039;required&#039;          =&gt; true,
							&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
							&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
							&#039;type&#039;              =&gt;  &#039;hidden&#039;,//$value[&#039;type&#039;] ?  $value[&#039;type&#039;]  : &#039;text&#039;,
							&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
							&#039;value&#039; =&gt; $option_value,
							&#039;help_text&#039;  =&gt; isset($description) ? $description : &#039;&#039;,
							&#039;extra_attributes&#039;  =&gt; !empty($custom_attributes) ? $custom_attributes : array(),
							&#039;input_group_left&#039;  =&gt; &#039;&lt;div class=&quot;gd-upload-img&quot; data-field=&quot;&#039; . esc_attr( $value[&#039;id&#039;] ) . &#039;&quot;&gt;&lt;button type=&quot;button&quot; class=&quot;gd_upload_image_button btn btn-outline-primary mr-2&quot;&gt;&#039; . __( &#039;Upload Image&#039;, &#039;geodirectory&#039; ) . &#039;&lt;/button&gt;&lt;button type=&quot;button&quot; class=&quot;gd_remove_image_button btn btn-outline-primary &#039; . $remove_class . &#039;&quot;&gt;&#039; . __( &#039;Remove Image&#039;, &#039;geodirectory&#039; ) . &#039;&lt;/button&gt; &lt;div class=&quot;gd-upload-display gd-img-size-&#039; . $image_size . &#039; thumbnail mr-3&quot;&gt;&lt;div class=&quot;centered&quot;&gt;&#039; . $show_img . &#039;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#039;,
							&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
						)
					);

					break;

				// Textarea
				case &#039;textarea&#039;:

					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}

					$rows = !empty( $value[&#039;size&#039;] ) ? absint($value[&#039;size&#039;]) : 4;
					// Editor
					$wysiwyg = false;
					if ( ! empty( $value[&#039;wysiwyg&#039;] ) ) {
						if ( is_array( $value[&#039;wysiwyg&#039;] ) ) {
							$wysiwyg = $value[&#039;wysiwyg&#039;];
						} else {
							$wysiwyg = array( &#039;quicktags&#039; =&gt; true );
						}
						$value[&#039;allow_tags&#039;] = true;
					}

					// Select placeholder on empty textarea focus.
					$class = ! empty( $value[&#039;class&#039;] ) ? $value[&#039;class&#039;] : &#039;active-placeholder&#039;;
					if ( strpos( $class, &#039;active-placeholder&#039; ) === false ) {
						$class .= &#039; active-placeholder&#039;;
					}

					echo aui()-&gt;textarea(
						array(
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;         =&gt; &#039;3&#039;,
							&#039;class&#039;             =&gt; $class,
							&#039;label_class&#039;       =&gt; &#039;font-weight-bold&#039;,
							&#039;wrap_class&#039;        =&gt; isset( $value[&#039;advanced&#039;] ) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
							&#039;label&#039;             =&gt; $value[&#039;title&#039;] . $tooltip_html,
							&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
							&#039;value&#039;             =&gt; $option_value,
							&#039;help_text&#039;         =&gt; isset( $description ) ? $description : &#039;&#039;,
							&#039;extra_attributes&#039;  =&gt; ! empty( $custom_attributes ) ? $custom_attributes : array(),
							&#039;rows&#039;              =&gt; $rows,
							&#039;wysiwyg&#039;           =&gt; $wysiwyg,
							&#039;allow_tags&#039;        =&gt; isset( $value[&#039;allow_tags&#039;] ) ? $value[&#039;allow_tags&#039;] : true, // Allow HTML Tags. Default True.
							&#039;element_require&#039;   =&gt; ! empty( $value[&#039;element_require&#039;] ) ? $value[&#039;element_require&#039;] : &#039;&#039;,
							&#039;input_group_right&#039; =&gt; ! empty( $value[&#039;custom_desc&#039;] ) ? &quot;&lt;div class=&#039;d-flex flex-wrap pt-3 text-muted&#039;&gt;&quot; . $value[&#039;custom_desc&#039;] . &quot;&lt;/div&gt;&quot; : &#039;&#039;,
						)
					);

					break;
				// Editor
				case &#039;editor&#039;:
					global $wp_version;
					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;] );
					}
					if ( empty( $option_value ) &amp;&amp; empty( $value[&#039;allow_blank&#039;] ) ) {
						$option_value = isset( $value[&#039;default&#039;] ) ? $value[&#039;default&#039;] : &#039;&#039;;
					}

					$rows = !empty( $value[&#039;size&#039;] ) ? absint($value[&#039;size&#039;]) : 20;

					// @todo is this used in any settings?

					?&gt;&lt;tr valign=&quot;top&quot; class=&quot;&lt;?php echo (!empty($value[&#039;advanced&#039;]) ? &#039;gd-advanced-setting&#039; : &#039;&#039;); ?&gt;&quot;&gt;
						&lt;th scope=&quot;row&quot; class=&quot;titledesc&quot;&gt;
							&lt;label for=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;&quot;&gt;&lt;?php echo esc_html( $value[&#039;title&#039;] ); ?&gt;&lt;/label&gt;
							&lt;?php echo $tooltip_html; ?&gt;
						&lt;/th&gt;
						&lt;td class=&quot;forminp forminp-&lt;?php echo sanitize_title( $value[&#039;type&#039;] ) ?&gt;&quot;&gt;
							&lt;?php echo $description; ?&gt;
							&lt;?php
							if ( $wp_version &gt;= 3.3 &amp;&amp; function_exists( &#039;wp_editor&#039; ) ) {
								wp_editor( stripslashes( $option_value ), $value[&#039;id&#039;], array( &#039;textarea_name&#039; =&gt; esc_attr( $value[&#039;id&#039;] ), &#039;textarea_rows&#039; =&gt; $rows, &#039;media_buttons&#039; =&gt; false, &#039;editor_class&#039; =&gt; &#039;gd-wp-editor&#039;, &#039;editor_height&#039; =&gt; 16 * $rows ) );
							} else { ?&gt;
								&lt;textarea
									name=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;&quot;
									id=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;&quot;
									style=&quot;&lt;?php echo esc_attr( $value[&#039;css&#039;] ); ?&gt;&quot;
									class=&quot;large-text &lt;?php echo esc_attr( $value[&#039;class&#039;] ); ?&gt;&quot;
									placeholder=&quot;&lt;?php echo esc_attr( $value[&#039;placeholder&#039;] ); ?&gt;&quot; 
									rows=&quot;&lt;?php echo $rows; ?&gt;&quot;
									&lt;?php echo implode( &#039; &#039;, $custom_attributes ); ?&gt;
									&gt;&lt;?php echo esc_textarea( stripslashes( $option_value ) );  ?&gt;&lt;/textarea&gt;
							&lt;?php } ?&gt;
							&lt;?php if ( ! empty( $value[&#039;custom_desc&#039;] ) ) { ?&gt;
							&lt;span class=&quot;gd-custom-desc&quot;&gt;&lt;?php echo $value[&#039;custom_desc&#039;]; ?&gt;&lt;/span&gt;
							&lt;?php } ?&gt;
						&lt;/td&gt;
					&lt;/tr&gt;&lt;?php
					break;

				// Select boxes
				case &#039;select&#039; :
				case &#039;multiselect&#039; :

					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}


					$select2 = strpos($value[&#039;class&#039;], &#039;geodir-select&#039;) !== false ? true : false;
//				$value[&#039;class&#039;] = str_replace(&#039;geodir-select&#039;)
					
				echo aui()-&gt;select(
					array(
						&#039;id&#039;                =&gt; $value[&#039;id&#039;],
						&#039;name&#039;              =&gt; $value[&#039;id&#039;],
						&#039;label_type&#039;        =&gt; $label_type,
						&#039;label_col&#039;        =&gt; &#039;3&#039;,
						&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
						&#039;multiple&#039;   =&gt; &#039;multiselect&#039; == $value[&#039;type&#039;] ? true : false,
						&#039;class&#039; =&gt; $value[&#039;class&#039;].&quot; mw-100&quot;,
						//&#039;required&#039;          =&gt; true,
						&#039;select2&#039;   =&gt; $select2,
						&#039;options&#039;       =&gt; $value[&#039;options&#039;],
						&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
						&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
						&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
						&#039;value&#039; =&gt; $option_value,
						&#039;help_text&#039;  =&gt; isset($description) ? $description : &#039;&#039;,
						&#039;extra_attributes&#039;  =&gt; !empty($custom_attributes) ? $custom_attributes : array(),
						&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
					)
				);

					break;

				// Radio inputs
				case &#039;radio&#039; :

					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}


					$html = aui()-&gt;radio(
						array(
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;        =&gt; &#039;3&#039;,
							&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
							&#039;type&#039;              =&gt; &quot;radio&quot;,
//							&#039;title&#039;             =&gt; esc_attr__($cf[&#039;frontend_title&#039;], &#039;geodirectory&#039;),
							&#039;label&#039;             =&gt; $value[&#039;title&#039;] . $tooltip_html,
//							&#039;help_text&#039;         =&gt; $help_text,
							&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
							&#039;class&#039;             =&gt; &#039;&#039;,
							&#039;value&#039;             =&gt; $option_value,
							&#039;inline&#039;            =&gt; false,
							&#039;options&#039;           =&gt; $value[&#039;options&#039;],
//							&#039;wrap_attributes&#039;   =&gt; $conditional_attrs,
							&#039;extra_attributes&#039;  =&gt; !empty($custom_attributes) ? $custom_attributes : array(),
							&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
						)
					);

					echo $html;
					
					break;

				// Checkbox input
				case &#039;checkbox&#039; :

					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}

					$description .= $tooltip_html;

//					echo &#039;###&#039;. $option_value;
					
					echo aui()-&gt;input(
					array(
						&#039;id&#039;                =&gt; $value[&#039;id&#039;],
						&#039;name&#039;              =&gt; $value[&#039;id&#039;],
						&#039;value&#039;              =&gt; !empty($value[&#039;value&#039;]) ? $value[&#039;value&#039;] : &#039;1&#039;,
						&#039;label_type&#039;        =&gt; $label_type,
						&#039;label_col&#039;        =&gt; &#039;3&#039;,
						&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
						&#039;label_force_left&#039;  =&gt; true,
						&#039;class&#039; =&gt; !empty($value[&#039;class&#039;]) ? $value[&#039;class&#039;] : &#039;&#039;,
						//&#039;required&#039;          =&gt; true,
						&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
						&#039;label&#039;              =&gt; $value[&#039;title&#039;],
						&#039;type&#039;              =&gt;  $value[&#039;type&#039;] ?  $value[&#039;type&#039;]  : &#039;text&#039;,
						&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
						&#039;checked&#039; =&gt; $option_value,
						&#039;help_text&#039;  =&gt; isset($description) ? $description : &#039; &#039;,
						&#039;extra_attributes&#039;  =&gt; !empty($custom_attributes) ? $custom_attributes : array(),
						&#039;switch&#039;    =&gt; &#039;md&#039;,
						&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
					)
				);

					break;
				
				// Checkbox input
				case &#039;multicheckbox&#039; :

					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}

					?&gt;
					&lt;tr valign=&quot;top&quot; class=&quot;&lt;?php if(isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;]){echo &quot;gd-advanced-setting&quot;;}?&gt;&quot; &gt;
						&lt;th scope=&quot;row&quot; class=&quot;titledesc&quot;&gt;
							&lt;label&gt;&lt;?php echo esc_html( $value[&#039;title&#039;] ); ?&gt;&lt;/label&gt;
							&lt;?php echo $tooltip_html; ?&gt;
						&lt;/th&gt;
						&lt;td class=&quot;forminp forminp-checkbox&quot;&gt;
							&lt;div class=&quot;geodir-mcheck-rows geodir-mcheck-&lt;?php echo sanitize_key( $value[&#039;id&#039;] ); ?&gt;&quot;&gt;
								&lt;?php foreach( $value[&#039;options&#039;] as $key =&gt; $title ) { 
								if ( ! empty( $option_value ) &amp;&amp; is_array( $option_value ) &amp;&amp; in_array( $key, $option_value ) ) { 
									$checked = true;
								} else { 
									$checked = false; 
								}
								?&gt;
								&lt;div class=&quot;geodir-mcheck-row&quot;&gt;
									&lt;input
										name=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;[&lt;?php echo $key; ?&gt;]&quot;
										id=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] . &#039;-&#039; . sanitize_key( $key ) ); ?&gt;&quot;
										type=&quot;checkbox&quot;
										class=&quot;&lt;?php echo esc_attr( isset( $value[&#039;class&#039;] ) ? $value[&#039;class&#039;] : &#039;&#039; ); ?&gt;&quot;
										value=&quot;&lt;?php echo $key; ?&gt;&quot;
										&lt;?php checked( $checked, true ); ?&gt;
										&lt;?php echo implode( &#039; &#039;, $custom_attributes ); ?&gt;
									/&gt; &lt;label for=&quot;&lt;?php echo $value[&#039;id&#039;] . &#039;-&#039; . sanitize_key( $key ) ?&gt;&quot;&gt;&lt;?php echo $title ?&gt;&lt;/label&gt;&lt;/div&gt;
								&lt;?php } ?&gt;
								&lt;?php echo $description; ?&gt;
							&lt;/div&gt;
						&lt;/td&gt;
					&lt;/tr&gt;
						&lt;?php
					break;

				// Image width settings
				case &#039;image_width&#039; :

					$image_size       = str_replace( &#039;_image_size&#039;, &#039;&#039;, $value[&#039;id&#039;] );
					if ( isset( $value[&#039;value&#039;] ) ) {
						$size = $value[&#039;value&#039;];
					} else {
						$size = geodir_get_image_size( $image_size );
					}
					$width            = isset( $size[&#039;width&#039;] ) ? $size[&#039;width&#039;] : $value[&#039;default&#039;][&#039;width&#039;];
					$height           = isset( $size[&#039;height&#039;] ) ? $size[&#039;height&#039;] : $value[&#039;default&#039;][&#039;height&#039;];
					$crop             = isset( $size[&#039;crop&#039;] ) ? $size[&#039;crop&#039;] : $value[&#039;default&#039;][&#039;crop&#039;];
					$disabled_attr    = &#039;&#039;;
					$disabled_message = &#039;&#039;;

					if ( has_filter( &#039;geodir_get_image_size_&#039; . $image_size ) ) {
						$disabled_attr = &#039;disabled=&quot;disabled&quot;&#039;;
						$disabled_message = &quot;&lt;p&gt;&lt;small&gt;&quot; . __( &#039;The settings of this image size have been disabled because its values are being overwritten by a filter.&#039;, &#039;geodirectory&#039; ) . &quot;&lt;/small&gt;&lt;/p&gt;&quot;;
					}

					?&gt;&lt;tr valign=&quot;top&quot; class=&quot;&lt;?php if(isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;]){echo &quot;gd-advanced-setting&quot;;}?&gt;&quot;&gt;
						&lt;th scope=&quot;row&quot; class=&quot;titledesc&quot;&gt;&lt;?php echo esc_html( $value[&#039;title&#039;] ) ?&gt; &lt;?php echo $tooltip_html . $disabled_message; ?&gt;&lt;/th&gt;
						&lt;td class=&quot;forminp image_width_settings&quot;&gt;

							&lt;input name=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;[width]&quot; &lt;?php echo $disabled_attr; ?&gt; id=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;-width&quot; type=&quot;text&quot; size=&quot;3&quot; value=&quot;&lt;?php echo $width; ?&gt;&quot; /&gt; &amp;times; &lt;input name=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;[height]&quot; &lt;?php echo $disabled_attr; ?&gt; id=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;-height&quot; type=&quot;text&quot; size=&quot;3&quot; value=&quot;&lt;?php echo $height; ?&gt;&quot; /&gt;px

							&lt;label&gt;&lt;input name=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;[crop]&quot; &lt;?php echo $disabled_attr; ?&gt; id=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;-crop&quot; type=&quot;checkbox&quot; value=&quot;1&quot; &lt;?php checked( 1, $crop ); ?&gt; /&gt; &lt;?php _e( &#039;Hard crop?&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/label&gt;

							&lt;/td&gt;
					&lt;/tr&gt;&lt;?php
					break;

				// Single page selects
				case &#039;single_select_page&#039; :
					add_thickbox();
					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;] );
					}

					$args = array(
						&#039;name&#039;             =&gt; $value[&#039;id&#039;],
						&#039;id&#039;               =&gt; $value[&#039;id&#039;],
						&#039;sort_column&#039;      =&gt; &#039;menu_order&#039;,
						&#039;sort_order&#039;       =&gt; &#039;ASC&#039;,
						&#039;show_option_none&#039; =&gt; &#039; &#039;,
						&#039;class&#039;            =&gt; &#039; regular-text &#039;.$value[&#039;class&#039;],
						&#039;echo&#039;             =&gt; false,
						&#039;selected&#039;         =&gt; absint( $option_value ),
					);

					$exclude_pages = array();
					if ( $page_on_front = get_option( &#039;page_on_front&#039; ) ) {
						$exclude_pages[] = $page_on_front; // Exclude frontpage.
					}
					if ( $page_for_posts = get_option( &#039;page_for_posts&#039; ) ) {
						$exclude_pages[] = $page_for_posts; // Exclude Blog page.
					}
					if ( ! empty( $exclude_pages ) ) {
						$args[&#039;exclude&#039;] = $exclude_pages;
					}

					if ( isset( $value[&#039;args&#039;] ) ) {
						$args = wp_parse_args( $value[&#039;args&#039;], $args );
					}


					$defaults = array(
						&#039;depth&#039;                 =&gt; 0,
						&#039;child_of&#039;              =&gt; 0,
						&#039;selected&#039;              =&gt; 0,
						&#039;echo&#039;                  =&gt; 1,
						&#039;name&#039;                  =&gt; &#039;page_id&#039;,
						&#039;id&#039;                    =&gt; &#039;&#039;,
						&#039;class&#039;                 =&gt; &#039;&#039;,
						&#039;show_option_none&#039;      =&gt; &#039;&#039;,
						&#039;show_option_no_change&#039; =&gt; &#039;&#039;,
						&#039;option_none_value&#039;     =&gt; &#039;&#039;,
						&#039;value_field&#039;           =&gt; &#039;ID&#039;,
					);

					$parsed_args = wp_parse_args( $args, $defaults );

					$pages  = get_pages( $parsed_args );
					$page_options = array();

					if ( ! empty( $pages ) ) {
						foreach ( $pages as $page ) {
							$id = !empty($page-&gt;ID) ? absint($page-&gt;ID) : &#039;&#039;;
							$title = !empty($page-&gt;post_title) ? esc_attr($page-&gt;post_title) : &#039;&#039;;
							$page_options[$id] = $title;
						}
					}

					if ( isset( $parsed_args[&#039;show_option_none&#039;] ) ) {
						$parsed_args[&#039;show_option_none&#039;] = trim( $parsed_args[&#039;show_option_none&#039;] );
					}

					$buttons = &#039;&#039;;
					$buttons_links = array();

					ob_start();
					if($args[&#039;selected&#039;]){
						$buttons_links[get_edit_post_link( $args[&#039;selected&#039;] )] = __(&#039;Edit Page&#039;,&#039;geodirectory&#039;);

					if ( empty( $value[&#039;is_template_page&#039;] ) ) {
						$page_url = get_permalink( $args[&#039;selected&#039;] );
						if ( ! empty( $value[&#039;view_page_args&#039;] ) &amp;&amp; is_array( $value[&#039;view_page_args&#039;] ) ) {
							foreach ( $value[&#039;view_page_args&#039;] as $_key =&gt; $_value ) {
								if ( ! empty( $_key ) &amp;&amp; $_value != &#039;&#039; ) {
									$page_url = add_query_arg( $_key, $_value, $page_url );
								}
							}
						}
						$buttons_links[$page_url] = __(&#039;View Page&#039;,&#039;geodirectory&#039;);
						}
				}

							if(!empty($value[&#039;default_content&#039;])){

								$raw_default_content = &#039;&#039;;
								$default_method = $value[&#039;id&#039;].&#039;_content&#039;;

								// check if the default content has been filtered
								if(method_exists(&#039;GeoDir_Defaults&#039;, $default_method) &amp;&amp; GeoDir_Defaults::$default_method(true) != $value[&#039;default_content&#039;]){
									$raw_default_content = GeoDir_Defaults::$default_method(true);
								}
								$buttons_links[&quot;#TB_inline?&amp;width=650&amp;height=350&amp;inlineId=gd_default_content_&quot;.esc_attr($value[&#039;id&#039;])] = __(&#039;View Default Content&#039;,&#039;geodirectory&#039;);
								?&gt;
								&lt;div id=&quot;gd_default_content_&lt;?php echo esc_attr($value[&#039;id&#039;])?&gt;&quot; style=&quot;background:#fff;display:none;&quot; class=&quot;lity-hidex gd-notification &quot;&gt;
									&lt;?php
									$height = &quot;50&quot;;
									if($raw_default_content){
										echo geodir_notification( array(&#039;gd-warn&#039;=&gt;__(&#039;Default content has been modified by a plugin or theme.&#039;,&#039;geodirectory&#039;)) );
										$height = &quot;25&quot;;
									}
									?&gt;
									&lt;textarea style=&quot;min-width: calc(50vw - 32px);min-height: &lt;?php echo $height;?&gt;vh; display:block;&quot;&gt;&lt;?php echo $value[&#039;default_content&#039;];?&gt;&lt;/textarea&gt;
									&lt;?php
									if($raw_default_content){
										echo geodir_notification( array(&#039;gd-info&#039;=&gt;__(&#039;Original content below.&#039;,&#039;geodirectory&#039;)) );
										?&gt;
										&lt;textarea style=&quot;min-width: 50vw;min-height: &lt;?php echo $height;?&gt;vh;display:block;&quot;&gt;&lt;?php echo $raw_default_content;?&gt;&lt;/textarea&gt;

									&lt;?php }
									?&gt;
								&lt;/div&gt;
								&lt;?php
							}

					if(!empty($buttons_links)) {
						?&gt;
						&lt;button class=&quot;btn btn-outline-primary dropdown-toggle&quot; type=&quot;button&quot; data-toggle=&quot;dropdown&quot;
						        aria-haspopup=&quot;true&quot;
						        aria-expanded=&quot;false&quot;&gt;&lt;?php _e( &quot;Actions&quot;, &quot;geodirectory&quot; ); ?&gt;&lt;/button&gt;
						&lt;div class=&quot;dropdown-menu&quot;&gt;
							&lt;?php
							foreach($buttons_links as $link =&gt; $title){
								if ( substr( $link, 0, 1 ) === &quot;#&quot; ) {
									echo &#039;&lt;a class=&quot;dropdown-item thickbox&quot; href=&quot;&#039;.esc_attr($link).&#039;&quot;&gt;&#039;.$title.&#039;&lt;/a&gt;&#039;;
								}else{
									echo &#039;&lt;a class=&quot;dropdown-item&quot; href=&quot;&#039;.esc_attr($link).&#039;&quot;&gt;&#039;.$title.&#039;&lt;/a&gt;&#039;;
								}

							}
							?&gt;
						&lt;/div&gt;
						&lt;?php
					}
					$buttons = ob_get_clean();

					// Placeholder
					if ( ! empty( $parsed_args[&#039;show_option_none&#039;] ) ) {
						$placeholder = $parsed_args[&#039;show_option_none&#039;];
					} elseif ( ! empty( $parsed_args[&#039;placeholder&#039;] ) ) {
						$placeholder = $parsed_args[&#039;placeholder&#039;];
					} else {
						$placeholder = __( &#039;Select a page&amp;hellip;&#039;, &#039;geodirectory&#039; );
					}

					$output =  aui()-&gt;select(
						array(
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;         =&gt; &#039;3&#039;,
							&#039;label_class&#039;       =&gt; &#039;font-weight-bold&#039;,
							&#039;multiple&#039;          =&gt; &#039;multiselect&#039; == $value[&#039;type&#039;] ? true : false,
							&#039;class&#039;             =&gt; $buttons ? $value[&#039;class&#039;]. &#039; mw-100 w-auto&#039; : $value[&#039;class&#039;].&#039; mw-100 w-100&#039;,
							&#039;select2&#039;           =&gt; strpos( $value[&#039;class&#039;], &#039;geodir-select&#039; ) !== false ? true : false,
							&#039;options&#039;           =&gt; array( &#039;&#039; =&gt; esc_html( $placeholder ) ) + $page_options,
							&#039;wrap_class&#039;        =&gt; ! empty( $value[&#039;advanced&#039;] ) ? geodir_advanced_toggle_class() : &#039;&#039;,
							&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
							&#039;placeholder&#039;       =&gt; esc_html( $placeholder ),
							&#039;value&#039;             =&gt; $option_value,
							&#039;help_text&#039;         =&gt; isset( $description ) ? $description : &#039;&#039;,
							&#039;extra_attributes&#039;  =&gt; ! empty( $custom_attributes ) ? $custom_attributes : array(),
							&#039;input_group_right&#039; =&gt; $buttons,
							&#039;element_require&#039;   =&gt; ! empty( $value[&#039;element_require&#039;] ) ? $value[&#039;element_require&#039;] : &#039;&#039;,
						)
					);

					echo $output;

					break;
				// Single template selects
				case &#039;single_wp_template&#039; :
					add_thickbox();
					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;] );
					}

					$args = array(
						&#039;name&#039;             =&gt; $value[&#039;id&#039;],
						&#039;id&#039;               =&gt; $value[&#039;id&#039;],
						&#039;sort_column&#039;      =&gt; &#039;menu_order&#039;,
						&#039;sort_order&#039;       =&gt; &#039;ASC&#039;,
						&#039;show_option_none&#039; =&gt; &#039; &#039;,
						&#039;class&#039;            =&gt; &#039; regular-text &#039;.$value[&#039;class&#039;],
						&#039;echo&#039;             =&gt; false,
						&#039;selected&#039;         =&gt; absint( $option_value ),
					);

					$post = $option_value ? get_post( absint( $option_value ) ) : array();

					$exclude_pages = array();
					if ( $page_on_front = get_option( &#039;page_on_front&#039; ) ) {
						$exclude_pages[] = $page_on_front; // Exclude frontpage.
					}
					if ( $page_for_posts = get_option( &#039;page_for_posts&#039; ) ) {
						$exclude_pages[] = $page_for_posts; // Exclude Blog page.
					}
					if ( ! empty( $exclude_pages ) ) {
						$args[&#039;exclude&#039;] = $exclude_pages;
					}

					if ( isset( $value[&#039;args&#039;] ) ) {
						$args = wp_parse_args( $value[&#039;args&#039;], $args );
					}

					$defaults = array(
						&#039;depth&#039;                 =&gt; 0,
						&#039;child_of&#039;              =&gt; 0,
						&#039;selected&#039;              =&gt; 0,
						&#039;echo&#039;                  =&gt; 1,
						&#039;name&#039;                  =&gt; &#039;page_id&#039;,
						&#039;id&#039;                    =&gt; &#039;&#039;,
						&#039;class&#039;                 =&gt; &#039;&#039;,
						&#039;show_option_none&#039;      =&gt; &#039;&#039;,
						&#039;show_option_no_change&#039; =&gt; &#039;&#039;,
						&#039;option_none_value&#039;     =&gt; &#039;&#039;,
						&#039;value_field&#039;           =&gt; &#039;ID&#039;,
					);

					$parsed_args = wp_parse_args( $args, $defaults );

					$pages = self::get_wp_templates();
					$page_options = array();

					if ( ! empty( $pages ) ) {
						foreach ( $pages as $page ) {
							if ( $page-&gt;post_name &amp;&amp; $page-&gt;post_name == &#039;front-page&#039; ) {
								continue;
							}
							$id = ! empty( $page-&gt;ID ) ? absint( $page-&gt;ID ) : &#039;&#039;;
							$title = ! empty( $page-&gt;post_title ) ? esc_attr( $page-&gt;post_title ) : &#039;&#039;;
							$page_options[ $id ] = $title;
						}
					}

					if ( isset( $parsed_args[&#039;show_option_none&#039;] ) ) {
						$parsed_args[&#039;show_option_none&#039;] = trim( $parsed_args[&#039;show_option_none&#039;] );
					}

					$buttons = &#039;&#039;;
					$buttons_links = array();

					if ( $option_value &amp;&amp; ! empty( $post ) ) {
						$customize_url = self::get_site_editor_url( $post-&gt;post_type, $post-&gt;post_name );
						$buttons_links[ $customize_url ] = __( &#039;Edit Template&#039;,&#039;geodirectory&#039; );
					}

					if ( empty( $value[&#039;is_template_page&#039;] ) ) {
						if ( ! empty( $value[&#039;page_option&#039;] ) ) {
							$view_page_id = absint( geodir_get_option( $value[&#039;page_option&#039;] ) );
						} else if ( ! empty( $option_value ) ) {
							$view_page_id = absint( $option_value );
						} else {
							$view_page_id = 0;
						}

						if ( $view_page_id &amp;&amp; get_post_type( $view_page_id ) ) {
							$page_url = get_permalink( $view_page_id );

							if ( ! empty( $value[&#039;view_page_args&#039;] ) &amp;&amp; is_array( $value[&#039;view_page_args&#039;] ) ) {
								foreach ( $value[&#039;view_page_args&#039;] as $_key =&gt; $_value ) {
									if ( ! empty( $_key ) ) {
										$page_url = add_query_arg( $_key, $_value, $page_url );
									}
								}
							}

							$buttons_links[ $page_url ] = __( &#039;View Page&#039;,&#039;geodirectory&#039; );
						}
					}

					ob_start();

					if ( ! empty( $value[&#039;default_content&#039;] ) ) {
						$raw_default_content = &#039;&#039;;
						$default_method = $value[&#039;id&#039;].&#039;_content&#039;;

						// Check if the default content has been filtered.
						if ( method_exists( &#039;GeoDir_Defaults&#039;, $default_method ) &amp;&amp; GeoDir_Defaults::$default_method( true ) != $value[&#039;default_content&#039;] ) {
							$raw_default_content = GeoDir_Defaults::$default_method( true );
						}
						$buttons_links[ &quot;#TB_inline?&amp;width=650&amp;height=350&amp;inlineId=gd_default_content_&quot;.esc_attr( $value[&#039;id&#039;] ) ] = __( &#039;View Default Content&#039;, &#039;geodirectory&#039; );
						?&gt;
						&lt;div id=&quot;gd_default_content_&lt;?php echo esc_attr($value[&#039;id&#039;])?&gt;&quot; style=&quot;background:#fff;display:none;&quot; class=&quot;lity-hidex gd-notification &quot;&gt;
							&lt;?php
							$height = &quot;50&quot;;
							if($raw_default_content){
								echo geodir_notification( array(&#039;gd-warn&#039;=&gt;__(&#039;Default content has been modified by a plugin or theme.&#039;,&#039;geodirectory&#039;)) );
								$height = &quot;25&quot;;
							}
							?&gt;
							&lt;textarea style=&quot;min-width: calc(50vw - 32px);min-height: &lt;?php echo $height;?&gt;vh; display:block;&quot;&gt;&lt;?php echo $value[&#039;default_content&#039;];?&gt;&lt;/textarea&gt;
							&lt;?php
							if ( $raw_default_content ) {
								echo geodir_notification( array(&#039;gd-info&#039;=&gt;__(&#039;Original content below.&#039;,&#039;geodirectory&#039;)) );
								?&gt;
								&lt;textarea style=&quot;min-width: 50vw;min-height: &lt;?php echo $height;?&gt;vh;display:block;&quot;&gt;&lt;?php echo $raw_default_content;?&gt;&lt;/textarea&gt;
							&lt;?php }
							?&gt;
						&lt;/div&gt;
						&lt;?php
					}

					if ( ! empty( $value[&#039;create_template&#039;] ) ) {
						$buttons_links[&#039;#new-template&#039;] = __( &#039;Create New Template&#039;,&#039;geodirectory&#039; );
					}

					if ( ! empty( $buttons_links ) ) {
						?&gt;
						&lt;button class=&quot;btn btn-outline-primary dropdown-toggle&quot; type=&quot;button&quot; data-toggle=&quot;dropdown&quot; aria-haspopup=&quot;true&quot; aria-expanded=&quot;false&quot;&gt;&lt;?php _e( &quot;Actions&quot;, &quot;geodirectory&quot; ); ?&gt;&lt;/button&gt;
						&lt;div class=&quot;dropdown-menu&quot;&gt;
							&lt;?php
							foreach( $buttons_links as $link =&gt; $title ) {
								if ( $link == &#039;#new-template&#039; ) {
									$attrs = &#039;data-page=&quot;&#039; . esc_attr( $value[&#039;id&#039;] ) . &#039;&quot;&#039;;
									$reload = true;
									if ( ! empty( $value[&#039;page_cpt&#039;] ) ) {
										$attrs .= &#039; data-post-type=&quot;&#039; . esc_attr( $value[&#039;page_cpt&#039;] ) . &#039;&quot;&#039;;

										if ( ! geodir_is_gd_post_type( $value[&#039;page_cpt&#039;] ) ) {
											$reload = false;
										}
									}
									$attrs .= &#039; data-reload=&quot;&#039; . (int) $reload . &#039;&quot;&#039;;
									echo &#039;&lt;a class=&quot;dropdown-item gd-wp-tmpl-new&quot; href=&quot;javascript:void(0);&quot; &#039; . $attrs . &#039;&gt;&#039; . $title . &#039;&lt;/a&gt;&#039;;
								} else if ( substr( $link, 0, 1 ) === &quot;#&quot; ) {
									echo &#039;&lt;a class=&quot;dropdown-item thickbox&quot; href=&quot;&#039; . esc_attr( $link ) . &#039;&quot;&gt;&#039; . $title . &#039;&lt;/a&gt;&#039;;
								} else {
									echo &#039;&lt;a class=&quot;dropdown-item&quot; href=&quot;&#039; . esc_attr( $link ) . &#039;&quot;&gt;&#039; . $title . &#039;&lt;/a&gt;&#039;;
								}
							}
							?&gt;
						&lt;/div&gt;
						&lt;?php
					}
					$buttons = ob_get_clean();

					// Placeholder
					if ( ! empty( $parsed_args[&#039;show_option_none&#039;] ) ) {
						$placeholder = $parsed_args[&#039;show_option_none&#039;];
					} elseif ( ! empty( $parsed_args[&#039;placeholder&#039;] ) ) {
						$placeholder = $parsed_args[&#039;placeholder&#039;];
					} else {
						$placeholder = __( &#039;Select a template&amp;hellip;&#039;, &#039;geodirectory&#039; );
					}

					$output =  aui()-&gt;select(
						array(
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;         =&gt; &#039;3&#039;,
							&#039;label_class&#039;       =&gt; &#039;font-weight-bold&#039;,
							&#039;multiple&#039;          =&gt; &#039;multiselect&#039; == $value[&#039;type&#039;] ? true : false,
							&#039;class&#039;             =&gt; $buttons ? $value[&#039;class&#039;]. &#039; mw-100 w-auto&#039; : $value[&#039;class&#039;].&#039; mw-100 w-100&#039;,
							&#039;select2&#039;           =&gt; strpos( $value[&#039;class&#039;], &#039;geodir-select&#039; ) !== false ? true : false,
							&#039;options&#039;           =&gt; array( &#039;&#039; =&gt; esc_html( $placeholder ) ) + $page_options,
							&#039;wrap_class&#039;        =&gt; ! empty( $value[&#039;advanced&#039;] ) ? geodir_advanced_toggle_class() : &#039;&#039;,
							&#039;label&#039;             =&gt; $value[&#039;title&#039;] . $tooltip_html,
							&#039;placeholder&#039;       =&gt; esc_html( $placeholder ),
							&#039;value&#039;             =&gt; $option_value,
							&#039;help_text&#039;         =&gt; isset( $description ) ? $description : &#039;&#039;,
							&#039;extra_attributes&#039;  =&gt; ! empty( $custom_attributes ) ? $custom_attributes : array(),
							&#039;input_group_right&#039; =&gt; $buttons,
							&#039;element_require&#039;   =&gt; ! empty( $value[&#039;element_require&#039;] ) ? $value[&#039;element_require&#039;] : &#039;&#039;,
						)
					);

					echo $output;

					break;

				// Single country selects
				case &#039;single_select_country&#039; :
					if ( isset( $value[&#039;value&#039;] ) ) {
						$country_setting = (string) $value[&#039;value&#039;];
					} else {
						$country_setting = (string) self::get_option( $value[&#039;id&#039;] );
					}

					if ( strstr( $country_setting, &#039;:&#039; ) ) {
						$country_setting = explode( &#039;:&#039;, $country_setting );
						$country         = current( $country_setting );
						$state           = end( $country_setting );
					} else {
						$country = $country_setting;
						$state   = &#039;*&#039;;
					}

					$countries = geodir_get_country_dl($country,&#039;&#039;,true);
					echo aui()-&gt;select(
						array(
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;        =&gt; &#039;3&#039;,
							&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
							&#039;multiple&#039;   =&gt; &#039;multiselect&#039; == $value[&#039;type&#039;] ? true : false,
							&#039;class&#039;             =&gt; $value[&#039;class&#039;].&#039; mw-100&#039;,
							//&#039;required&#039;          =&gt; true,
							&#039;select2&#039;   =&gt; strpos($value[&#039;class&#039;], &#039;geodir-select&#039;) !== false ? true : false,
							&#039;options&#039;       =&gt; $countries,
							&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
							&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
							&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
							&#039;value&#039;         =&gt; $country,
							&#039;help_text&#039;  =&gt; isset($description) ? $description : &#039;&#039;,
							&#039;extra_attributes&#039;  =&gt; !empty($custom_attributes) ? $custom_attributes : array(),
							&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
						)
					);
					
					break;

				// Country multiselects
				case &#039;multi_select_countries&#039; :

					if ( isset( $value[&#039;value&#039;] ) ) {
						$selections = (array) $value[&#039;value&#039;];
					} else {
						$selections = (array) self::get_option( $value[&#039;id&#039;] );
					}

					if ( ! empty( $value[&#039;options&#039;] ) ) {
						$countries = $value[&#039;options&#039;];
					} else {
						$countries = geodir_get_countries();
					}

					asort( $countries );
					?&gt;&lt;tr valign=&quot;top&quot; class=&quot;&lt;?php if(isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;]){echo &quot;gd-advanced-setting&quot;;}?&gt;&quot;&gt;
						&lt;th scope=&quot;row&quot; class=&quot;titledesc&quot;&gt;
							&lt;label for=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;&quot;&gt;&lt;?php echo esc_html( $value[&#039;title&#039;] ); ?&gt;&lt;/label&gt;
							&lt;?php echo $tooltip_html; ?&gt;
						&lt;/th&gt;
						&lt;td class=&quot;forminp&quot;&gt;
							&lt;select multiple=&quot;multiple&quot; name=&quot;&lt;?php echo esc_attr( $value[&#039;id&#039;] ); ?&gt;[]&quot; style=&quot;width:350px&quot; data-placeholder=&quot;&lt;?php esc_attr_e( &#039;Choose countries&amp;hellip;&#039;, &#039;geodirectory&#039; ); ?&gt;&quot; aria-label=&quot;&lt;?php esc_attr_e( &#039;Country&#039;, &#039;geodirectory&#039; ) ?&gt;&quot; class=&quot;geodir-select&quot;&gt;
								&lt;?php
									if ( ! empty( $countries ) ) {
										foreach ( $countries as $key =&gt; $val ) {
											echo &#039;&lt;option value=&quot;&#039; . esc_attr( $key ) . &#039;&quot; &#039; . selected( in_array( $key, $selections ), true, false ) . &#039;&gt;&#039; . $val . &#039;&lt;/option&gt;&#039;;
										}
									}
								?&gt;
							&lt;/select&gt; &lt;?php echo ( $description ) ? $description : &#039;&#039;; ?&gt; &lt;br /&gt;&lt;a class=&quot;select_all button&quot; href=&quot;#&quot;&gt;&lt;?php _e( &#039;Select all&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/a&gt; &lt;a class=&quot;select_none button&quot; href=&quot;#&quot;&gt;&lt;?php _e( &#039;Select none&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/a&gt;
						&lt;/td&gt;
					&lt;/tr&gt;&lt;?php
					break;

				// Import/Export Listings
				case &#039;import_export_listings&#039; :
					?&gt;

					&lt;tr valign=&quot;top&quot; class=&quot;&lt;?php if(isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;]){echo &quot;gd-advanced-setting&quot;;}?&gt;&quot;&gt;
						&lt;td class=&quot;forminp&quot; colspan=&quot;2&quot;&gt;
							&lt;?php /**
							 * Contains template for import/export listings settings.
							 *
							 * @since 2.0.0
							 */
							include_once( dirname( __FILE__ ) . &#039;/views/html-admin-settings-import-export-listings.php&#039; );
							?&gt;
						&lt;/td&gt;
					&lt;/tr&gt;

					&lt;?php

					break;

				// Import/Export Categories
				case &#039;import_export_categories&#039; :
					?&gt;

					&lt;tr valign=&quot;top&quot; class=&quot;&lt;?php if(isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;]){echo &quot;gd-advanced-setting&quot;;}?&gt;&quot;&gt;
						&lt;td class=&quot;forminp&quot; colspan=&quot;2&quot;&gt;
							&lt;?php /**
							 * Contains template for import/export listings settings.
							 *
							 * @since 2.0.0
							 */
							include_once( dirname( __FILE__ ) . &#039;/views/html-admin-settings-import-export-categories.php&#039; );
							?&gt;
						&lt;/td&gt;
					&lt;/tr&gt;

					&lt;?php

					break;
					
				// Import/Export Reviews
				case &#039;import_export_reviews&#039; :
					?&gt;

					&lt;tr valign=&quot;top&quot; class=&quot;&lt;?php if(isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;]){echo &quot;gd-advanced-setting&quot;;}?&gt;&quot;&gt;
						&lt;td class=&quot;forminp&quot; colspan=&quot;2&quot;&gt;
							&lt;?php /**
							 * Contains template for import/export reviews.
							 *
							 * @since 2.0.0
							 */
							include_once( dirname( __FILE__ ) . &#039;/views/html-admin-settings-import-export-reviews.php&#039; );
							?&gt;
						&lt;/td&gt;
					&lt;/tr&gt;

					&lt;?php

					break;

				// Import/Export Categories
				case &#039;import_export_settings&#039; :
					?&gt;

					&lt;tr valign=&quot;top&quot; class=&quot;&lt;?php if(isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;]){echo &quot;gd-advanced-setting&quot;;}?&gt;&quot;&gt;
						&lt;td class=&quot;forminp&quot; colspan=&quot;2&quot;&gt;
							&lt;?php /**
							 * Contains template for import/export geodirectory settings.
							 *
							 * @since 2.0.0
							 */
							include_once( dirname( __FILE__ ) . &#039;/views/html-admin-settings-import-export-settings.php&#039; );
							?&gt;
						&lt;/td&gt;
					&lt;/tr&gt;

					&lt;?php

					break;
					
					// map
				case &#039;default_location_map&#039; :
					// used by included file do not remove.
					$prefix = &#039;default_location_&#039;;
					$map_title = __(&quot;Set Address On Map&quot;, &#039;geodirectory&#039;);

					add_filter(&#039;geodir_add_listing_map_restrict&#039;,&#039;__return_false&#039;);



                    ?&gt;

					&lt;div class=&quot;form-group&quot;&gt;
					&lt;?php /**
                     * Contains add listing page map functions.
                     *
                     * @since 1.0.0
                     */
                    include( GEODIRECTORY_PLUGIN_DIR . &#039;templates/map.php&#039; );
					?&gt;
					&lt;/div&gt;

                    &lt;?php

					break;

				case &#039;dummy_installer&#039;:

					

					GeoDir_Admin_Dummy_Data::dummy_data_ui();
					//geodir_autoinstall_admin_header($post_type);
					break;

				case &#039;map_key&#039; :
					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}

					$gm_api_url = &#039;https://console.developers.google.com/henhouse/?pb=[&quot;hh-1&quot;,&quot;maps_backend&quot;,null,[],&quot;https://developers.google.com&quot;,null,[&quot;static_maps_backend&quot;,&quot;street_view_image_backend&quot;,&quot;maps_embed_backend&quot;,&quot;places_backend&quot;,&quot;geocoding_backend&quot;,&quot;directions_backend&quot;,&quot;distance_matrix_backend&quot;,&quot;geolocation&quot;,&quot;elevation_backend&quot;,&quot;timezone_backend&quot;,&quot;maps_backend&quot;],null]&#039;;


					$custom_attributes[&#039;data-key-original&#039;] = esc_attr($option_value);

					echo aui()-&gt;input(
						array(
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;        =&gt; &#039;3&#039;,
							&#039;class&#039; =&gt; !empty($value[&#039;class&#039;]) ? $value[&#039;class&#039;] : &#039;&#039;,
							&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
							&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
							&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
							&#039;type&#039;              =&gt;  $value[&#039;type&#039;] ?  $value[&#039;type&#039;]  : &#039;text&#039;,
							&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
							&#039;value&#039; =&gt; $option_value,
							&#039;help_text&#039;  =&gt; $description,
							&#039;extra_attributes&#039;  =&gt; !empty($custom_attributes) ? $custom_attributes : array(),
							&#039;input_group_right&#039; =&gt; &#039;&lt;button class=&quot;btn btn-success&quot; type=&quot;button&quot;  onclick=&quot;geodir_validate_google_api_key(jQuery(\&#039;#google_maps_api_key\&#039;).val());&quot;&gt;&#039;.esc_attr__( &#039;Verify&#039;, &#039;geodirectory&#039; ).&#039;&lt;/button&gt;&lt;div class=&quot;input-group-text c-pointer&quot; data-toggle=&quot;tooltip&quot; title=&quot;&#039; . esc_attr__( &#039;API Key Guide&#039;, &#039;geodirectory&#039; ) . &#039;&quot;&gt;&lt;a href=&quot;https://docs.wpgeodirectory.com/article/186-google-api&quot; target=&quot;_blank&quot; class=&quot;text-dark&quot;&gt;&lt;i class=&quot;fas fa-info-circle&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;&lt;button class=&quot;btn btn-primary&quot; type=&quot;button&quot;  onclick=\&#039;window.open(&quot;&#039;.wp_slash($gm_api_url).&#039;&quot;, &quot;newwindow&quot;, &quot;width=600, height=400&quot;); return false;\&#039; &gt;&#039; . esc_attr__( &#039;Generate Key&#039;, &#039;geodirectory&#039; ) . &#039;&lt;/button&gt;&#039;,
							&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
						)
					);

					break;

				case &#039;geocode_key&#039; :
					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}

					$gm_api_url = &#039;https://console.developers.google.com/henhouse/?pb=[&quot;hh-1&quot;,&quot;geocoding_backend&quot;,null,[],&quot;https://developers.google.com&quot;,null,[&quot;geocoding_backend&quot;,&quot;timezone_backend&quot;],null]&#039;;
					echo aui()-&gt;input(
						array(
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;        =&gt; &#039;3&#039;,
							&#039;class&#039; =&gt; !empty($value[&#039;class&#039;]) ? $value[&#039;class&#039;] : &#039;&#039;,
							&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
							&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
							&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
							&#039;type&#039;              =&gt;  $value[&#039;type&#039;] ?  $value[&#039;type&#039;]  : &#039;text&#039;,
							&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
							&#039;value&#039; =&gt; $option_value,
							&#039;help_text&#039;  =&gt; $description,
							&#039;extra_attributes&#039;  =&gt; !empty($custom_attributes) ? $custom_attributes : array(),
							&#039;input_group_right&#039; =&gt; &#039;&lt;div class=&quot;input-group-text c-pointer&quot; data-toggle=&quot;tooltip&quot; title=&quot;&#039; . esc_attr__( &#039;API Key Guide&#039;, &#039;geodirectory&#039; ) . &#039;&quot;&gt;&lt;a href=&quot;https://docs.wpgeodirectory.com/article/186-google-api&quot; target=&quot;_blank&quot; class=&quot;text-dark&quot;&gt;&lt;i class=&quot;fas fa-info-circle&quot;&gt;&lt;/i&gt;&lt;/a&gt;&lt;/div&gt;&lt;button class=&quot;btn btn-primary&quot; type=&quot;button&quot;  onclick=\&#039;window.open(&quot;&#039;.wp_slash($gm_api_url).&#039;&quot;, &quot;newwindow&quot;, &quot;width=600, height=400&quot;); return false;\&#039; &gt;&#039; . esc_attr__( &#039;Generate Key&#039;, &#039;geodirectory&#039; ) . &#039;&lt;/button&gt;&#039;,
							&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
						)
					);

					break;

				// Select boxes
				case &#039;font-awesome&#039; :
					// include the font-awesome data
					include_once( dirname( __FILE__ ) . &#039;/settings/data_fontawesome.php&#039; );
					$value[&#039;options&#039;] = geodir_font_awesome_array();
					$rating_color = geodir_get_option(&#039;rating_color&#039;,&#039;#ff9900&#039;);

					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}

					$options = array();

//					print_r( $value[&#039;options&#039;] );exit;

					foreach ( $value[&#039;options&#039;] as $key =&gt; $val ) {
						$options[] = array(
							&#039;label&#039; =&gt; esc_attr($key),
							&#039;value&#039; =&gt; esc_attr($key),
							&#039;extra_attributes&#039; =&gt; array(
								&#039;data-fa-icon&#039; =&gt; esc_attr( $key )
							)
						);
					}


					//@todo we should change this to a better icon picker

					echo aui()-&gt;input(
						array(
							&#039;type&#039;              =&gt;  &#039;iconpicker&#039;,
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;        =&gt; &#039;3&#039;,
							&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
							//&#039;multiple&#039;   =&gt; &#039;multiselect&#039; == $value[&#039;type&#039;] ? true : false,
							&#039;class&#039;             =&gt; $value[&#039;class&#039;],
							//&#039;required&#039;          =&gt; true,
							//&#039;select2&#039;   =&gt; false,//strpos($value[&#039;class&#039;], &#039;geodir-select&#039;) !== false ? true : false,
//							&#039;options&#039;       =&gt; $options,
							&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
							&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
							&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
							&#039;value&#039;         =&gt; $option_value,
							&#039;help_text&#039;  =&gt; isset($description) ? $description : &#039;&#039;,
							&#039;extra_attributes&#039;  =&gt; !empty($value[&#039;custom_attributes&#039;] ) ? $value[&#039;custom_attributes&#039;] : array(),
							&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
						)
					);

					break;
				case &#039;dashicon&#039; :
					$value[&#039;options&#039;] = geodir_dashicon_options();

					if ( isset( $value[&#039;value&#039;] ) ) {
						$option_value = $value[&#039;value&#039;];
					} else {
						$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}
					$option_value = GeoDir_Post_types::sanitize_menu_icon( $option_value );

					$options = array();

//					print_r( $value[&#039;options&#039;] );exit;

					foreach ( $value[&#039;options&#039;] as $key =&gt; $val ) {
						$options[] = array(
							&#039;label&#039; =&gt; str_replace( &#039;dashicons-&#039;, &#039;&#039;, $key ),
							&#039;value&#039; =&gt; esc_attr($key) ,
							&#039;extra_attributes&#039; =&gt; array(
								&#039;data-dashicon&#039; =&gt; esc_attr( $key )
							)
						);
					}

					$value[&#039;class&#039;] = str_replace( &quot;geodir-select&quot;, &quot;&quot;, $value[&#039;class&#039;] );

					echo aui()-&gt;input(
						array(
							&#039;type&#039;              =&gt;  &#039;iconpicker&#039;,
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;        =&gt; &#039;3&#039;,
							&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
							&#039;multiple&#039;   =&gt; &#039;multiselect&#039; == $value[&#039;type&#039;] ? true : false,
							&#039;class&#039;             =&gt; $value[&#039;class&#039;]. &quot; gd-dashicons-picker&quot;,
							&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
							&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
							&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
							&#039;value&#039;         =&gt; $option_value,
							&#039;help_text&#039;  =&gt; isset($description) ? $description : &#039;&#039;,
							&#039;extra_attributes&#039;  =&gt; !empty($value[&#039;custom_attributes&#039;] ) ? $value[&#039;custom_attributes&#039;] : array(),
							&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
						)
					);

					?&gt;
					&lt;script&gt;
						var $dashicons = [
							&lt;?php
							if ( ! empty( $value[&#039;options&#039;] ) ) {
								foreach($value[&#039;options&#039;] as $key =&gt; $val){
									?&gt;
										{
											title: &quot;&lt;?php echo esc_attr($key);?&gt;&quot;,
											searchTerms: []
										},
									&lt;?php
								}
							}
							?&gt;
						];

						jQuery(function() {
							jQuery.iconpicker.batch(&quot;.gd-dashicons-picker&quot;, &#039;destroy&#039;);
							jQuery(&quot;.gd-dashicons-picker&quot;).iconpicker({
								icons: $dashicons,
								fullClassFormatter: function(val) {
									return &#039;dashicons &#039; + val;
								},
							});
						});

					&lt;/script&gt;
					&lt;?php

					break;
					case &#039;hidden&#039; :
						if ( isset( $value[&#039;value&#039;] ) ) {
							$option_value = $value[&#039;value&#039;];
						} else {
							$option_value = self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
						}

						echo aui()-&gt;input(
							array(
								&#039;id&#039;                =&gt; $value[&#039;id&#039;],
								&#039;name&#039;              =&gt; $value[&#039;id&#039;],
								&#039;label_type&#039;        =&gt; $label_type,
								&#039;label_col&#039;        =&gt; &#039;3&#039;,
								&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
								&#039;class&#039; =&gt; !empty($value[&#039;class&#039;]) ? $value[&#039;class&#039;] : &#039;&#039;,
								//&#039;required&#039;          =&gt; true,
								&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;d-none&#039;,
								&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
								&#039;type&#039;              =&gt;  $value[&#039;type&#039;] ?  $value[&#039;type&#039;]  : &#039;hidden&#039;,
								&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
								&#039;value&#039; =&gt; $option_value,
								&#039;help_text&#039;  =&gt; isset($description) ? $description : &#039;&#039;,
								&#039;extra_attributes&#039;  =&gt; !empty($custom_attributes) ? $custom_attributes : array(),
								&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
							)
						);

					break;
				// Single timezone select
				case &#039;single_select_timezone&#039; :
					if ( isset( $value[&#039;value&#039;] ) ) {
						$timezone_string = (string) $value[&#039;value&#039;];
					} else {
						$timezone_string = (string) self::get_option( $value[&#039;id&#039;], $value[&#039;default&#039;] );
					}
					$placeholder = ! empty( $value[&#039;placeholder&#039;] ) ? $value[&#039;placeholder&#039;] : __( &#039;Choose a city/timezone&amp;hellip;&#039;, &#039;geodirectory&#039; );
					$locale = function_exists( &#039;get_user_locale&#039; ) ? get_user_locale() : get_locale();


					$tz = geodir_timezone_choice( $timezone_string, $locale, true );
					echo aui()-&gt;select(
						array(
							&#039;id&#039;                =&gt; $value[&#039;id&#039;],
							&#039;name&#039;              =&gt; $value[&#039;id&#039;],
							&#039;label_type&#039;        =&gt; $label_type,
							&#039;label_col&#039;        =&gt; &#039;3&#039;,
							&#039;label_class&#039;=&gt; &#039;font-weight-bold&#039;,
							&#039;multiple&#039;   =&gt; &#039;multiselect&#039; == $value[&#039;type&#039;] ? true : false,
							&#039;class&#039;             =&gt; $value[&#039;class&#039;].&#039; mw-100&#039;,
							//&#039;required&#039;          =&gt; true,
							&#039;select2&#039;   =&gt; strpos($value[&#039;class&#039;], &#039;geodir-select&#039;) !== false ? true : false,
							&#039;options&#039;       =&gt; $tz,
							&#039;wrap_class&#039;        =&gt; isset($value[&#039;advanced&#039;]) &amp;&amp; $value[&#039;advanced&#039;] ? geodir_advanced_toggle_class() : &#039;&#039;,
							&#039;label&#039;              =&gt; $value[&#039;title&#039;] . $tooltip_html,
							&#039;placeholder&#039;       =&gt; $value[&#039;placeholder&#039;],
							&#039;value&#039;         =&gt; $locale ,
							&#039;help_text&#039;  =&gt; isset($description) ? $description : &#039;&#039;,
							&#039;extra_attributes&#039;  =&gt; !empty($custom_attributes) ? $custom_attributes : array(),
							&#039;element_require&#039; =&gt; !empty($value[&#039;element_require&#039;]) ? $value[&#039;element_require&#039;] : &#039;&#039;,
						)
					);

					break;

				// Default: run an action
				default:
					do_action( &#039;geodir_admin_field_&#039; . $value[&#039;type&#039;], $value );
					break;
			}
		}
	}

	/**
	 * Helper function to get the formatted description and tip HTML for a
	 * given form field. Plugins can call this when implementing their own custom
	 * settings types.
	 *
	 * @param  array $value The form field value array
	 * @return array The description and tip as a 2 element array
	 */
	public static function get_field_description( $value ) {
		$description  = &#039;&#039;;
		$tooltip_html = &#039;&#039;;

		if ( true === $value[&#039;desc_tip&#039;] ) {
			$tooltip_html = $value[&#039;desc&#039;];
		} elseif ( ! empty( $value[&#039;desc_tip&#039;] ) ) {
			$description  = $value[&#039;desc&#039;];
			$tooltip_html = $value[&#039;desc_tip&#039;];
		} elseif ( ! empty( $value[&#039;desc&#039;] ) ) {
			$description  = $value[&#039;desc&#039;];
		}

		if(!empty($value[&#039;docs&#039;])){

			$docs_link = &quot;&lt;a class=&#039;geodir-docs-link&#039; href=&#039;&quot;.esc_url($value[&#039;docs&#039;]).&quot;&#039; target=&#039;_blank&#039;&gt;&quot;.__(&#039;Documentation&#039;,&#039;geodirectory&#039;).&quot; &lt;i class=\&quot;fas fa-external-link-alt\&quot; aria-hidden=\&quot;true\&quot; aria-hidden=\&quot;true\&quot;&gt;&lt;/i&gt;&lt;/a&gt;&quot;;

			if(in_array( $value[&#039;type&#039;], array( &#039;checkbox&#039; ) )){
				$description .= $docs_link;
			}else{
				$tooltip_html .= $docs_link;
			}
		}

		if ( $description &amp;&amp; in_array( $value[&#039;type&#039;], array( &#039;textarea&#039;, &#039;radio&#039; ) ) ) {
			$description = &#039;&lt;p style=&quot;margin-top:0&quot;&gt;&#039; . wp_kses_post( $description ) . &#039;&lt;/p&gt;&#039;;
		} elseif ( $description &amp;&amp; in_array( $value[&#039;type&#039;], array( &#039;checkbox&#039; ) ) ) {
			$description = wp_kses_post( $description );
		} elseif ( $description ) {
			$description = &#039;&lt;span class=&quot;description&quot;&gt;&#039; . wp_kses_post( $description ) . &#039;&lt;/span&gt;&#039;;
		}



		if ( $tooltip_html &amp;&amp; in_array( $value[&#039;type&#039;], array( &#039;checkbox&#039; ) ) ) {
			$tooltip_html =  $tooltip_html;
		} elseif ( $tooltip_html ) {
			$tooltip_html = geodir_help_tip( $tooltip_html );
		}



		return array(
			&#039;description&#039;  =&gt; $description,
			&#039;tooltip_html&#039; =&gt; $tooltip_html,
		);
	}

	/**
	 * Save admin fields.
	 *
	 * Loops though the geodirectory options array and outputs each field.
	 *
	 * @param array $options Options array to output
	 * @param array $data Optional. Data to use for saving. Defaults to $_POST.
	 * @return bool
	 */
	public static function save_fields( $options, $data = null ) {
		if ( is_null( $data ) ) {
			$data = $_POST;
		}
		if ( empty( $data ) ) {
			return false;
		}

		// Options to update will be stored here and saved later.
		$update_options = array();

		// Loop options and get values to save.
		foreach ( $options as $option ) {
			if ( ! isset( $option[&#039;id&#039;] ) || ! isset( $option[&#039;type&#039;] ) ) {
				continue;
			}

			// Get posted value.
			if ( strstr( $option[&#039;id&#039;], &#039;[&#039; ) ) {
				parse_str( $option[&#039;id&#039;], $option_name_array );
				$option_name  = current( array_keys( $option_name_array ) );
				$setting_name = key( $option_name_array[ $option_name ] );
				$raw_value    = isset( $data[ $option_name ][ $setting_name ] ) ? wp_unslash( $data[ $option_name ][ $setting_name ] ) : null;
			} else {
				$option_name  = $option[&#039;id&#039;];
				$setting_name = &#039;&#039;;
				$raw_value    = isset( $data[ $option[&#039;id&#039;] ] ) ? wp_unslash( $data[ $option[&#039;id&#039;] ] ) : null;
			}

			// Format the value based on option type.
			switch ( $option[&#039;type&#039;] ) {
				case &#039;checkbox&#039; :
					//$value = &#039;1&#039; === $raw_value || &#039;yes&#039; === $raw_value ? &#039;yes&#039; : &#039;no&#039;;
					$value = &#039;1&#039; === $raw_value ? 1 : 0;
					break;
				case &#039;textarea&#039; :
				case &#039;editor&#039; :
					$value = wp_kses_post( trim( $raw_value ) );
					break;
				case &#039;multiselect&#039; :
				case &#039;multi_select_countries&#039; :
					$value = array_filter( array_map( &#039;geodir_clean&#039;, (array) $raw_value ) );
					break;
				case &#039;multicheckbox&#039; :
					$value = array_map( &#039;geodir_clean&#039;, (array) $raw_value );
					break;
				case &#039;image_width&#039; :
					$value = array();
					if ( isset( $raw_value[&#039;width&#039;] ) ) {
						$value[&#039;width&#039;]  = geodir_clean( $raw_value[&#039;width&#039;] );
						$value[&#039;height&#039;] = geodir_clean( $raw_value[&#039;height&#039;] );
						$value[&#039;crop&#039;]   = isset( $raw_value[&#039;crop&#039;] ) ? 1 : 0;
					} else {
						$value[&#039;width&#039;]  = $option[&#039;default&#039;][&#039;width&#039;];
						$value[&#039;height&#039;] = $option[&#039;default&#039;][&#039;height&#039;];
						$value[&#039;crop&#039;]   = $option[&#039;default&#039;][&#039;crop&#039;];
					}
					break;
				case &#039;select&#039;:
					$allowed_values = empty( $option[&#039;options&#039;] ) ? array() : array_keys( $option[&#039;options&#039;] );
					if ( empty( $option[&#039;default&#039;] ) &amp;&amp; empty( $allowed_values ) ) {
						$value = null;
						break;
					}
					$default = ( empty( $option[&#039;default&#039;] ) ? $allowed_values[0] : $option[&#039;default&#039;] );
					$value   = in_array( $raw_value, $allowed_values ) ? $raw_value : $default;
					break;
				default :
					$value = geodir_clean( $raw_value );
					break;
			}

			/**
			 * Fire an action when a certain &#039;type&#039; of field is being saved.
			 * @deprecated 2.4.0 - doesn&#039;t allow manipulation of values!
			 */
			if ( has_action( &#039;geodir_update_option_&#039; . sanitize_title( $option[&#039;type&#039;] ) ) ) {
				wc_deprecated_function( &#039;The geodir_update_option_X action&#039;, &#039;2.4.0&#039;, &#039;geodir_admin_settings_sanitize_option filter&#039; );
				do_action( &#039;geodir_update_option_&#039; . sanitize_title( $option[&#039;type&#039;] ), $option );
				continue;
			}

			/**
			 * Sanitize the value of an option.
			 * @since 2.4.0
			 */
			$value = apply_filters( &#039;geodir_admin_settings_sanitize_option&#039;, $value, $option, $raw_value );

			/**
			 * Sanitize the value of an option by option name.
			 * @since 2.4.0
			 */
			$value = apply_filters( &quot;geodir_admin_settings_sanitize_option_$option_name&quot;, $value, $option, $raw_value );

			if ( is_null( $value ) ) {
				continue;
			}

			// Check if option is an array and handle that differently to single values.
			if ( $option_name &amp;&amp; $setting_name ) {
				if ( ! isset( $update_options[ $option_name ] ) ) {
					$update_options[ $option_name ] = self::get_option( $option_name, array() );
				}
				if ( ! is_array( $update_options[ $option_name ] ) ) {
					$update_options[ $option_name ] = array();
				}
				$update_options[ $option_name ][ $setting_name ] = $value;
			} else {
				$update_options[ $option_name ] = $value;
			}

		}

		// Save all options in our array.
		foreach ( $update_options as $name =&gt; $value ) {
			//update_option( $name, $value );
			geodir_update_option($name, $value);
		}

		return true;
	}

	/**
	 * Checks which method we&#039;re using to serve downloads.
	 *
	 * If using force or x-sendfile, this ensures the .htaccess is in place.
	 */
	public static function check_download_folder_protection() {
		$upload_dir      = wp_upload_dir();
		$downloads_url   = $upload_dir[&#039;basedir&#039;] . &#039;/geodir_uploads&#039;;
		$download_method = get_option( &#039;geodir_file_download_method&#039; );

		if ( &#039;redirect&#039; == $download_method ) {

			// Redirect method - don&#039;t protect
			if ( file_exists( $downloads_url . &#039;/.htaccess&#039; ) ) {
				unlink( $downloads_url . &#039;/.htaccess&#039; );
			}
		} else {

			// Force method - protect, add rules to the htaccess file
			if ( ! file_exists( $downloads_url . &#039;/.htaccess&#039; ) ) {
				if ( $file_handle = @fopen( $downloads_url . &#039;/.htaccess&#039;, &#039;w&#039; ) ) {
					fwrite( $file_handle, &#039;deny from all&#039; );
					fclose( $file_handle );
				}
			}
		}
	}

	/**
	 * Get the list of wp_template posts.
	 *
	 * @since 2.2.4
	 *
	 * @param array $args Array of arguments.
	 * @return array Lists of posts.
	 */
	public static function get_wp_templates( $args = array() ) {
		$defaults = array(
			&#039;post_status&#039;    =&gt; array( &#039;publish&#039; ),
			&#039;post_type&#039;      =&gt; &#039;wp_template&#039;,
			&#039;posts_per_page&#039; =&gt; -1,
			&#039;no_found_rows&#039;  =&gt; true,
			&#039;tax_query&#039;      =&gt; array(
				array(
					&#039;taxonomy&#039; =&gt; &#039;wp_theme&#039;,
					&#039;field&#039;    =&gt; &#039;name&#039;,
					&#039;terms&#039;    =&gt; wp_get_theme()-&gt;get_stylesheet(),
				),
			),
		);

		$parsed_args = wp_parse_args( $args, $defaults );

		$template_query = new WP_Query( $parsed_args );

		return $template_query-&gt;posts;
	}

	/**
	 * Get the site editor for requested post.
	 *
	 * @since 2.2.4
	 *
	 * @param string $post_type The post type.
	 * @param string $post_name Post name.
	 * @param string $theme_slug Theme slug.
	 * @return string Full site editor page url.
	 */
	public static function get_site_editor_url( $post_type, $post_name, $theme_slug = &#039;&#039; ) {
		if ( empty( $theme_slug ) ) {
			$theme_slug = wp_get_theme()-&gt;get_stylesheet();
		}

		$post_id = $theme_slug . &#039;//&#039; . $post_name;

		return esc_url(
			add_query_arg(
				array(
					&#039;postType&#039; =&gt; $post_type,
					&#039;postId&#039; =&gt; $post_id,
				),
				admin_url( &#039;site-editor.php&#039; )
			)
		);
	}
}
</code></pre>
            </article>
            </div>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <footer class="phpdocumentor phpdocumentor-footer">
    <div class="phpdocumentor-section">
        <span>Geodirectory Code Reference API documentation generated by <a href="http://www.phpdoc.org/">phpDocumentor</a> on May 12th, 2022 at 06:35 am.</span>
    </div>
</footer>

    <script>
        cssVars({});
    </script>
    <script>
        var searchParams = {
            'searchIndex': '..\/js\/searchIndex.json'
        };
    </script>
    <script src="../js/searchIndex.js?updated=1652337337"></script>
    <script src="../js/search.js?updated=1652337337"></script>
</body>
</html>
