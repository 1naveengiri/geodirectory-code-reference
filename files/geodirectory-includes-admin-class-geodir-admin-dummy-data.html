<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>Geodirectory Code Reference</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="../images/favicon.png" />
    <link rel="apple-touch-icon" href="../images/apple-touch-icon.png"/>
    <link rel="apple-touch-icon" sizes="72x72" href="../images/apple-touch-icon-72x72.png"/>
    <link rel="apple-touch-icon" sizes="114x114" href="../images/apple-touch-icon-114x114.png"/>
    <link rel="stylesheet" href="../css/normalize.css">
    <link rel="stylesheet" href="../css/base.css?updated=1652341136">
    <link href="https://fonts.googleapis.com/css2?family=Source+Sans+Pro:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="../css/template.css?updated=1652341136">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/css/all.min.css" integrity="sha256-ybRkN9dBjhcS2qrW1z+hfCxq+1aBdwyQM5wlQoQVt/0=" crossorigin="anonymous" />
            <script src="https://cdn.jsdelivr.net/npm/css-vars-ponyfill@2"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.0/js/all.min.js" integrity="sha256-0vuk8LXoyrmCjp1f0O300qo1M75ZQyhH9X3J6d+scmk=" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/@tarekraafat/autocomplete.js@7.2.0/dist/js/autoComplete.min.js"></script>
    <!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-8KCYZ2CYMS"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-8KCYZ2CYMS', {
		'content_group' : 'WooCommerce Core Code Reference',
	});
</script>
        <script src="../js/prism.js"></script>
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            window.dispatchEvent(new HashChangeEvent('hashchange'));
        });
    </script>
</head>
<body id="top">
    <header class="phpdocumentor-top-header">
    <section class="phpdocumentor-section">
        <div class="site-branding">
            <a class="site-logo" href="../index.html"><img width="180" src="../images/logo.png" alt="WPGeodirectory" /></a>
        </div>
        <nav class="main-navigation">
            <ul>
                <li><a href="../hooks/hooks.html">Hooks Reference</a></li>
                <li><a href="https://docs.wpgeodirectory.com/">Documentation</a></li>
                <li><a href="https://woocommerce.github.io/woocommerce-rest-api-docs/">REST API Docs</a></li>
                <li><a href="https://ayecode.io/careers/" target="_blank">We're hiring!</a></li>
            </ul>
        </nav>
    </section>
</header>

<div class="phpdocumentor-header">
    <section class="phpdocumentor-section">
        <h1 class="phpdocumentor-title">Geodirectory Code Reference</h1>
        <section class="phpdocumentor-search">
    <label class="phpdocumentor-label">
        <span class="visually-hidden">Search (click ESC to close search results)</span>
        <input id="autoComplete" tabindex="1" type="search" class="phpdocumentor-field phpdocumentor-search__field" placeholder="Loading..." disabled />
    </label>
</section>

    </section>
</div>

    <main class="phpdocumentor">
        <div class="phpdocumentor-section">
            <aside class="phpdocumentor-column -four phpdocumentor-sidebar">
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Namespaces</h2>
                                <h3 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/default.html"><abbr title="\">Global</abbr></a></h3>
                                        <h4 class="phpdocumentor-sidebar__root-namespace"><a href="../namespaces/elementorpro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h4>
                <ul class="phpdocumentor-list">
                                            <li><a href="../namespaces/elementorpro-modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                                    </ul>
                        </section>

        <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Packages</h2>
                    <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/Geodirectory.html"><abbr title="\Geodirectory">Geodirectory</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectory.html"><abbr title="\GeoDirectory">GeoDirectory</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/GeoDirectory-Templates.html"><abbr title="\GeoDirectory\Templates">Templates</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAbstracts.html"><abbr title="\GeoDirectoryAbstracts">GeoDirectoryAbstracts</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAPI.html"><abbr title="\GeoDirectoryAPI">GeoDirectoryAPI</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClasses.html"><abbr title="\GeoDirectoryClasses">GeoDirectoryClasses</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminFunctions.html"><abbr title="\GeoDirectoryAdminFunctions">GeoDirectoryAdminFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoruAdmin.html"><abbr title="\GeoDirectoruAdmin">GeoDirectoruAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdmin.html"><abbr title="\GeoDirectoryAdmin">GeoDirectoryAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirAdmin.html"><abbr title="\GeoDirAdmin">GeoDirAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectroyAdmin.html"><abbr title="\GeoDirectroyAdmin">GeoDirectroyAdmin</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminSystemStatus.html"><abbr title="\GeoDirectoryAdminSystemStatus">GeoDirectoryAdminSystemStatus</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminTools.html"><abbr title="\GeoDirectoryAdminTools">GeoDirectoryAdminTools</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryAdminWidgets.html"><abbr title="\GeoDirectoryAdminWidgets">GeoDirectoryAdminWidgets</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesEmails.html"><abbr title="\GeoDirectoryClassesEmails">GeoDirectoryClassesEmails</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryClassesData.html"><abbr title="\GeoDirectoryClassesData">GeoDirectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDIrectoryClassesData.html"><abbr title="\GeoDIrectoryClassesData">GeoDIrectoryClassesData</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/ElementorPro.html"><abbr title="\ElementorPro">ElementorPro</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/ElementorPro-Modules.html"><abbr title="\ElementorPro\Modules">Modules</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryFunctions.html"><abbr title="\GeoDirectoryFunctions">GeoDirectoryFunctions</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryparamarraytermsAnarrayoftermobjects.html"><abbr title="\GeoDirectoryparamarraytermsAnarrayoftermobjects">GeoDirectoryparamarraytermsAnarrayoftermobjects</abbr></a></h3>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/WP.html"><abbr title="\WP">WP</abbr></a></h3>
                        <ul class="phpdocumentor-list">
                                    <li><a href="../packages/WP-Background.html"><abbr title="\WP\Background">Background</abbr></a></li>
                            </ul>
                                <h3 class="phpdocumentor-sidebar__root-package"><a href="../packages/GeoDirectoryTemplates.html"><abbr title="\GeoDirectoryTemplates">GeoDirectoryTemplates</abbr></a></h3>
                        </section>
    
    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Reports</h2>
                <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/deprecated.html">Deprecated</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/errors.html">Errors</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../reports/markers.html">Markers</a></h3>
    </section>

    <section class="phpdocumentor-sidebar__category">
        <h2 class="phpdocumentor-sidebar__category-header">Indices</h2>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../indices/files.html">Files</a></h3>
        <h3 class="phpdocumentor-sidebar__root-package"><a href="../hooks/hooks.html">Hooks Reference</a></h3>
    </section>
</aside>

            <div class="phpdocumentor-column -eight phpdocumentor-content">
                    <ul class="phpdocumentor-breadcrumbs">
    </ul>

    <article class="phpdocumentor-element -file">
        <h2 class="phpdocumentor-content__title">class-geodir-admin-dummy-data.php</h2>

                

        
                    <h3 class="phpdocumentor-elements__header" id="source-code">
                Source code
                <a href="#source-code" class="headerlink"><i class="fas fa-link"></i></a>
            </h3>
            <pre id="source-view" tabindex="-1" class="language-php line-numbers linkable-line-numbers"><code>&lt;?php
/**
 * GeoDirectory class for adding dummy data.
 *
 * @author   AyeCode
 * @category Admin
 * @package  GeoDirectory/Admin
 * @version  2.0.0
 */

if ( ! defined( &#039;ABSPATH&#039; ) ) {
	exit;
}


/**
 * GeoDir_Admin_Dummy_Data Class.
 */
class GeoDir_Admin_Dummy_Data {

	/**
	 * Hook in tabs.
	 */
	public function __construct() {

	}
	
	public static function create_sort_fields(){
		
	}

	/**
	 * Default taxonomies
	 *
	 * Adds the default terms for taxonomies - placecategory. Modify at your own risk.
	 *
	 * @since 2.0.0
	 * @package GeoDirectory
	 */
	public static function create_taxonomies( $post_type, $categories ) {

		$uploads = wp_upload_dir(); // Array of key =&gt; value pairs

		if(!empty($categories)){
			foreach($categories as $slug =&gt; $category ){

				// If term exists just continue to the next one
				if ( term_exists( $category[&#039;name&#039;], $post_type . &#039;category&#039; ) ) { continue; }

				$args = array();
				// add parent id if present
				if(!empty($category[&#039;parent-name&#039;])){
					$parent = get_term_by( &#039;name&#039;, $category[&#039;parent-name&#039;], $post_type . &#039;category&#039;);
					if(!empty($parent-&gt;term_id)){
						$args[&#039;parent&#039;] = absint($parent-&gt;term_id);
					}
				}

				// insert the category
				$category_return = wp_insert_term( $category[&#039;name&#039;], $post_type . &#039;category&#039;,$args );

				if(is_wp_error($category_return)){
					geodir_error_log($category_return-&gt;get_error_message(), &#039;dummy_data&#039;, __FILE__, __LINE__ );
				}else {

					// attach the meta data
					if ( isset( $category_return[&#039;term_id&#039;] ) ) {
						// schema
						if ( ! empty( $category[&#039;schema_type&#039;] ) ) {
							update_term_meta( $category_return[&#039;term_id&#039;], &#039;ct_cat_schema&#039;, $category[&#039;schema_type&#039;] );
						}

						// font icon
						if ( ! empty( $category[&#039;font_icon&#039;] ) ) {
							update_term_meta( $category_return[&#039;term_id&#039;], &#039;ct_cat_font_icon&#039;, $category[&#039;font_icon&#039;] );
						}

						// color
						if ( ! empty( $category[&#039;color&#039;] ) ) {
							update_term_meta( $category_return[&#039;term_id&#039;], &#039;ct_cat_color&#039;, $category[&#039;color&#039;] );
						}
					}

					// attach the icon
					if ( ! empty( $category[&#039;icon&#039;] ) &amp;&amp; isset( $category_return[&#039;term_id&#039;] ) ) {
						$uploaded = (array) GeoDir_Media::get_external_media( $category[&#039;icon&#039;] );


						if ( ! empty( $uploaded[&#039;error&#039;] ) ) {
							continue;
						}

						if ( empty( $uploaded[&#039;file&#039;] ) ) {
							continue;
						}

						$wp_filetype = wp_check_filetype( basename( $uploaded[&#039;file&#039;] ), null );

						$attachment = array(
							&#039;guid&#039;           =&gt; $uploads[&#039;baseurl&#039;] . &#039;/&#039; . basename( $uploaded[&#039;file&#039;] ),
							&#039;post_mime_type&#039; =&gt; $wp_filetype[&#039;type&#039;],
							&#039;post_title&#039;     =&gt; preg_replace( &#039;/\.[^.]+$/&#039;, &#039;&#039;, basename( $uploaded[&#039;file&#039;] ) ),
							&#039;post_content&#039;   =&gt; &#039;&#039;,
							&#039;post_status&#039;    =&gt; &#039;inherit&#039;
						);
						$attach_id  = wp_insert_attachment( $attachment, $uploaded[&#039;file&#039;] );

						// you must first include the image.php file
						// for the function wp_generate_attachment_metadata() to work
						require_once( ABSPATH . &#039;wp-admin/includes/image.php&#039; );
						$attach_data = wp_generate_attachment_metadata( $attach_id, $uploaded[&#039;file&#039;] );
						wp_update_attachment_metadata( $attach_id, $attach_data );

						if ( isset( $attach_data[&#039;file&#039;] ) ) {
							update_term_meta( $category_return[&#039;term_id&#039;], &#039;ct_cat_icon&#039;, array( &#039;id&#039;  =&gt; $attach_id,
							                                                                     &#039;src&#039; =&gt; $attach_data[&#039;file&#039;]
							) );
						}

					}

					// attach category default image
					if ( ! empty( $category[&#039;default_img&#039;] ) &amp;&amp; isset( $category_return[&#039;term_id&#039;] ) ) {
						$uploaded = (array) GeoDir_Media::get_external_media( $category[&#039;default_img&#039;] );


						if ( ! empty( $uploaded[&#039;error&#039;] ) ) {
							continue;
						}

						if ( empty( $uploaded[&#039;file&#039;] ) ) {
							continue;
						}

						$wp_filetype = wp_check_filetype( basename( $uploaded[&#039;file&#039;] ), null );

						$attachment = array(
							&#039;guid&#039;           =&gt; $uploads[&#039;baseurl&#039;] . &#039;/&#039; . basename( $uploaded[&#039;file&#039;] ),
							&#039;post_mime_type&#039; =&gt; $wp_filetype[&#039;type&#039;],
							&#039;post_title&#039;     =&gt; preg_replace( &#039;/\.[^.]+$/&#039;, &#039;&#039;, basename( $uploaded[&#039;file&#039;] ) ),
							&#039;post_content&#039;   =&gt; &#039;&#039;,
							&#039;post_status&#039;    =&gt; &#039;inherit&#039;
						);
						$attach_id  = wp_insert_attachment( $attachment, $uploaded[&#039;file&#039;] );

						// you must first include the image.php file
						// for the function wp_generate_attachment_metadata() to work
						require_once( ABSPATH . &#039;wp-admin/includes/image.php&#039; );
						$attach_data = wp_generate_attachment_metadata( $attach_id, $uploaded[&#039;file&#039;] );
						wp_update_attachment_metadata( $attach_id, $attach_data );

						if ( isset( $attach_data[&#039;file&#039;] ) ) {
							update_term_meta( $category_return[&#039;term_id&#039;], &#039;default_img&#039;, array( &#039;id&#039;  =&gt; $attach_id,
							                                                                     &#039;src&#039; =&gt; $attach_data[&#039;file&#039;]
							) );
						}

					}

				}

			}

			if ( isset( $_REQUEST[&#039;data_type&#039;] ) ) {
				// set the dummy data type
				geodir_update_option( $post_type . &#039;_dummy_data_type&#039;, esc_attr($_REQUEST[&#039;data_type&#039;]) );
			}

			// rebuild the icon cache
			geodir_get_term_icon_rebuild();
		}

		return true;
	}

    /**
     * Create dummy fields.
     *
     * @since 2.0.0
     *
     * @param array $fields Dummy fields values.
     */
	public static function create_dummy_fields( $fields ) {

		/**
		 * Filter the array of default custom fields DB table data.
		 *
		 * @since 1.0.0
		 *
		 * @param string $fields The default custom fields as an array.
		 */
		$fields = apply_filters( &#039;geodir_before_dummy_custom_fields_saved&#039;, $fields );
		foreach ( $fields as $field_index =&gt; $field ) {
			geodir_custom_field_save( $field );

		}
	}

	/**
	 * Deletes GeoDirectory dummy data.
	 *
	 * @since 1.0.0
	 * @package GeoDirectory
	 * @global object $wpdb WordPress Database object.
	 * @global string $plugin_prefix Geodirectory plugin table prefix.
	 */
	public static function delete_dummy_posts( $post_type ) {
		global $wpdb, $plugin_prefix;


		$post_ids = $wpdb-&gt;get_results( &quot;SELECT post_id FROM &quot; . $plugin_prefix . $post_type . &quot;_detail WHERE post_dummy=&#039;1&#039;&quot; );


		foreach ( $post_ids as $post_ids_obj ) {
			wp_delete_post( $post_ids_obj-&gt;post_id );
		}

		//double check posts are deleted
		$wpdb-&gt;get_results( &quot;DELETE FROM &quot; . $plugin_prefix . $post_type . &quot;_detail WHERE post_dummy=&#039;1&#039;&quot; );

		geodir_update_option( $post_type . &#039;_dummy_data_type&#039;, &#039;&#039; );
	}

    /**
     * Add dummy address.
     *
     * @since 2.0.0
     *
     * @param array $post_info Optional. Post Information. Default array().
     * @return array $post_info.
     */
	public static function add_dummy_address($post_info = array()){
		global $city_bound_lat1, $city_bound_lng1, $city_bound_lat2, $city_bound_lng2,$geodirectory;

		$default_location = $geodirectory-&gt;location-&gt;get_default_location();
		if ( $city_bound_lat1 &gt; $city_bound_lat2 ) {
			$dummy_post_latitude = geodir_random_float( geodir_random_float( $city_bound_lat1, $city_bound_lat2 ), geodir_random_float( $city_bound_lat2, $city_bound_lat1 ) );
		} else {
			$dummy_post_latitude = geodir_random_float( geodir_random_float( $city_bound_lat2, $city_bound_lat1 ), geodir_random_float( $city_bound_lat1, $city_bound_lat2 ) );
		}


		if ( $city_bound_lng1 &gt; $city_bound_lng2 ) {
			$dummy_post_longitude = geodir_random_float( geodir_random_float( $city_bound_lng1, $city_bound_lng2 ), geodir_random_float( $city_bound_lng2, $city_bound_lng1 ) );
		} else {
			$dummy_post_longitude = geodir_random_float( geodir_random_float( $city_bound_lng2, $city_bound_lng1 ), geodir_random_float( $city_bound_lng1, $city_bound_lng2 ) );
		}

		$api = GeoDir_Maps::active_map();
		/**
		 * Filter the API used for Geocode service.
		 *
		 * @since 2.0.0.68
		 *
		 * @param string $api The API used for Geocode service.
		 */
		$api = apply_filters( &#039;geodir_post_address_from_gps_api&#039;, $api );

		if ( $api == &#039;osm&#039; ) {
			$post_address = geodir_get_osm_address_by_lat_lan( $dummy_post_latitude, $dummy_post_longitude );
		} else {
			$post_address = geodir_get_address_by_lat_lan( $dummy_post_latitude, $dummy_post_longitude );
		}

		$postal_code = &#039;&#039;;
		if ( ! empty( $post_address ) ) {
			if ( $api == &#039;osm&#039; ) {
				$address     = ! empty( $post_address-&gt;formatted_address ) ? $post_address-&gt;formatted_address : &#039;&#039;;
				$postal_code = ! empty( $post_address-&gt;address-&gt;postcode ) ? $post_address-&gt;address-&gt;postcode : &#039;&#039;;
			} else {
				$addresses         = array();
				$addresses_default = array();

				foreach ( $post_address as $add_key =&gt; $add_value ) {
					if ( $add_key &lt; 2 &amp;&amp; ! empty( $add_value-&gt;long_name ) ) {
						$addresses_default[] = $add_value-&gt;long_name;
					}
					if ( $add_value-&gt;types[0] == &#039;postal_code&#039; ) {
						$postal_code = $add_value-&gt;long_name;
					}
					if ( $add_value-&gt;types[0] == &#039;street_number&#039; ) {
						$addresses[] = $add_value-&gt;long_name;
					}
					if ( $add_value-&gt;types[0] == &#039;route&#039; ) {
						$addresses[] = $add_value-&gt;long_name;
					}
					if ( $add_value-&gt;types[0] == &#039;neighborhood&#039; ) {
						$addresses[] = $add_value-&gt;long_name;
					}
					if ( $add_value-&gt;types[0] == &#039;sublocality&#039; ) {
						$addresses[] = $add_value-&gt;long_name;
					}
				}
				$address = ! empty( $addresses ) ? implode( &#039;, &#039;, $addresses ) : ( ! empty( $addresses_default ) ? implode( &#039;, &#039;, $addresses_default ) : &#039;&#039; );
			}

			$post_info[&#039;street&#039;]   = ! empty( $address ) ? $address : $default_location-&gt;city;
			$post_info[&#039;city&#039;]      = $default_location-&gt;city;
			$post_info[&#039;region&#039;]    = $default_location-&gt;region;
			$post_info[&#039;country&#039;]   = $default_location-&gt;country;
			$post_info[&#039;zip&#039;]       = $postal_code;
			$post_info[&#039;latitude&#039;]  = $dummy_post_latitude;
			$post_info[&#039;longitude&#039;] = $dummy_post_longitude;
		}else{
			$post_info[&#039;street&#039;]   = &quot;123 &quot;.$default_location-&gt;city;
			$post_info[&#039;city&#039;]      = $default_location-&gt;city;
			$post_info[&#039;region&#039;]    = $default_location-&gt;region;
			$post_info[&#039;country&#039;]   = $default_location-&gt;country;
			$post_info[&#039;zip&#039;]       = $postal_code;
			$post_info[&#039;latitude&#039;]  = $dummy_post_latitude;
			$post_info[&#039;longitude&#039;] = $dummy_post_longitude;
		}

		return $post_info;
	}

	/**
	 * Inserts GeoDirectory dummy posts.
	 *
	 * @since 1.0.0
	 * @package GeoDirectory
	 * @global object $wpdb WordPress Database object.
	 * @global object $current_user Current user object.
	 */
	public static function create_dummy_posts( $request ) {

		global $city_bound_lat1, $city_bound_lng1, $city_bound_lat2, $city_bound_lng2,$dummy_post_index,$dummy_image_url,$plugin_prefix, $dummy_categories, $dummy_custom_fields, $dummy_posts,$dummy_sort_fields,$dummy_page_templates;

		$city_bound_lat1 = $request[&#039;city_bound_lat1&#039;];
		$city_bound_lng1 = $request[&#039;city_bound_lng1&#039;];
		$city_bound_lat2 = $request[&#039;city_bound_lat2&#039;];
		$city_bound_lng2 = $request[&#039;city_bound_lng2&#039;];
		$post_type = sanitize_key($request[&#039;post_type&#039;]);
		$item_index = absint($request[&#039;dummy_post_index&#039;]);
		$data_type = sanitize_key($request[&#039;data_type&#039;]);
		$update_templates = absint($request[&#039;update_templates&#039;]);

		ini_set( &#039;max_execution_time&#039;, 999999 ); // @codingStandardsIgnoreLine //300 seconds = 5 minutes
		$data_types = self::dummy_data_types($post_type);

		$total_count = 0;
		$dummy_post_index = $item_index;
		
		$dummy_categories = array();
		$dummy_custom_fields = array();
		$dummy_sort_fields = array();
		$dummy_posts = array();
		$dummy_page_templates = array();
		$dummy_image_url = &#039;&#039;;
		foreach ( $data_types as $key =&gt; $val ) {
			if ( $key == $data_type ) {
				$total_count = $val[&#039;count&#039;];
				if ( $key == &#039;standard_places&#039; ) {
					/**
					 * Contains dummy post content.
					 *
					 * @since 1.0.0
					 * @package GeoDirectory
					 */
					include_once( &#039;dummy-data/standard_places.php&#039; );
				} elseif ( $key == &#039;property_sale&#039; ) {
					add_filter( &#039;geodir_extra_custom_fields&#039;, &#039;geodir_extra_custom_fields_&#039; . $key, 10, 3 );

					/**
					 * Contains dummy property for sale post content.
					 *
					 * @since 1.6.11
					 * @package GeoDirectory
					 */
					include_once( &#039;dummy-data/property_sale.php&#039; );
				} elseif ( $key == &#039;property_rent&#039; ) {
					add_filter( &#039;geodir_extra_custom_fields&#039;, &#039;geodir_extra_custom_fields_&#039; . $key, 10, 3 );

					/**
					 * Contains dummy property for sale post content.
					 *
					 * @since 1.6.11
					 * @package GeoDirectory
					 */
					include_once( &#039;dummy-data/property_rent.php&#039; );
				}  elseif ( $key == &#039;classifieds&#039; ) {
					add_filter( &#039;geodir_extra_custom_fields&#039;, &#039;geodir_extra_custom_fields_&#039; . $key, 10, 3 );

					/**
					 * Contains dummy property for classifieds.
					 *
					 * @since 2.0.0.59
					 * @package GeoDirectory
					 */
					include_once( &#039;dummy-data/classifieds.php&#039; );
				} elseif ( $key == &#039;freelancer&#039; ) {
                    add_filter( &#039;geodir_extra_custom_fields&#039;, &#039;geodir_extra_custom_fields_&#039; . $key, 10, 3 );

                    /**
                     * Contains dummy data for freelancers.
                     *
                     * @since 2.0.0.59
                     * @package GeoDirectory
                     */
                    include_once( &#039;dummy-data/freelancer.php&#039; );
                } else {
					do_action( &#039;geodir_dummy_data_include_file&#039;, $post_type, $data_type, $val, $item_index );
				}
			}

			$dummy_image_url = apply_filters( &#039;dummy_image_url&#039;, $dummy_image_url,$post_type, $data_type, $item_index );

			/**
			 * Fires action before each dummy data item.
			 * 
			 * @since 2.0.0
			 * 
			 */
			do_action( &#039;geodir_insert_dummy_data_loop&#039;, $post_type, $data_type, $item_index );
		}
		
		// Do the data insert
		if($dummy_post_index === 0){

			// insert the dummy data column
			geodir_add_column_if_not_exist( $plugin_prefix . $post_type . &quot;_detail&quot;, &#039;post_dummy&#039;, &quot;TINYINT(1) NULL DEFAULT &#039;0&#039;&quot; );

			// insert custom fields
			if( !empty($dummy_custom_fields) ){
				foreach ($dummy_custom_fields as $field_index =&gt; $field) {
					geodir_custom_field_save($field);
				}
			}

			// insert sort fields
			if( !empty($dummy_sort_fields) ){
				foreach ($dummy_sort_fields as $field_index =&gt; $field) {
					GeoDir_Settings_Cpt_Sorting::save_custom_field($field);
				}
			}

			// insert categories
			if( !empty($dummy_categories) ){
				self::create_taxonomies( $post_type, $dummy_categories );
			}

			// maybe update templates
			if($update_templates &amp;&amp; !empty($dummy_page_templates)){
				self::set_page_templates($post_type,$dummy_page_templates);
			}

			return true;

		} else { // if index is not 0 then we are starting on posts.
			$post_index = $item_index - 1; // arrays start with 0

			if ( ! empty( $dummy_posts ) &amp;&amp; isset( $dummy_posts[ $post_index ] ) ) {
				$post_info = $dummy_posts[ $post_index ];
				if ( GeoDir_Post_types::supports( $post_type, &#039;location&#039; ) ) {
					$post_info = self::add_dummy_address( $post_info );
				}

				// Set the status to publish
				if ( isset( $post_info[&#039;post_dummy&#039;] ) &amp;&amp; $post_info[&#039;post_dummy&#039;] &amp;&amp; ! isset( $post_info[&#039;post_status&#039;] ) ) {
					$post_info[&#039;post_status&#039;] = &#039;publish&#039;;
				}

				wp_insert_post( $post_info, true ); // we hook into the save_post hook
			}
		}

		// delete image cache on last entry
		if ( $total_count == $item_index ) {
			delete_transient( &#039;cached_dummy_images&#039; );
			flush_rewrite_rules();
		}
	}

	/**
	 * Update the template content if set to do so.
	 *
	 * @param $post_type
	 * @param $page_templates
	 */
	public static function set_page_templates($post_type,$page_templates){
		if(!empty($page_templates)){
			foreach($page_templates as $page =&gt; $content){
				$page_id = 0;
				if($page==&#039;archive_item&#039;){
					$page_id = geodir_archive_item_page_id($post_type);
				}

				if($page_id &amp;&amp; $content){
					$args = array(
						&#039;ID&#039;           =&gt; $page_id,
						&#039;post_content&#039; =&gt; $content
					);
					wp_update_post( $args );
				}
			}
		}
	}

	/**
	 * GeoDirectory dummy data installation.
	 *
	 * @since 1.0.0
	 * @package GeoDirectory
	 * @global object $wpdb WordPress Database object.
	 * @global string $plugin_prefix Geodirectory plugin table prefix.
	 *
	 * @param string $post_type The post type.
	 */
	public static function dummy_data_ui() {
		wp_enqueue_script( &#039;jquery-ui-progressbar&#039; );
		global $wpdb, $plugin_prefix,$geodirectory;

		if ( ! $geodirectory-&gt;location-&gt;is_default_location_set() ) {
			echo &#039;&lt;div class=&quot;updated fade&quot;&gt;&lt;p&gt;&lt;strong&gt;&#039; . sprintf( __( &#039;Please %sclick here%s to set a default location, this will help to set location of all dummy data.&#039;, &#039;geodirectory&#039; ), &#039;&lt;a href=\&#039;&#039; . admin_url( &#039;admin.php?page=geodirectory&amp;tab=default_location_settings&#039; ) . &#039;\&#039;&gt;&#039;, &#039;&lt;/a&gt;&#039; ) . &#039;&lt;/strong&gt;&lt;/p&gt;&lt;/div&gt;&#039;;
		} else {

			?&gt;
			&lt;table class=&quot;form-table gd-dummy-table table table-borderless table-sm gd-dummy-data&quot;&gt;
				&lt;tbody&gt;
				&lt;tr&gt;
					&lt;td&gt;&lt;strong&gt;&lt;?php _e( &#039;CPT&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/strong&gt;&lt;/td&gt;
					&lt;td&gt;&lt;strong&gt;&lt;?php _e( &#039;Data Type&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/strong&gt;&lt;/td&gt;
					&lt;td class=&quot;text-right invisible&quot;&gt;&lt;strong&gt;&lt;?php _e( &#039;Action&#039;, &#039;geodirectory&#039; ); ?&gt;&lt;/strong&gt;&lt;/td&gt;
				&lt;/tr&gt;

				&lt;?php

				$cpts = geodir_get_posttypes( &#039;array&#039; );

				$nonce = wp_create_nonce( &#039;geodir_dummy_data&#039; );

				foreach ( $cpts as $post_type =&gt; $cpt ) {

					$data_types = self::dummy_data_types( $post_type );

					$set_dt = geodir_get_option( $post_type . &#039;_dummy_data_type&#039; );

					$count = 30;

					if(geodir_column_exist($plugin_prefix . $post_type . &quot;_detail&quot;, &quot;post_dummy&quot;)){
						$post_counts = $wpdb-&gt;get_var( &quot;SELECT count(post_id) FROM &quot; . $plugin_prefix . $post_type . &quot;_detail WHERE post_dummy=&#039;1&#039;&quot; );
					}else{
						$post_counts = 0;
					}


					echo &quot;&lt;tr&gt;&quot;;
					echo &quot;&lt;td&gt;&lt;strong&gt;&quot; . $cpt[&#039;labels&#039;][&#039;name&#039;] . &quot;&lt;/strong&gt;&lt;/td&gt;&quot;;


					$select_disabled = $post_counts &gt; 0 ? &#039;disabled&#039; : &#039;&#039;;
					echo &quot;&lt;td class=&#039;d-flex flex-row&#039;&gt;&quot;;
					echo &quot;&lt;select title=&#039;&quot;.__( &quot;Select the data type&quot;, &quot;geodirectory&quot; ).&quot;&#039; data-toggle=\&quot;tooltip\&quot; id=&#039;&quot; . $post_type . &quot;_data_type&#039; onchange=&#039;geodir_dummy_set_count(this,\&quot;$post_type\&quot;);&#039; $select_disabled class=&#039;flex-fill form-control form-control-sm&#039; style=&#039;min-width:180px&#039;&gt;&quot;;

					$c = 0;
					foreach ( $data_types as $key =&gt; $val ) {
						$c++;
						$selected = ( $key == $set_dt ) ? &quot;selected=&#039;selected&#039;&quot; : &#039;&#039;;
						if ( $selected || $c == 1 ) {
							$count = $val[&#039;count&#039;];
						}
						echo &quot;&lt;option $selected value=&#039;$key&#039; data-count=&#039;&quot; . $val[&#039;count&#039;] . &quot;&#039;&gt;&quot; . $val[&#039;name&#039;] . &quot;&lt;/option&gt;&quot;;
					}
					echo &quot;&lt;/select&gt;&quot;;

					$select_display = $post_counts &gt; 0 ? &#039;display:none;&#039; : &#039;&#039;;
					echo &quot;&lt;span title=&#039;&quot;.__( &quot;Set the number of listings&quot;, &quot;geodirectory&quot; ).&quot;&#039; data-toggle=\&quot;tooltip\&quot; class=&#039;gd-data-type-count flex-shrink-1 flex-fill ml-1&#039; style=&#039;$select_display&#039;&gt;&lt;select id=&#039;&quot; . $post_type . &quot;_data_type_count&#039; style=&#039;min-width:65px;&#039; class=&#039;form-control form-control-sm &#039;&gt;&quot;;
					$x = 1;
					while ( $x &lt;= $count ) {
						$selected = ( $x == $count ) ? &quot;selected=&#039;selected&#039;&quot; : &#039;&#039;;
						echo &quot;&lt;option $selected value=&#039;$x&#039;&gt;&quot; . $x . &quot;&lt;/option&gt;&quot;;
						$x ++;
					}
					echo &quot;&lt;/select&gt;&lt;/span&gt;&quot;;

					// Page templates styles
					echo &quot;&lt;span title=&#039;&quot;.__( &quot;Overwrite the template designs to suit the data type&quot;, &quot;geodirectory&quot; ).&quot;&#039; data-toggle=\&quot;tooltip\&quot; class=&#039;gd-data-type-templates ml-1 flex-fill&#039; style=&#039;$select_display&#039;&gt;&quot;;
					echo &quot;&lt;label&gt;&quot;;
//					echo &quot;&lt;input value=&#039;1&#039; style=&#039;width: auto;height: 16px;&#039; id=&#039;&quot; . $post_type . &quot;_data_type_templates&#039; type=&#039;checkbox&#039; name=&#039;gd-data-templates&#039; checked /&gt;&quot;.__(&quot;(Update page templates)&quot;,&quot;geodirectory&quot;);
					echo &quot;&lt;select style=&#039;&#039;  id=&#039;&quot; . $post_type . &quot;_data_type_templates&#039; name=&#039;gd-data-templates&#039; class=&#039;form-control form-control-sm&#039;&gt;&quot;;
					echo &quot;&lt;option value=&#039;1&#039;&gt;&quot;.__(&quot;Update page templates&quot;,&quot;geodirectory&quot;).&quot;&lt;/option&gt;&quot;;
					echo &quot;&lt;option value=&#039;0&#039;&gt;&quot;.__(&quot;Do not update page templates&quot;,&quot;geodirectory&quot;).&quot;&lt;/option&gt;&quot;;
					echo &quot;&lt;/select&gt;&quot;;
					echo &quot;&lt;/label&gt;&quot;;
					echo &quot;&lt;/span&gt;&quot;;

					echo &quot;&lt;/td&gt;&quot;;


					if ( $post_counts &gt; 0 ) {
						echo &#039;&lt;td class=&quot;text-right&quot;&gt;&lt;input type=&quot;button&quot; value=&quot;&#039; . __( &#039;Remove posts&#039;, &#039;geodirectory&#039; ) . &#039;&quot; class=&quot;btn btn-danger btn-sm geodir_dummy_button gd-remove-data&quot; onclick=&quot;gdInstallDummyData(this,\&#039;&#039; . $nonce . &#039;\&#039;,\&#039;&#039; . $post_type . &#039;\&#039;); return false;&quot; &gt;&lt;/td&gt;&#039;;
					} else {
						echo &#039;&lt;td class=&quot;text-right&quot;&gt;&lt;input type=&quot;button&quot; value=&quot;&#039; . __( &#039;Insert posts&#039;, &#039;geodirectory&#039; ) . &#039;&quot; class=&quot;btn btn-primary btn-sm geodir_dummy_button&quot; onclick=&quot;gdInstallDummyData(this,\&#039;&#039; . $nonce . &#039;\&#039;,\&#039;&#039; . $post_type . &#039;\&#039;); return false;&quot; &gt;&lt;/td&gt;&#039;;
					}

					echo &quot;&lt;/tr&gt;&quot;;
					//print_r($cpt);
				}

				?&gt;
				&lt;/tbody&gt;
			&lt;/table&gt;
			&lt;?php


			$default_location = $geodirectory-&gt;location-&gt;get_default_location();

			//echo &#039;###&#039;;print_r($default_location );
			$city           = isset( $default_location-&gt;city ) ? $default_location-&gt;city : &#039;&#039;;
			$region         = isset( $default_location-&gt;region ) ? $default_location-&gt;region : &#039;&#039;;
			$country        = isset( $default_location-&gt;country ) ? $default_location-&gt;country : &#039;&#039;;
			$city_latitude  = isset( $default_location-&gt;latitude ) ? $default_location-&gt;latitude : &#039;&#039;;
			$city_longitude = isset( $default_location-&gt;longitude ) ? $default_location-&gt;longitude : &#039;&#039;;
			?&gt;
			&lt;script type=&quot;text/javascript&quot;&gt;

				/**
				 * Prevent navigation away if installing dummy data.
				 */
				var geodir_installing_dummy_data = false;
				window.onbeforeunload = function() {
					return geodir_installing_dummy_data  ? &quot;&lt;?php esc_attr_e( &#039;Dummy data has not fully installed yet!&#039;, &#039;geodirectory&#039; ); ?&gt;&quot; : null;
				};

				function geodir_dummy_set_count(data, cpt) {

					var dateTypeCount = jQuery(data).find(&#039;:selected&#039;).data(&#039;count&#039;);

					var optionsAsString = &quot;&quot;;
					for (var i = 0; i &lt; dateTypeCount; i++) {
						var v = i + 1;
						var selected = v == dateTypeCount ? &#039;selected&#039; : &#039;&#039;;
						optionsAsString += &quot;&lt;option value=&#039;&quot; + v + &quot;&#039; &quot; + selected + &quot;&gt;&quot; + v + &quot;&lt;/option&gt;&quot;;
					}
					jQuery(&#039;#&#039; + cpt + &#039;_data_type_count&#039;).empty().append(optionsAsString);

				}

				var CITY_ADDRESS = &#039;&lt;?php echo addslashes( $city . &#039;,&#039; . $region . &#039;,&#039; . $country );?&gt;&#039;;
				var bound_lat_lng;
				var latlng = [&#039;&lt;?php echo $city_latitude; ?&gt;&#039;, &lt;?php echo $city_longitude; ?&gt;];
				var lat = &lt;?php echo $city_latitude; ?&gt;;
				var lng = &lt;?php echo $city_longitude; ?&gt;;

				jQuery(document).ready(function () {
					var geocoder = window.gdMaps == &#039;google&#039; ? new google.maps.Geocoder() : null;
					if (window.gdMaps == &#039;google&#039;) {
						console.log(&#039;gmaps&#039;);
						latlng = new google.maps.LatLng(lat, lng);

						geocoder.geocode({&#039;address&#039;: CITY_ADDRESS},
							function (results, status) {
								if (status == google.maps.GeocoderStatus.OK) {
									// Bounds for North America
									if (results[0].geometry.bounds == null) {
										bound_lat_lng1 = String(results[0].geometry.viewport.getSouthWest());
										bound_lat_lng1 = bound_lat_lng1.replace(/[()]/g, &quot;&quot;);
										bound_lat_lng2 = String(results[0].geometry.viewport.getNorthEast());
										bound_lat_lng2 = bound_lat_lng2.replace(/[()]/g, &quot;&quot;);
										bound_lat_lng2 = bound_lat_lng1 + &quot;,&quot; + bound_lat_lng2;
										bound_lat_lng = bound_lat_lng2.split(&#039;,&#039;);
									} else {
										bound_lat_lng = String(results[0].geometry.bounds);
										bound_lat_lng = bound_lat_lng.replace(/[()]/g, &quot;&quot;);
										bound_lat_lng = bound_lat_lng.split(&#039;,&#039;);
									}

									bound_lat_lng = bound_lat_lng.map(function (x) {
										return x.replace(&quot; &quot;, &#039;&#039;);
									}); // remove spaces from lat/lon
								} else {
									alert(&quot;&lt;?php _e( &#039;Geocode was not successful for the following reason:&#039;, &#039;geodirectory&#039; );?&gt; &quot; + status);
								}
							});
					} else if (window.gdMaps == &#039;osm&#039;) {
						console.log(&#039;osm&#039;);
						latlng = L.latLng(lat, lng);

						geocodePositionOSM(false, CITY_ADDRESS, false, false, function (geodata) {
							if (typeof geodata == &#039;object&#039; &amp;&amp; geodata.boundingbox) {
								bound_lat_lng = [geodata.boundingbox[0], geodata.boundingbox[2], geodata.boundingbox[1], geodata.boundingbox[3]];
							} else {
								geocodePositionOSM(latlng, false, false, false, function (geodata) {
									if (typeof geodata == &#039;object&#039; &amp;&amp; geodata.boundingbox) {
										bound_lat_lng = [geodata.boundingbox[0], geodata.boundingbox[2], geodata.boundingbox[1], geodata.boundingbox[3]];
									}
								});
							}
						});
					}
				});

				var dummy_post_index = 0;

				function gdRemoveDummyData(obj, nonce, posttype) {
					if (confirm(&#039;&lt;?php _e( &#039;Are you sure you want to delete dummy data?&#039;, &#039;geodirectory&#039; ); ?&gt;&#039;)) {
						jQuery(obj).prop(&#039;disabled&#039;, true);
						jQuery(&#039;.gd-dummy-data-results-&#039; + posttype).remove();
						jQuery(&#039;&lt;tr class=&quot;gd-dummy-data-results gd-dummy-data-results-&#039; + posttype + &#039;&quot; &gt;&#039; +
							&#039;&lt;td colspan=&quot;3&quot;&gt;&#039; +
							&#039;&lt;div class=&quot;gd_progressbar_container_&#039; + posttype + &#039;  progress&quot; style=&quot;height: 2em;&quot;&gt;&#039; +
							&#039;&lt;div id=&quot;gd_progressbar_dummy&quot; class=&quot;gd_progressbar_&#039; + posttype + &#039; progress-bar bg-success progress-bar-striped progress-bar-animated&quot; style=&quot;height: 2em;&quot;&gt;&lt;/div&gt;&#039; +
							&#039;&lt;div class=&quot;gd-dummy-progress-label w-100 text-center text-dark position-absolute&quot; style=&quot;left:0;height: 2em;padding-top: 5px;&quot;&gt;&lt;/div&gt;&#039; +
							&#039;&lt;/div&gt;&#039; +
							&#039;&lt;/td&gt;&#039; +
							&#039;&lt;/tr&gt;&#039;).insertAfter(jQuery(obj).parents(&#039;tr&#039;));

//						jQuery(&#039;.gd_progressbar_&#039; + posttype).progressbar({value: 0});



						jQuery(&#039;.gd_progressbar_container_&#039; + posttype + &#039; .progress-bar&#039; ).width(0).parent().find(&#039;.gd-dummy-progress-label&#039;).html(  &#039;&lt;i class=&quot;fas fa-circle-notch fa-spin&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; &lt;?php echo esc_attr( __( &#039;Removing data...&#039;, &#039;geodirectory&#039; ) );?&gt;&#039;);




						var data = {
							&#039;action&#039;:           &#039;geodir_delete_dummy_data&#039;,
							&#039;security&#039;:         &#039;&lt;?php echo $nonce;?&gt;&#039;,
							&#039;post_type&#039;:        posttype
						};
						jQuery.post(ajaxurl,
							data,
							function (data) {
								geodir_installing_dummy_data = false;
								jQuery(&#039;.gd_progressbar_container_&#039; + posttype + &#039; .progress-bar&#039; ).removeClass(&#039;progress-bar-striped progress-bar-animated&#039;).width(&#039;100%&#039;).parent().find(&#039;.gd-dummy-progress-label&#039;).html( &#039;&lt;i class=&quot;fas fa-check&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; &lt;?php echo esc_attr( __( &#039;Complete!&#039;, &#039;geodirectory&#039; ) );?&gt;&#039;);
								jQuery(obj).removeClass(&#039;gd-remove-data&#039;);
								jQuery(obj).val(&#039;&lt;?php _e( &#039;Insert data&#039;, &#039;geodirectory&#039; );?&gt;&#039;);
								jQuery(obj).prop(&#039;disabled&#039;, false);
								jQuery(&#039;#&#039; + posttype + &#039;_data_type_count&#039;).closest(&#039;.gd-data-type-count&#039;).show();
								jQuery(&#039;#&#039; + posttype + &#039;_data_type_templates&#039;).closest(&#039;.gd-data-type-templates&#039;).show();
								jQuery(&#039;#&#039; + posttype + &#039;_data_type_count&#039;).prop(&#039;disabled&#039;, false);
								jQuery(&#039;#&#039; + posttype + &#039;_data_type&#039;).prop(&#039;disabled&#039;, false);
								geodir_dummy_set_count(jQuery(&#039;#&#039; + posttype + &#039;_data_type&#039;), posttype);
							});
						return true;
					}
				}


				function gdInstallDummyData(obj, nonce, posttype, insertedCount) {

					geodir_installing_dummy_data = true;

					if (jQuery(obj).hasClass(&#039;gd-remove-data&#039;)) {
						gdRemoveDummyData(obj, nonce, posttype);
						return;
					}

					jQuery(obj).prop(&#039;disabled&#039;, true);
					jQuery(&#039;#&#039; + posttype + &#039;_data_type&#039;).prop(&#039;disabled&#039;, true);
					jQuery(&#039;#&#039; + posttype + &#039;_data_type_count&#039;).prop(&#039;disabled&#039;, true);
					jQuery(&#039;#&#039; + posttype + &#039;_data_type_count&#039;).closest(&#039;.gd-data-type-count&#039;).hide();
					jQuery(&#039;#&#039; + posttype + &#039;_data_type_templates&#039;).closest(&#039;.gd-data-type-templates&#039;).hide();


					if (insertedCount == 0) {
						insertedCount++;
						jQuery(&#039;.gd-dummy-data-results-&#039; + posttype).remove();
					}else if (!insertedCount) {
						insertedCount = 0;
						jQuery(&#039;.gd-dummy-data-results-&#039; + posttype).remove();
					}else{
						insertedCount++;
					}


					var active_tab = jQuery(obj).closest(&#039;form&#039;).find(&#039;dl dd.gd-tab-active&#039;).attr(&#039;id&#039;);
					var dateType = jQuery(&#039;#&#039; + posttype + &#039;_data_type&#039;).val();
					//var dateTypeCount = jQuery(&#039;#&#039;+posttype+&#039;_data_type&#039;).find(&#039;:selected&#039;).data(&#039;count&#039;);
					var dateTypeCount = jQuery(&#039;#&#039; + posttype + &#039;_data_type_count&#039;).val();
					var dateTypeTemplates = jQuery(&#039;#&#039; + posttype + &#039;_data_type_templates&#039;).val();

					var result_container = jQuery(&#039;.gd-dummy-data-results-&#039; + posttype);
					if (!result_container.length) {

						jQuery(&#039;&lt;tr class=&quot;gd-dummy-data-results gd-dummy-data-results-&#039; + posttype + &#039;&quot; &gt;&#039; +
							&#039;&lt;td colspan=&quot;3&quot;&gt;&#039; +
							&#039;&lt;div class=&quot;gd_progressbar_container_&#039; + posttype + &#039;  progress&quot; style=&quot;height: 2em;&quot;&gt;&#039; +
							&#039;&lt;div id=&quot;gd_progressbar_dummy&quot; class=&quot;gd_progressbar_&#039; + posttype + &#039; progress-bar bg-success progress-bar-striped progress-bar-animated&quot; style=&quot;height: 2em;&quot;&gt;&lt;/div&gt;&#039; +
							&#039;&lt;div class=&quot;gd-dummy-progress-label w-100 text-center text-dark position-absolute&quot; style=&quot;left:0;height: 2em;padding-top: 5px;&quot;&gt;&lt;/div&gt;&#039; +
							&#039;&lt;/div&gt;&#039; +
							&#039;&lt;/td&gt;&#039; +
							&#039;&lt;/tr&gt;&#039;).insertAfter(jQuery(obj).parents(&#039;tr&#039;));

//						jQuery(&#039;.gd_progressbar_&#039; + posttype).progressbar({value: 0});

						jQuery(&#039;.gd_progressbar_container_&#039; + posttype + &#039; .progress-bar&#039; ).width(0).parent().find(&#039;.gd-dummy-progress-label&#039;).html( &#039;0% (0 / &#039; + dateTypeCount + &#039;) &lt;i class=&quot;fas fa-circle-notch fa-spin&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; &lt;?php echo esc_attr( __( &#039;Creating categories and custom fields...&#039;, &#039;geodirectory&#039; ) );?&gt;&#039;);
					}

					if (!(typeof bound_lat_lng == &#039;object&#039; &amp;&amp; bound_lat_lng.length == 4)) {
						bound_lat_lng = [&#039;&lt;?php echo $city_latitude; ?&gt;&#039;, &lt;?php echo $city_longitude; ?&gt;, &#039;&lt;?php echo $city_latitude; ?&gt;&#039;, &lt;?php echo $city_longitude; ?&gt;];
					}

//					if(!insertedCount){
//						var dummy_post_index = 0;
//					}else{
//						var dummy_post_index = insertedCount;
//						dummy_post_index++;
//					}


					var data = {
						&#039;action&#039;:           &#039;geodir_insert_dummy_data&#039;,
						&#039;security&#039;:         &#039;&lt;?php echo $nonce;?&gt;&#039;,
						&#039;data_type&#039;:        dateType,
						&#039;post_type&#039;:        posttype,
						&#039;dummy_post_index&#039;: insertedCount,
						&#039;update_templates&#039;: dateTypeTemplates,
						&#039;city_bound_lat1&#039;:  bound_lat_lng[0],
						&#039;city_bound_lng1&#039;:  bound_lat_lng[1],
						&#039;city_bound_lat2&#039;:  bound_lat_lng[2],
						&#039;city_bound_lng2&#039;:  bound_lat_lng[3]
					};
					jQuery.post(ajaxurl,
						data,
						function (data) {
						var percentage = 0;

						if (insertedCount &lt; dateTypeCount) {
							//insertedCount++;
							var percentage = Math.round((insertedCount / dateTypeCount ) * 100);
							percentage = percentage &gt; 100 ? 100 : percentage;

							jQuery(&#039;.gd_progressbar_container_&#039; + posttype + &#039; .progress-bar&#039; ).width(percentage+&quot;%&quot;).parent().find(&#039;.gd-dummy-progress-label&#039;).html( percentage + &#039;% (&#039; + insertedCount + &#039; / &#039; + dateTypeCount + &#039;) &lt;i class=&quot;fas fa-circle-notch fa-spin&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; &lt;?php echo esc_attr( __( &#039;Inserting data...&#039;, &#039;geodirectory&#039; ) );?&gt;&#039;);
							console.log(insertedCount);
							gdInstallDummyData(obj, nonce, posttype, insertedCount);
						}
						else {
							geodir_installing_dummy_data = false;
							percentage = 100;
							jQuery(&#039;.gd_progressbar_container_&#039; + posttype + &#039; .progress-bar&#039; ).removeClass(&#039;progress-bar-striped progress-bar-animated&#039;).width(percentage+&quot;%&quot;).parent().find(&#039;.gd-dummy-progress-label&#039;).html( percentage + &#039;% (&#039; + insertedCount + &#039; / &#039; + dateTypeCount + &#039;) &lt;i class=&quot;fas fa-check&quot; aria-hidden=&quot;true&quot;&gt;&lt;/i&gt; &lt;?php echo esc_attr( __( &#039;Complete!&#039;, &#039;geodirectory&#039; ) );?&gt;&#039;);
							jQuery(obj).addClass(&#039;gd-remove-data&#039;);
							jQuery(obj).val(&#039;&lt;?php _e( &#039;Remove data&#039;, &#039;geodirectory&#039; );?&gt;&#039;);
							jQuery(obj).prop(&#039;disabled&#039;, false);

						}
					});

				}
			&lt;/script&gt;
			&lt;?php
		}
	}

	/**
	 * The types of dummy data available.
	 *
	 * @return array
	 */
	public static function dummy_data_types( $post_type = &#039;gd_place&#039; ) {
		$data = array(
			&#039;standard_places&#039; =&gt; array(
				&#039;name&#039;  =&gt; __( &#039;Default&#039;, &#039;geodirectory&#039; ),
				&#039;count&#039; =&gt; 30
			),
			&#039;property_sale&#039;   =&gt; array(
				&#039;name&#039;  =&gt; __( &#039;Property for sale&#039;, &#039;geodirectory&#039; ),
				&#039;count&#039; =&gt; 10
			),
			&#039;property_rent&#039;   =&gt; array(
				&#039;name&#039;  =&gt; __( &#039;Property for rent&#039;, &#039;geodirectory&#039; ),
				&#039;count&#039; =&gt; 10
			),
			&#039;classifieds&#039;   =&gt; array(
				&#039;name&#039;  =&gt; __( &#039;Classifieds&#039;, &#039;geodirectory&#039; ),
				&#039;count&#039; =&gt; 20,
				&#039;has_templates&#039; =&gt; true
			),
//            &#039;freelancer&#039;   =&gt; array(
//                &#039;name&#039;  =&gt; __( &#039;Freelancer&#039;, &#039;geodirectory&#039; ),
//                &#039;count&#039; =&gt; 20,
//                &#039;has_templates&#039; =&gt; true
//            )
		);

		return apply_filters( &#039;geodir_dummy_data_types&#039;, $data, $post_type );
	}

	/**
	 * The extra fields we use for dummy data.
	 *
	 * @param string $post_type
	 * @param string $package_id
	 *
	 * @return array
	 */
	public static function extra_custom_fields($post_type=&#039;gd_place&#039;,$package_id=&#039;&#039;){
		$fields = array();
		$package = ($package_id==&#039;&#039;) ? &#039;&#039; : array($package_id);

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;VARCHAR&#039;,
		                  &#039;field_type&#039; =&gt; &#039;phone&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Phone&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;You can enter phone number,cell phone number etc.&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; __(&#039;Phone&#039;, &#039;geodirectory&#039;),
		                  &#039;htmlvar_name&#039; =&gt; &#039;phone&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;option_values&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;0&#039;,
		                  &#039;show_in&#039; =&gt;  &#039;[detail],[mapbubble]&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;clabels&#039; =&gt; __(&#039;Phone&#039;, &#039;geodirectory&#039;));

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;VARCHAR&#039;,
		                  &#039;field_type&#039; =&gt; &#039;email&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Email&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;You can enter your business or listing email.&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; __(&#039;Email&#039;, &#039;geodirectory&#039;),
		                  &#039;htmlvar_name&#039; =&gt; &#039;email&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;option_values&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;0&#039;,
		                  &#039;show_in&#039; =&gt; &#039;[detail]&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;clabels&#039; =&gt; __(&#039;Email&#039;, &#039;geodirectory&#039;));

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;TEXT&#039;,
		                  &#039;field_type&#039; =&gt; &#039;url&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Website&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;You can enter your business or listing website.&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; __(&#039;Website&#039;, &#039;geodirectory&#039;),
		                  &#039;htmlvar_name&#039; =&gt; &#039;website&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;option_values&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;0&#039;,
		                  &#039;show_in&#039; =&gt; &#039;[detail]&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;clabels&#039; =&gt; __(&#039;Website&#039;, &#039;geodirectory&#039;));

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;TEXT&#039;,
		                  &#039;field_type&#039; =&gt; &#039;url&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Twitter&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;You can enter your business or listing twitter url.&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; __(&#039;Twitter&#039;, &#039;geodirectory&#039;),
		                  &#039;htmlvar_name&#039; =&gt; &#039;twitter&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;option_values&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;0&#039;,
		                  &#039;show_in&#039; =&gt; &#039;[detail]&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;clabels&#039; =&gt; __(&#039;Twitter&#039;, &#039;geodirectory&#039;));

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;TEXT&#039;,
		                  &#039;field_type&#039; =&gt; &#039;url&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Facebook&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;You can enter your business or listing facebook url.&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; __(&#039;Facebook&#039;, &#039;geodirectory&#039;),
		                  &#039;htmlvar_name&#039; =&gt; &#039;facebook&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;option_values&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;0&#039;,
		                  &#039;show_in&#039; =&gt; &#039;[detail]&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;clabels&#039; =&gt; __(&#039;Facebook&#039;, &#039;geodirectory&#039;));

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;TEXT&#039;,
		                  &#039;field_type&#039; =&gt; &#039;textarea&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Video&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;Add video code here, YouTube etc.&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; __(&#039;Video&#039;, &#039;geodirectory&#039;),
		                  &#039;htmlvar_name&#039; =&gt; &#039;video&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;option_values&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;0&#039;,
		                  &#039;show_in&#039; =&gt; &#039;[owntab]&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;clabels&#039; =&gt; __(&#039;Video&#039;, &#039;geodirectory&#039;));

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;TEXT&#039;,
		                  &#039;field_type&#039; =&gt; &#039;textarea&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Special Offers&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;Note: List out any special offers (optional)&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; __(&#039;Special Offers&#039;, &#039;geodirectory&#039;),
		                  &#039;htmlvar_name&#039; =&gt; &#039;special_offers&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;option_values&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;0&#039;,
		                  &#039;show_in&#039; =&gt; &#039;[owntab]&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;clabels&#039; =&gt; __(&#039;Special Offers&#039;, &#039;geodirectory&#039;));


		/**
		 * Filter the array of default custom fields DB table data.
		 *
		 * @since 1.6.6
		 * @param string $fields The default custom fields as an array.
		 */
		$fields = apply_filters(&#039;geodir_extra_custom_fields&#039;, $fields, $post_type, $package_id);

		return  $fields;
	}

	/**
	 * Get the default custom fields used for every CPT.
	 *
	 * @param string $post_type
	 * @param string $package_id
	 *
	 * @return array
	 */
	public static function default_custom_fields($post_type=&#039;gd_place&#039;,$package_id=&#039;&#039;){
		$fields = array();
		$package = ($package_id==&#039;&#039;) ? &#039;&#039; : array($package_id);

		$post_type_info = geodir_get_posttype_info($post_type);

		$cpt_singular_name = (isset($post_type_info[&#039;labels&#039;][&#039;singular_name&#039;]) &amp;&amp; $post_type_info[&#039;labels&#039;][&#039;singular_name&#039;]) ? __($post_type_info[&#039;labels&#039;][&#039;singular_name&#039;], &#039;geodirectory&#039;) : __(&#039;Listing&#039;,&#039;geodirectory&#039;);


		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;VARCHAR&#039;,
		                  &#039;field_type&#039; =&gt; &#039;text&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Title&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;Enter the title.&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; sprintf( __(&#039;%s Title&#039;, &#039;geodirectory&#039;), $cpt_singular_name ),
		                  &#039;htmlvar_name&#039; =&gt; &#039;post_title&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;option_values&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;1&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;is_required&#039; =&gt; &#039;1&#039;,
		                  &#039;show_in&#039; =&gt;  &#039;[mapbubble]&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;field_icon&#039; =&gt; &#039;fas fa-minus&#039;,
		                  &#039;clabels&#039; =&gt; __(&#039;Title&#039;, &#039;geodirectory&#039;));

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;TEXT&#039;,
		                  &#039;field_type&#039; =&gt; &#039;textarea&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Description&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;Enter a description&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; sprintf( __(&#039;%s Description&#039;, &#039;geodirectory&#039;), $cpt_singular_name ),
		                  &#039;htmlvar_name&#039; =&gt; &#039;post_content&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;option_values&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;1&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;is_required&#039; =&gt; &#039;1&#039;,
		                  &#039;show_in&#039; =&gt; &#039;&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;field_icon&#039; =&gt; &#039;fas fa-minus&#039;,
		                  &#039;clabels&#039; =&gt; __(&#039;Description&#039;, &#039;geodirectory&#039;));

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;TEXT&#039;,
		                  &#039;field_type&#039; =&gt; &#039;tags&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Tags&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;Tags are short keywords, with no space within.(eg: tag1, tag2, tag3).&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; __(&#039;Tags&#039;, &#039;geodirectory&#039;),
		                  &#039;htmlvar_name&#039; =&gt; &#039;post_tags&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;1&#039;,
		                  &#039;is_required&#039; =&gt; &#039;0&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;show_in&#039;   =&gt;  &#039;[detail]&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;field_icon&#039; =&gt; &#039;fas fa-tags&#039;,
		                  &#039;clabels&#039; =&gt; __(&#039;Tags&#039;, &#039;geodirectory&#039;));

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;VARCHAR&#039;,
		                  &#039;field_type&#039; =&gt; &#039;categories&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Category&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;SELECT listing category FROM here. SELECT at least one CATEGORY&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; __(&#039;Category&#039;, &#039;geodirectory&#039;),
		                  &#039;htmlvar_name&#039; =&gt; &#039;post_category&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;1&#039;,
		                  &#039;is_required&#039; =&gt; &#039;1&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;show_in&#039;   =&gt;  &#039;[detail]&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;field_icon&#039; =&gt; &#039;fas fa-folder-open&#039;,
		                  &#039;clabels&#039; =&gt; __(&#039;Category&#039;, &#039;geodirectory&#039;),
						  &#039;extra&#039; =&gt; array(
							&#039;cat_display_type&#039; =&gt; &#039;multiselect&#039;
						  )
					);

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;VARCHAR&#039;,
		                  &#039;field_type&#039; =&gt; &#039;address&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Address&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;Please enter the listing street address. eg. : 230 Vine Street&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; __(&#039;Address&#039;, &#039;geodirectory&#039;),
		                  &#039;htmlvar_name&#039; =&gt; &#039;address&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;option_values&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;1&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;is_required&#039; =&gt; &#039;1&#039;,
		                  &#039;show_in&#039;   =&gt;  &#039;[detail],[mapbubble]&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;required_msg&#039; =&gt; __(&#039;Address fields are required&#039;, &#039;geodirectory&#039;),
		                  &#039;clabels&#039; =&gt; __(&#039;Address&#039;, &#039;geodirectory&#039;),
		                  &#039;field_icon&#039; =&gt; &#039;fas fa-map-marker-alt&#039;,
		                  &#039;extra&#039; =&gt; array(&#039;show_city&#039; =&gt; 1, &#039;city_lable&#039; =&gt; __(&#039;City&#039;, &#039;geodirectory&#039;),
		                                   &#039;show_region&#039; =&gt; 1, &#039;region_lable&#039; =&gt; __(&#039;Region&#039;, &#039;geodirectory&#039;),
		                                   &#039;show_country&#039; =&gt; 1, &#039;country_lable&#039; =&gt; __(&#039;Country&#039;, &#039;geodirectory&#039;),
		                                   &#039;show_zip&#039; =&gt; 1, &#039;zip_lable&#039; =&gt; __(&#039;Zip/Post Code&#039;, &#039;geodirectory&#039;),
		                                   &#039;show_map&#039; =&gt; 1, &#039;map_lable&#039; =&gt; __(&#039;Set Address On Map&#039;, &#039;geodirectory&#039;),
		                                   &#039;show_mapview&#039; =&gt; 1, &#039;mapview_lable&#039; =&gt; __(&#039;Select Map View&#039;, &#039;geodirectory&#039;),
		                                   &#039;show_mapzoom&#039; =&gt; 1, &#039;mapzoom_lable&#039; =&gt; &#039;hidden&#039;,
		                                   &#039;show_latlng&#039; =&gt; 1));

		$fields[] = array(&#039;post_type&#039; =&gt; $post_type,
		                  &#039;data_type&#039; =&gt; &#039;TEXT&#039;,
		                  &#039;field_type&#039; =&gt; &#039;images&#039;,
		                  &#039;admin_title&#039; =&gt; __(&#039;Images&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_desc&#039; =&gt; __(&#039;You can upload more than one image to create a image gallery on the details page.&#039;, &#039;geodirectory&#039;),
		                  &#039;frontend_title&#039; =&gt; __(&#039;Images&#039;, &#039;geodirectory&#039;),
		                  &#039;htmlvar_name&#039; =&gt; &#039;post_images&#039;,
		                  &#039;default_value&#039; =&gt; &#039;&#039;,
		                  &#039;option_values&#039; =&gt; &#039;&#039;,
		                  &#039;is_default&#039; =&gt; &#039;1&#039;,
		                  &#039;is_active&#039; =&gt; &#039;1&#039;,
		                  &#039;is_required&#039; =&gt; &#039;0&#039;,
		                  &#039;show_in&#039;   =&gt;  &#039;&#039;,
		                  &#039;show_on_pkg&#039; =&gt; $package,
		                  &#039;clabels&#039; =&gt; __(&#039;Images&#039;, &#039;geodirectory&#039;),
		                  &#039;field_icon&#039; =&gt; &#039;far fa-image&#039;);



		/**
		 * Filter the array of default custom fields DB table data.
		 *
		 * @since 1.6.6
		 * @param string $fields The default custom fields as an array.
		 */
		$fields = apply_filters(&#039;geodir_default_custom_fields&#039;, $fields, $post_type, $package_id);

		return  $fields;
	}

	/**
	 * Insert our dummy widgets.
	 *
	 * @param $sidebar_id
	 *
	 * @return string|void|WP_Error
	 */
	public static function insert_widgets($sidebar_id, $type = &#039;&#039;){

		$sidebar_id = sanitize_title_with_dashes($sidebar_id);

		// confirm the sidebar_id is valid
		if(empty($sidebar_id) || !array_key_exists($sidebar_id,$GLOBALS[&#039;wp_registered_sidebars&#039;])){
			return new WP_Error( &#039;gd-dummy-widgets-insert&#039;, __( &quot;The sidebar id is not valid.&quot;, &quot;geodirectory&quot; ) );
		}

		if($type == &#039;top&#039;){
			$widgets = self::get_dummy_widgets(&#039;top&#039;);
		}else{
			$widgets = self::get_dummy_widgets();
		}
		$widgets = array_reverse($widgets);// flip them as we add them to the start one by one
		$sidebars_widgets = get_option( &#039;sidebars_widgets&#039;, array() );
		$inserted = 0;
		$exist = 0;

		if(!empty($widgets)){
			foreach($widgets as $widget_id =&gt; $widget_data){

				// only add if not already there:
				if(isset($sidebars_widgets[$sidebar_id]) &amp;&amp; !empty($sidebars_widgets[$sidebar_id])){
					foreach($sidebars_widgets[$sidebar_id] as $current_widget_id){
						if(strpos($current_widget_id, $widget_id) !== false){
							// it already exists so continue
							$exist++; continue 2;
						}
					}
				}

				self::insert_widget_in_sidebar( $widget_id, $widget_data, $sidebar_id );
				$inserted++;
			}
		}

		if($inserted == 0 &amp;&amp; $exist &gt; 0){
			return __( &#039;Widgets already exist, none added.&#039; , &#039;geodirectory&#039; );
		}elseif($inserted &gt; 0){
			return __( &#039;Widgets inserted&#039; , &#039;geodirectory&#039; );
		}else{
			return __( &#039;Something went wrong and no inserted, you can do this manually in Appearance &gt; Widgets&#039; , &#039;geodirectory&#039; );
		}

	}

	/**
	 * The dummy widgets we want to install.
	 *
	 * @return mixed|void
	 */
	public static function get_dummy_widgets($type = &#039;&#039;){

		if($type==&#039;top&#039;){
			$widgets = array(
				// show map
				&#039;gd_map&#039; =&gt; array(
					&#039;width&#039; =&gt; &#039;100%&#039;,
					&#039;height&#039; =&gt; &#039;425px&#039;,
					&#039;maptype&#039; =&gt; &#039;ROADMAP&#039;,
					&#039;zoom&#039; =&gt; &#039;0&#039;,
					&#039;map_type&#039; =&gt; &#039;auto&#039;,
					&#039;map_directions&#039; =&gt; &#039;0&#039;,
					&#039;gd_wgt_showhide&#039;   =&gt; &#039;show_on&#039;,
					&#039;gd_wgt_restrict&#039;   =&gt; array(&#039;gd-pt&#039;,&#039;gd-search&#039;,&#039;gd-listing&#039;,&#039;gd-location&#039;),
				),
				// show GD search
				&#039;gd_search&#039; =&gt; array(
					&#039;gd_wgt_showhide&#039;   =&gt; &#039;show_on&#039;,
					&#039;gd_wgt_restrict&#039;   =&gt; array(&#039;gd-pt&#039;,&#039;gd-search&#039;,&#039;gd-listing&#039;,&#039;gd-location&#039;),
				),

			);
		}else{
			$widgets = array(
				// show the author action on the details sidebar
				&#039;gd_author_actions&#039; =&gt; array(
					&#039;hide_edit&#039;          =&gt; false,
					&#039;hide_delete&#039;          =&gt; false,
					&#039;gd_wgt_showhide&#039;   =&gt; &#039;show_on&#039;,
					&#039;gd_wgt_restrict&#039;   =&gt; array(&#039;gd-detail&#039;),
				),
				// show details sidebar
				&#039;gd_output_location&#039; =&gt; array(
					&#039;location&#039;          =&gt; &#039;[detail]&#039;,
					&#039;gd_wgt_showhide&#039;   =&gt; &#039;show_on&#039;,
					&#039;gd_wgt_restrict&#039;   =&gt; array(&#039;gd-detail&#039;),
				),
				// show map
				&#039;gd_map&#039; =&gt; array(
					&#039;width&#039; =&gt; &#039;100%&#039;,
					&#039;height&#039; =&gt; &#039;425px&#039;,
					&#039;maptype&#039; =&gt; &#039;ROADMAP&#039;,
					&#039;zoom&#039; =&gt; &#039;0&#039;,
					&#039;map_type&#039; =&gt; &#039;auto&#039;,
					&#039;map_directions&#039; =&gt; &#039;1&#039;,
					&#039;gd_wgt_showhide&#039;   =&gt; &#039;show_on&#039;,
					&#039;gd_wgt_restrict&#039;   =&gt; array(&#039;gd-detail&#039;,&#039;gd-author&#039;,&#039;gd-pt&#039;,&#039;gd-search&#039;,&#039;gd-listing&#039;),
				),
				// show GD Dashboard
				&#039;gd_dashboard&#039; =&gt; array(
					&#039;dashboard_title&#039;   =&gt; __(&#039;GD Dashboard&#039;,&#039;geodirectory&#039;),
					&#039;show_login&#039;        =&gt; true,
					&#039;login_title&#039;        =&gt; __(&#039;Login&#039;,&#039;geodirectory&#039;),
					&#039;gd_wgt_showhide&#039;   =&gt; &#039;show&#039;,
					&#039;gd_wgt_restrict&#039;   =&gt; array(),
				),

			);
		}

		return apply_filters(&#039;geodir_dummy_widgets&#039;,$widgets, $type);
	}

	/**
	 * Insert a widget in a sidebar.
	 *
	 * @param string $widget_id   ID of the widget (search, recent-posts, etc.)
	 * @param array $widget_data  Widget settings.
	 * @param string $sidebar     ID of the sidebar.
	 */
	public static function insert_widget_in_sidebar( $widget_id, $widget_data, $sidebar ) {
		// Retrieve sidebars, widgets and their instances
		$sidebars_widgets = get_option( &#039;sidebars_widgets&#039;, array() );
		$widget_instances = get_option( &#039;widget_&#039; . $widget_id, array() );

		// Retrieve the key of the next widget instance
		$numeric_keys = array_filter( array_keys( $widget_instances ), &#039;is_int&#039; );
		$next_key = $numeric_keys ? max( $numeric_keys ) + 1 : 2;
		// Add this widget to the sidebar
		if ( ! isset( $sidebars_widgets[ $sidebar ] ) ) {
			$sidebars_widgets[ $sidebar ] = array();
		}

		// add the widget to the start
		array_unshift($sidebars_widgets[$sidebar], $widget_id . &#039;-&#039; . $next_key);

		// add array to end
		//$sidebars_widgets[ $sidebar ][] = $widget_id . &#039;-&#039; . $next_key;

		// Add the new widget instance
		$widget_instances[ $next_key ] = $widget_data;
		// Store updated sidebars, widgets and their instances
		update_option( &#039;sidebars_widgets&#039;, $sidebars_widgets );
		update_option( &#039;widget_&#039; . $widget_id, $widget_instances );
	}

    /**
     * Setup menu.
     *
     * @since 2.0.0
     *
     * @param string $menu_id Optional. Menu id. Default null.
     * @param string $menu_location Optional. Menu location. Default null.
     * @return string|WP_Error.
     */
	public static function setup_menu($menu_id = &#039;&#039;,$menu_location = &#039;&#039;){

		$menu_id = sanitize_title_with_dashes($menu_id);
		$menu_location = sanitize_title_with_dashes($menu_location);

		// confirm the sidebar_id is valid
		if(!$menu_id &amp;&amp; !$menu_location){
			return new WP_Error( &#039;gd-wizard-setup-menu&#039;, __( &quot;The menu is not valid.&quot;, &quot;geodirectory&quot; ) );
		}

		$items_added = 0;
		$items_exist= 0;

		if($menu_id){



			$menu_exists = wp_get_nav_menu_object( $menu_id );

			if(!$menu_exists){
				return new WP_Error( &#039;gd-wizard-setup-menu&#039;, __( &quot;The menu is not valid.&quot;, &quot;geodirectory&quot; ) );
			}

			$current_menu_items = wp_get_nav_menu_items( $menu_id );
			$current_menu_titles = array();
			// get a list of current slugs so we don&#039;t add things twice.
			if(!empty($current_menu_items)){
				foreach($current_menu_items as $current_menu_item){
					if(!empty($current_menu_item-&gt;post_name)){
						$current_menu_titles[] = $current_menu_item-&gt;title;
					}
				}
			}

			$gd_menus = new GeoDir_Admin_Menus();

			$gd_menu_items = $gd_menus-&gt;get_endpoints();

			if(!empty($gd_menu_items)){
				foreach($gd_menu_items as $menu_item_type){
					if(!empty($menu_item_type)){

						$menu_item_type = array_map(&#039;wp_setup_nav_menu_item&#039;, $menu_item_type);

						foreach($menu_item_type as $menu_item){

							if(!empty($current_menu_titles) &amp;&amp; (in_array($menu_item-&gt;title,$current_menu_titles) || in_array(str_replace(&quot; page&quot;,&#039;&#039;,$menu_item-&gt;title),$current_menu_titles))){
								$items_exist++; continue 2;
							}

							// setup standard menu stuff
							$menu_item-&gt;{&#039;menu-item-object-id&#039;} = $menu_item-&gt;object_id;
							$menu_item-&gt;{&#039;menu-item-object&#039;} = $menu_item-&gt;object;
							$menu_item-&gt;{&#039;menu-item-type&#039;} = $menu_item-&gt;type;
							$menu_item-&gt;{&#039;menu-item-status&#039;} = &#039;publish&#039;;
							$menu_item-&gt;{&#039;menu-item-classes&#039;} = !empty($menu_item-&gt;classes) ? implode(&quot; &quot;,$menu_item-&gt;classes) : &#039;gd-menu-item&#039;;
							if($menu_item-&gt;type==&#039;custom&#039;){
								$menu_item-&gt;{&#039;menu-item-url&#039;} = $menu_item-&gt;url;
								$menu_item-&gt;{&#039;menu-item-title&#039;} = $menu_item-&gt;title;
							}
//
							// insert the menu item
							wp_update_nav_menu_item($menu_id, 0, $menu_item);
							$items_added++;
						}
					}
				}
			}

		}elseif($menu_location){

			$menuname = &quot;GD Menu&quot;;

			// Does the menu exist already?
			$menu_exists = wp_get_nav_menu_object( $menuname );

			// If it doesn&#039;t exist, let&#039;s create it.
			if( !$menu_exists) {
				$menu_id = wp_create_nav_menu( $menuname );

				$locations = get_theme_mod( &#039;nav_menu_locations&#039; );

				if($menu_id){
					$locations[$menu_location] = $menu_id;
					set_theme_mod(&#039;nav_menu_locations&#039;, $locations);
					return self::setup_menu($menu_id);
				}

			}else{
				return new WP_Error( &#039;gd-wizard-setup-menu&#039;, __( &quot;Menu already exists.&quot;, &quot;geodirectory&quot; ) );
			}
		}


		if($items_added == 0 &amp;&amp; $items_exist &gt; 0){
			return __( &#039;Menu items already exist, none added.&#039; , &#039;geodirectory&#039; );
		}elseif($items_added  &gt; 0){
			return __( &#039;Menu items added successfully.&#039; , &#039;geodirectory&#039; );
		}else{
			return __( &#039;Something went wrong, you can manually add items in Appearance &gt; Menus&#039; , &#039;geodirectory&#039; );
		}

	}
}</code></pre>
            </article>
            </div>
        </div>
        <a href="#top" class="phpdocumentor-back-to-top"><i class="fas fa-chevron-circle-up"></i></a>

    </main>

    <footer class="phpdocumentor phpdocumentor-footer">
    <div class="phpdocumentor-section">
        <span>Geodirectory Code Reference API documentation generated by <a href="http://www.phpdoc.org/">phpDocumentor</a> on May 12th, 2022 at 07:38 am.</span>
    </div>
</footer>

    <script>
        cssVars({});
    </script>
    <script>
        var searchParams = {
            'searchIndex': '..\/js\/searchIndex.json'
        };
    </script>
    <script src="../js/searchIndex.js?updated=1652341136"></script>
    <script src="../js/search.js?updated=1652341136"></script>
</body>
</html>
